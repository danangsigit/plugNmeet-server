/*! For license information please see main.0f0d64324acad36360a9.js.LICENSE.txt */
(self.webpackChunkplugnmeet_client=self.webpackChunkplugnmeet_client||[]).push([[179],{7410:(e,t,r)=>{"use strict";r.r(t),r.d(t,{Abs:()=>a.SYM,Acos:()=>a.VGw,Acosh:()=>a.SpW,AdadeltaOptimizer:()=>a.zJI,AdagradOptimizer:()=>a.HeW,AdamOptimizer:()=>a.a4z,AdamaxOptimizer:()=>a.DBS,Add:()=>a.mm_,AddN:()=>a.Xze,All:()=>a.oT6,Any:()=>a.IKK,ArgMax:()=>a.sJF,ArgMin:()=>a.aJk,Asin:()=>a.M2y,Asinh:()=>a.qw7,Atan:()=>a.jMg,Atan2:()=>a.QCc,Atanh:()=>a.Oyi,AvgPool:()=>a.JhU,AvgPool3D:()=>a._k9,AvgPool3DGrad:()=>a.IMb,AvgPoolGrad:()=>a.ROF,BatchMatMul:()=>a.XLW,BatchToSpaceND:()=>a.zws,Bincount:()=>a.zvY,BitwiseAnd:()=>a.hCO,BroadcastArgs:()=>a.eEB,BroadcastTo:()=>a.Ly9,Cast:()=>a.RFZ,Ceil:()=>a.gJX,ClipByValue:()=>a.xnO,Complex:()=>a.Zz9,ComplexAbs:()=>a.yj2,Concat:()=>a.Eh3,Conv2D:()=>a.mhS,Conv2DBackpropFilter:()=>a.wUP,Conv2DBackpropInput:()=>a.wm,Conv3D:()=>a.x12,Conv3DBackpropFilterV2:()=>a.o2y,Conv3DBackpropInputV2:()=>a.ik2,Cos:()=>a.mc4,Cosh:()=>a.TR1,CropAndResize:()=>a.VcC,Cumprod:()=>a.Byc,Cumsum:()=>a.iHb,DataStorage:()=>a.JLz,DenseBincount:()=>a.QRR,DepthToSpace:()=>a.T0n,DepthwiseConv2dNative:()=>a.cie,DepthwiseConv2dNativeBackpropFilter:()=>a.sL$,DepthwiseConv2dNativeBackpropInput:()=>a.y7R,Diag:()=>a.$w,Dilation2D:()=>a.p4S,Dilation2DBackpropFilter:()=>a.Vn9,Dilation2DBackpropInput:()=>a.ekb,ENV:()=>a.ViN,Einsum:()=>a.$g6,Elu:()=>a.SX0,EluGrad:()=>a.HEU,Environment:()=>a.qAh,Equal:()=>a.hdR,Erf:()=>a.Omj,Exp:()=>a.NEP,ExpandDims:()=>a.YFo,Expm1:()=>a.Y0y,FFT:()=>a.vwp,Fill:()=>a.deh,FlipLeftRight:()=>a.Uyb,Floor:()=>a.OR,FloorDiv:()=>a.jeX,FromPixels:()=>a.eBW,FusedBatchNorm:()=>a.sHE,FusedConv2D:()=>a._V0,FusedDepthwiseConv2D:()=>a.luS,GatherNd:()=>a.q1x,GatherV2:()=>a.qi_,Greater:()=>a.iZT,GreaterEqual:()=>a.Acj,IFFT:()=>a.Qg5,Identity:()=>a.iJz,Imag:()=>a.J_u,IsFinite:()=>a.avt,IsInf:()=>a.iWB,IsNan:()=>a.r7n,KernelBackend:()=>a.Zuw,LRN:()=>a.eZ0,LRNGrad:()=>a.Hhh,LeakyRelu:()=>a.J$2,Less:()=>a.vtC,LessEqual:()=>a.CAk,LinSpace:()=>a.e7N,Log:()=>a.ZbH,Log1p:()=>a.kU,LogSoftmax:()=>a.qCd,LogicalAnd:()=>a.PYm,LogicalNot:()=>a.VfG,LogicalOr:()=>a.MZg,LogicalXor:()=>a.w6g,LowerBound:()=>a.qIC,MatrixBandPart:()=>a.J7O,Max:()=>a.YoZ,MaxPool:()=>a.mTV,MaxPool3D:()=>a.OAf,MaxPool3DGrad:()=>a.OU7,MaxPoolGrad:()=>a.OV7,MaxPoolWithArgmax:()=>a.vFR,Maximum:()=>a.BMI,Mean:()=>a.q2K,Min:()=>a.c17,Minimum:()=>a.q8u,MirrorPad:()=>a.jQs,Mod:()=>a.Vbg,MomentumOptimizer:()=>a.rIn,Multinomial:()=>a.NZg,Multiply:()=>a.wYn,Neg:()=>a.kuV,NonMaxSuppressionV3:()=>a.uv1,NonMaxSuppressionV4:()=>a.cye,NonMaxSuppressionV5:()=>a.W0H,NotEqual:()=>a.yQU,OP_SCOPE_SUFFIX:()=>a.zvA,OneHot:()=>a.we_,OnesLike:()=>a.qWM,Optimizer:()=>a.gaJ,OptimizerConstructors:()=>a.eEe,Pack:()=>a.QiL,PadV2:()=>a.lyA,Pool:()=>a.Kgp,Pow:()=>a.pe_,Prelu:()=>a.o0g,Prod:()=>a.DlI,RMSPropOptimizer:()=>a.gVI,RaggedGather:()=>a.dDz,RaggedRange:()=>a.CQl,RaggedTensorToTensor:()=>a.BiW,Range:()=>a.e6w,Rank:()=>a.yw1,Real:()=>a.xJR,RealDiv:()=>a.oHH,Reciprocal:()=>a.$HU,Reduction:()=>a.IH3,Relu:()=>a.qkr,Relu6:()=>a.SbG,Reshape:()=>a.HZH,ResizeBilinear:()=>a._Yw,ResizeBilinearGrad:()=>a.zbQ,ResizeNearestNeighbor:()=>a.dpD,ResizeNearestNeighborGrad:()=>a.Hmb,Reverse:()=>a.mKl,RotateWithOffset:()=>a.b9H,Round:()=>a.e07,Rsqrt:()=>a.bV0,SGDOptimizer:()=>a.DYp,ScatterNd:()=>a.xQA,SearchSorted:()=>a.nr8,Select:()=>a.PhF,Selu:()=>a.oFR,Sigmoid:()=>a.a5O,Sign:()=>a.i5y,Sin:()=>a.RQH,Sinh:()=>a.wYB,Slice:()=>a.p2w,Softmax:()=>a.Gcp,Softplus:()=>a.MRv,SpaceToBatchND:()=>a.TQc,SparseFillEmptyRows:()=>a.O3z,SparseReshape:()=>a.nhH,SparseSegmentMean:()=>a.w3H,SparseSegmentSum:()=>a.ZjV,SparseToDense:()=>a.D2d,SplitV:()=>a.L8s,Sqrt:()=>a.FKq,Square:()=>a.bK0,SquaredDifference:()=>a._tC,StaticRegexReplace:()=>a.e0R,Step:()=>a.h8e,StridedSlice:()=>a.jQk,StringNGrams:()=>a._JP,StringSplit:()=>a.s1s,StringToHashBucketFast:()=>a.XkS,Sub:()=>a.Tr8,Sum:()=>a.GBy,Tan:()=>a.sEM,Tanh:()=>a.MIZ,Tensor:()=>a.esB,TensorBuffer:()=>a.YDk,TensorScatterUpdate:()=>a.SIB,Tile:()=>a.n9L,TopK:()=>a.cWu,Transform:()=>a.wx7,Transpose:()=>a.G3Y,Unique:()=>a.kpP,Unpack:()=>a.ToN,UnsortedSegmentSum:()=>a.Qvg,UpperBound:()=>a.XDQ,Variable:()=>a._wD,ZerosLike:()=>a.RuY,_FusedMatMul:()=>a.usg,abs:()=>a.WnP,acos:()=>a.Khb,acosh:()=>a.__u,add:()=>a.IHx,addN:()=>a.QBD,all:()=>a.$6P,any:()=>a.YjB,argMax:()=>a.NqF,argMin:()=>a.vHJ,asin:()=>a.ZRM,asinh:()=>a.VfV,atan:()=>a.z4N,atan2:()=>a.fvJ,atanh:()=>a.C80,avgPool:()=>a.wS1,avgPool3d:()=>a.uR5,backend:()=>a.y3$,backend_util:()=>a.Wap,basicLSTMCell:()=>a.zEQ,batchNorm:()=>a.tgs,batchNorm2d:()=>a.Dxk,batchNorm3d:()=>a.JY5,batchNorm4d:()=>a.p3b,batchToSpaceND:()=>a.E4h,bincount:()=>a.yE8,bitwiseAnd:()=>a.ycw,booleanMaskAsync:()=>a.anm,broadcastArgs:()=>a.XsQ,broadcastTo:()=>a.UFq,broadcast_util:()=>a.Jyw,browser:()=>a.Xhn,buffer:()=>a.f3b,cast:()=>a.pju,ceil:()=>a.mDi,clipByValue:()=>a.iUl,clone:()=>a.d9v,complex:()=>a.PYB,concat:()=>a.zoF,concat1d:()=>a.gME,concat2d:()=>a.Izb,concat3d:()=>a.MNy,concat4d:()=>a.ZaL,conv1d:()=>a.PAt,conv2d:()=>a.Tek,conv2dTranspose:()=>a.bc,conv3d:()=>a.pdZ,conv3dTranspose:()=>a.$QV,copyRegisteredKernels:()=>a.T3b,cos:()=>a.mCk,cosh:()=>a.f9Y,cosineWindow:()=>a.mew,cumprod:()=>a.$Gn,cumsum:()=>a.zbp,customGrad:()=>a.cbc,denseBincount:()=>a.ppE,deprecationWarn:()=>a.MXe,depthToSpace:()=>a.nTT,depthwiseConv2d:()=>a.B10,device_util:()=>a.C2$,diag:()=>a.Ka3,dilation2d:()=>a.WmZ,disableDeprecationWarnings:()=>a.cFr,dispose:()=>a.B90,disposeVariables:()=>a.N8o,div:()=>a.hiC,divNoNan:()=>a.NTj,dot:()=>a.AKD,dropout:()=>a.rvX,einsum:()=>a.WYO,elu:()=>a.pyx,enableDebugMode:()=>a.Ra$,enableProdMode:()=>a.G48,enclosingPowerOfTwo:()=>a.GRh,engine:()=>a.SRH,ensureShape:()=>a.EDe,env:()=>a.OBj,equal:()=>a.DgJ,erf:()=>a.qNN,euclideanNorm:()=>a.d2q,exp:()=>a.Qqt,expandDims:()=>a.dt4,expm1:()=>a.t$B,eye:()=>a.iyy,fft:()=>a.kp_,fill:()=>a.hlL,findBackend:()=>a.x3e,findBackendFactory:()=>a.zel,floor:()=>a.GWj,floorDiv:()=>a.qPi,fused:()=>a.imm,gather:()=>a.Iqj,gatherND:()=>a.dbB,gather_util:()=>a.DaI,getBackend:()=>a.N_N,getGradient:()=>a.ukX,getKernel:()=>a.pIF,getKernelsForBackend:()=>a.trD,grad:()=>a.UQy,grads:()=>a.tiA,greater:()=>a.pjt,greaterEqual:()=>a.brS,ifft:()=>a.Sxn,imag:()=>a.asL,image:()=>a.BHj,inTopKAsync:()=>a.V3u,io:()=>a.io,irfft:()=>a.wx0,isFinite:()=>a.xVT,isInf:()=>a.UWc,isNaN:()=>a.i2d,keep:()=>a.CnY,kernel_impls:()=>a.GDt,leakyRelu:()=>a.hi7,less:()=>a.d9m,lessEqual:()=>a.zN1,linalg:()=>a.$r2,linspace:()=>a.SX3,localResponseNormalization:()=>a.G9k,log:()=>a.cM7,log1p:()=>a.Krr,logSigmoid:()=>a.e_t,logSoftmax:()=>a.CmS,logSumExp:()=>a.l_t,logicalAnd:()=>a.HvI,logicalNot:()=>a.hJK,logicalOr:()=>a.K5V,logicalXor:()=>a.egP,losses:()=>a.MB5,lowerBound:()=>a.eab,matMul:()=>a.OI3,math:()=>a.mAU,max:()=>a.Fp7,maxPool:()=>a._sB,maxPool3d:()=>a.YQQ,maxPoolWithArgmax:()=>a.Ip$,maximum:()=>a.gWQ,mean:()=>a.J69,memory:()=>a.sq6,meshgrid:()=>a.ry_,min:()=>a.VV$,minimum:()=>a.LTh,mirrorPad:()=>a.VdP,mod:()=>a.wQq,moments:()=>a.Gi7,movingAverage:()=>a.p_,mul:()=>a.dC7,multiRNNCell:()=>a.rq4,multinomial:()=>a.SJ_,neg:()=>a.W76,nextFrame:()=>a.glt,norm:()=>a.KOy,notEqual:()=>a.Quu,oneHot:()=>a.lfX,ones:()=>a.iUs,onesLike:()=>a.JpU,op:()=>a.op,outerProduct:()=>a.N2O,pad:()=>a.vku,pad1d:()=>a.pNR,pad2d:()=>a.koy,pad3d:()=>a.t1L,pad4d:()=>a.lGY,pool:()=>a.d_R,pow:()=>a.sQ3,prelu:()=>a.AL3,print:()=>a.S0v,prod:()=>a.WVs,profile:()=>a.N5s,raggedGather:()=>a.$gW,raggedRange:()=>a.VT$,raggedTensorToTensor:()=>a.N89,rand:()=>a.TN_,randomGamma:()=>a.wzB,randomNormal:()=>a.nGf,randomStandardNormal:()=>a.ruB,randomUniform:()=>a.LGj,randomUniformInt:()=>a.pe5,range:()=>a.w6H,ready:()=>a.Cd_,real:()=>a.kwC,reciprocal:()=>a.M25,registerBackend:()=>a.jqO,registerGradient:()=>a.LiG,registerKernel:()=>a.wCN,relu:()=>a.UYe,relu6:()=>a.btT,removeBackend:()=>a.cjG,reshape:()=>a.XLQ,reverse:()=>a.GYS,reverse1d:()=>a.SDf,reverse2d:()=>a.diP,reverse3d:()=>a.sx7,reverse4d:()=>a.mG2,rfft:()=>a.QEs,round:()=>a.NMM,rsqrt:()=>a.bp0,scalar:()=>a.iD$,scatterND:()=>a.snQ,scatter_util:()=>a.yV1,searchSorted:()=>a.zcT,selu:()=>a.U8D,separableConv2d:()=>a.U_I,serialization:()=>a.m7h,setBackend:()=>a.CQI,setPlatform:()=>a.VYu,setdiff1dAsync:()=>a.ODp,sigmoid:()=>a.XD2,sign:()=>a.Xxe,signal:()=>a.tdS,sin:()=>a.O$l,sinh:()=>a.R_K,slice:()=>a.tPi,slice1d:()=>a.jZU,slice2d:()=>a.SmN,slice3d:()=>a.CnO,slice4d:()=>a.p0P,slice_util:()=>a.kuN,softmax:()=>a.XAC,softplus:()=>a.Wvh,spaceToBatchND:()=>a.fBT,sparse:()=>a.rVs,sparseToDense:()=>a.ers,spectral:()=>a.uN7,split:()=>a.Vl2,sqrt:()=>a._b3,square:()=>a.h62,squaredDifference:()=>a.$i,squeeze:()=>a.L9e,stack:()=>a.knu,step:()=>a.Nbs,stridedSlice:()=>a.NXj,string:()=>a.Z_8,sub:()=>a.luU,sum:()=>a.Smz,sumOutType:()=>a.z4k,tan:()=>a.ORZ,tanh:()=>a.AEp,tensor:()=>a.XeE,tensor1d:()=>a.RRF,tensor2d:()=>a.odF,tensor3d:()=>a.wOQ,tensor4d:()=>a.yXz,tensor5d:()=>a.Bfx,tensor6d:()=>a.xZs,tensorScatterUpdate:()=>a.Pg0,tensor_util:()=>a.piX,test_util:()=>a.p3L,tidy:()=>a.lub,tile:()=>a.Gg6,time:()=>a.XVJ,topk:()=>a.hg7,train:()=>a.p_j,transpose:()=>a.p4s,truncatedNormal:()=>a.Xu6,unique:()=>a.Two,unregisterGradient:()=>a.bt3,unregisterKernel:()=>a.nEe,unsortedSegmentSum:()=>a.pUJ,unstack:()=>a.HHK,upcastType:()=>a.x8V,upperBound:()=>a.GaM,util:()=>a.D5U,valueAndGrad:()=>a.h76,valueAndGrads:()=>a.fNQ,variable:()=>a.VD$,variableGrads:()=>a.pnJ,version_core:()=>a.jTM,where:()=>a.arb,whereAsync:()=>a.itS,zeros:()=>a.lls,zerosLike:()=>a.P84});r(5186);var a=r(9966)},566:(e,t,r)=>{"use strict";var a,o=r(5893),s=r(7294),i=r(745),n=r(743),l=r(5678),d=r(7384),c=r(2405),u=(r(3268),r(8028)),m=r(9887),p=r(5059),h=r(5538);const x=null!==(a=window.STATIC_ASSETS_PATH)&&void 0!==a?a:"/assets";u.ZP.use(p.Z).use(m.Db).use(h.Z).init({debug:!1,fallbackLng:"en",interpolation:{escapeValue:!1},backend:{loadPath:x+"/locales/{{lng}}/{{ns}}.json"}});const f=u.ZP;var g=r(4268),v=r(5673);const b=(0,g.HF)({selectId:e=>e.userId,sortComparer:(e,t)=>e.isSpeaking&&t.isSpeaking?e.audioLevel-t.audioLevel:e.isSpeaking!==t.isSpeaking?e.isSpeaking?-1:1:e.lastSpokeAt!==t.lastSpokeAt?t.lastSpokeAt-e.lastSpokeAt:0}),y=b.getSelectors((e=>e.activeSpeakers)),k=(0,g.oM)({name:"activeSpeakers",initialState:b.getInitialState(),reducers:{addSpeaker:b.addOne,addManySpeakers:b.addMany,setAllSpeakers:b.setAll,removeSpeakers:b.removeAll,removeOneSpeaker:b.removeOne}}),{addSpeaker:w,addManySpeakers:T,removeSpeakers:j,removeOneSpeaker:S,setAllSpeakers:_}=k.actions,N=k.reducer,C=(0,g.HF)({selectId:e=>e.userId,sortComparer:(e,t)=>e.name.localeCompare(t.name)}),E=C.getSelectors((e=>e.participants)),R=(0,g.oM)({name:"participants",initialState:C.getInitialState(),reducers:{addParticipant:C.addOne,removeParticipant:C.removeOne,updateParticipant:C.updateOne}}),{addParticipant:I,removeParticipant:A,updateParticipant:P}=R.actions,F=R.reducer;var M;!function(e){e.MOBILE="mobile",e.TABLET="tablet",e.DESKTOP="desktop"}(M||(M={}));const O={token:"",screenSharing:{isActive:!1,sharedBy:""},isActiveRtmpBroadcasting:!1,isActiveRecording:!1,isWebcamPaginating:!1,isStartup:!0,isChatServiceReady:!1,totalAudioSubscribers:0,totalVideoSubscribers:0,userDeviceType:M.DESKTOP,currentRoom:{sid:"",room_id:"",metadata:{room_title:"plugNmeet",is_recording:!1,is_active_rtmp:!1,is_breakout_room:!1,started_at:Date.now(),room_features:{allow_webcams:!0,mute_on_start:!1,allow_screen_share:!0,allow_rtmp:!0,allow_view_other_webcams:!0,allow_view_other_users_list:!0,admin_only_webcams:!1,allow_polls:!0,room_duration:0,recording_features:{is_allow:!0,is_allow_cloud:!0,enable_auto_cloud_recording:!1,is_allow_local:!0},chat_features:{allow_chat:!0,allow_file_upload:!0},shared_note_pad_features:{allowed_shared_note_pad:!1,is_active:!1,visible:!1},whiteboard_features:{allowed_whiteboard:!0,visible:!1,whiteboard_file_id:"default",file_name:"default",file_path:"default",total_pages:10},external_media_player_features:{allowed_external_media_player:!0,is_active:!1},waiting_room_features:{is_active:!1,waiting_room_msg:""},breakout_room_features:{is_allow:!0,is_active:!1,allowed_number_rooms:6},display_external_link_features:{is_allow:!0,is_active:!1},ingress_features:{is_allow:!1}},copyright_conf:{display:!0,text:'Powered by <a href="https://www.plugnmeet.org" target="_blank">plugNmeet</a>'}}}},D=(0,g.oM)({name:"session",initialState:O,reducers:{addToken:(e,t)=>{e.token=t.payload},addServerVersion:(e,t)=>{e.serverVersion=t.payload},toggleStartup:(e,t)=>{e.isStartup=t.payload},addCurrentUser:(e,t)=>{e.currentUser=t.payload},addCurrentRoom:(e,t)=>{e.currentRoom.room_id=t.payload.room_id,e.currentRoom.sid=t.payload.sid,t.payload.metadata&&(e.currentRoom.metadata=t.payload.metadata)},updateScreenSharing:(e,t)=>{e.screenSharing=t.payload},setWebcamPaginating:(e,t)=>{e.isWebcamPaginating=t.payload},updateCurrentUserMetadata:(e,t)=>{e.currentUser&&(e.currentUser.metadata=t.payload)},updateCurrentRoomMetadata:(e,t)=>{var r,a;e.currentRoom&&(e.currentRoom.metadata=t.payload,e.isActiveRtmpBroadcasting=null!==(r=t.payload.is_active_rtmp)&&void 0!==r&&r,e.isActiveRecording=null!==(a=t.payload.is_recording)&&void 0!==a&&a)},updateIsChatServiceReady:(e,t)=>{e.isChatServiceReady=t.payload},updateTotalVideoSubscribers:(e,t)=>{e.totalVideoSubscribers=t.payload},updateTotalAudioSubscribers:(e,t)=>{e.totalAudioSubscribers=t.payload},updateMuteOnStart:(e,t)=>{e.currentRoom.metadata&&(e.currentRoom.metadata.room_features.mute_on_start=t.payload)},updateUserDeviceType:(e,t)=>{e.userDeviceType=t.payload}}}),{addToken:L,addServerVersion:B,toggleStartup:U,addCurrentUser:W,addCurrentRoom:G,updateScreenSharing:J,setWebcamPaginating:V,updateCurrentUserMetadata:H,updateCurrentRoomMetadata:q,updateIsChatServiceReady:$,updateTotalVideoSubscribers:z,updateTotalAudioSubscribers:Q,updateMuteOnStart:Y,updateUserDeviceType:X}=D.actions,K=D.reducer;var Z;const ee={type:"none"},te=null!==(Z=window.STATIC_ASSETS_PATH)&&void 0!==Z?Z:"./assets",re=["kenny-eliason-Wp7t4cWN-68-unsplash","jonny-caspari-KuudDjBHIlA-unsplash","roman-bozhko-PypjzKTUqLo-unsplash","vinicius-amnx-amano-17NCG_wOkMY-unsplash","dmytro-tolokonov-Jq3WI9IQgEs-unsplash","andrew-ridley-jR4Zf-riEjI-unsplash","annie-spratt-OWq8w3BYMFY-unsplash","evelyn-bertrand-GrIf347OtnY-unsplash","steve-richey-6xqAK6oAeHA-unsplash","erol-ahmed-IHL-Jbawvvo-unsplash"].map((e=>`${te}/backgrounds/${e}.jpg`)),ae={isActiveMicrophone:!1,isActiveWebcam:!1,isActiveChatPanel:!1,isActiveParticipantsPanel:!1,isActiveRaisehand:!1,isActiveRecording:!1,isActiveScreenshare:!1,isActiveSharedNotePad:!1,isActiveWhiteboard:!1,isMicMuted:!1,screenWidth:1024,screenHeight:500,deviceOrientation:"portrait",showMicrophoneModal:!1,showVideoShareModal:!1,showLockSettingsModal:!1,showRtmpModal:!1,showExternalMediaPlayerModal:!1,showManageWaitingRoomModal:!1,showManageBreakoutRoomModal:!1,showDisplayExternalLinkModal:!1,totalUnreadChatMsgs:0,virtualBackground:ee},oe=(0,g.oM)({name:"bottomIconsActivity",initialState:ae,reducers:{updateIsActiveMicrophone:(e,t)=>{e.isActiveMicrophone=t.payload},updateIsMicMuted:(e,t)=>{e.isMicMuted=t.payload},updateIsActiveWebcam:(e,t)=>{e.isActiveWebcam=t.payload},updateIsActiveChatPanel:(e,t)=>{e.screenWidth<1024&&e.isActiveParticipantsPanel&&t.payload&&(e.isActiveParticipantsPanel=!1),e.isActiveChatPanel=t.payload,e.isActiveChatPanel&&(e.totalUnreadChatMsgs=0)},updateIsActiveParticipantsPanel:(e,t)=>{e.screenWidth<1024&&e.isActiveChatPanel&&t.payload&&(e.isActiveChatPanel=!1),e.isActiveParticipantsPanel=t.payload},updateIsActiveRaisehand:(e,t)=>{e.isActiveRaisehand=t.payload},updateIsActiveRecording:(e,t)=>{e.isActiveRecording=t.payload},updateIsActiveScreenshare:(e,t)=>{e.isActiveScreenshare=t.payload,e.isActiveScreenshare&&(e.isActiveSharedNotePad=!1,e.isActiveWhiteboard=!1,e.isActiveParticipantsPanel=!1)},updateIsActiveSharedNotePad:(e,t)=>{e.isActiveSharedNotePad=t.payload,e.isActiveSharedNotePad&&(e.isActiveParticipantsPanel=!1)},updateIsActiveWhiteboard:(e,t)=>{e.isActiveWhiteboard=t.payload,e.isActiveWhiteboard&&(e.isActiveParticipantsPanel=!1)},updateScreenWidth:(e,t)=>{e.screenWidth=t.payload},updateScreenHeight:(e,t)=>{e.screenHeight=t.payload},updateDeviceOrientation:(e,t)=>{e.deviceOrientation=t.payload},updateShowMicrophoneModal:(e,t)=>{e.showMicrophoneModal=t.payload},updateShowVideoShareModal:(e,t)=>{e.showVideoShareModal=t.payload},updateShowLockSettingsModal:(e,t)=>{e.showLockSettingsModal=t.payload},updateShowRtmpModal:(e,t)=>{e.showRtmpModal=t.payload},updateShowExternalMediaPlayerModal:(e,t)=>{e.showExternalMediaPlayerModal=t.payload},updateShowManageWaitingRoomModal:(e,t)=>{e.showManageWaitingRoomModal=t.payload},updateShowManageBreakoutRoomModal:(e,t)=>{e.showManageBreakoutRoomModal=t.payload},updateDisplayExternalLinkRoomModal:(e,t)=>{e.showDisplayExternalLinkModal=t.payload},updateTotalUnreadChatMsgs:e=>{e.isActiveChatPanel||(e.totalUnreadChatMsgs+=1)},updateVirtualBackground:(e,t)=>{e.virtualBackground=t.payload}}}),{updateIsActiveMicrophone:se,updateIsMicMuted:ie,updateIsActiveWebcam:ne,updateIsActiveChatPanel:le,updateIsActiveParticipantsPanel:de,updateIsActiveRaisehand:ce,updateIsActiveRecording:ue,updateIsActiveScreenshare:me,updateIsActiveSharedNotePad:pe,updateIsActiveWhiteboard:he,updateShowMicrophoneModal:xe,updateShowVideoShareModal:fe,updateShowLockSettingsModal:ge,updateShowManageWaitingRoomModal:ve,updateShowRtmpModal:be,updateShowExternalMediaPlayerModal:ye,updateShowManageBreakoutRoomModal:ke,updateDisplayExternalLinkRoomModal:we,updateScreenWidth:Te,updateScreenHeight:je,updateDeviceOrientation:Se,updateTotalUnreadChatMsgs:_e,updateVirtualBackground:Ne}=oe.actions,Ce=oe.reducer,Ee=(0,g.HF)({selectId:e=>e.message_id,sortComparer:(e,t)=>{const r=new Date(e.time),a=new Date(t.time);return r.getTime()>a.getTime()?1:r.getTime()<a.getTime()?-1:0}}),Re=Ee.getSelectors((e=>e.chatMessages)),Ie=(0,g.oM)({name:"chat-messages",initialState:Ee.getInitialState(),reducers:{addChatMessage:Ee.addOne,removeChatMessage:Ee.removeOne,updateChatMessage:Ee.updateOne}}),{addChatMessage:Ae,removeChatMessage:Pe,updateChatMessage:Fe}=Ie.actions,Me=Ie.reducer;var Oe,De,Le,Be=r(5591);!function(e){e.COVER="cover",e.CONTAIN="contain"}(Oe||(Oe={})),function(e){e.FULL_WIDTH="full",e.MEDIUM_WIDTH="medium",e.SMALL_WIDTH="small"}(De||(De={})),function(e){e.LEFT="left",e.TOP="top",e.BOTTOM="bottom"}(Le||(Le={}));const Ue={isShowRoomSettingsModal:!1,isShowKeyboardShortcuts:!1,audioDevices:[],videoDevices:[],selectedAudioDevice:"",selectedVideoDevice:"",playAudioNotification:!1,activateWebcamsView:!0,activeScreenSharingView:!0,allowPlayAudioNotification:!0,roomAudioVolume:1,roomVideoQuality:Be.SF.HIGH,theme:"light",videoObjectFit:Oe.CONTAIN,selectedTabLeftPanel:0,selectedChatOption:"public",initiatePrivateChat:{name:"",userId:""},unreadMsgFrom:[],refreshWebcams:0,columnCameraWidth:De.FULL_WIDTH,columnCameraPosition:Le.LEFT,visibleHeader:!0,visibleFooter:!0},We=(0,g.oM)({name:"room-settings",initialState:Ue,reducers:{updateShowRoomSettingsModal:(e,t)=>{e.isShowRoomSettingsModal=t.payload},updateShowKeyboardShortcutsModal:(e,t)=>{e.isShowKeyboardShortcuts=t.payload},addAudioDevices:(e,t)=>{e.audioDevices=t.payload},addVideoDevices:(e,t)=>{e.videoDevices=t.payload},updateSelectedAudioDevice:(e,t)=>{e.selectedAudioDevice=t.payload},updateSelectedVideoDevice:(e,t)=>{e.selectedVideoDevice=t.payload},updatePlayAudioNotification:(e,t)=>{e.playAudioNotification=t.payload},updateActivateWebcamsView:(e,t)=>{e.activateWebcamsView=t.payload},updateActiveScreenSharingView:(e,t)=>{e.activeScreenSharingView=t.payload},updateAllowPlayAudioNotification:(e,t)=>{e.allowPlayAudioNotification=t.payload},updateRoomAudioVolume:(e,t)=>{e.roomAudioVolume=t.payload},updateRoomVideoQuality:(e,t)=>{e.roomVideoQuality=t.payload},updateTheme:(e,t)=>{e.theme=t.payload},updateVideoObjectFit:(e,t)=>{e.videoObjectFit=t.payload},updateSelectedTabLeftPanel:(e,t)=>{e.selectedTabLeftPanel=t.payload},updateSelectedChatOption:(e,t)=>{e.selectedChatOption=t.payload},updateInitiatePrivateChat:(e,t)=>{e.initiatePrivateChat=t.payload},updateUnreadMsgFrom:(e,t)=>{const r=[...e.unreadMsgFrom];if("ADD"===t.payload.task){r.filter((e=>e===t.payload.id)).length||(r.push(t.payload.id),e.unreadMsgFrom=r)}else"DEL"===t.payload.task&&(e.unreadMsgFrom=r.filter((e=>e!==t.payload.id)))},doRefreshWebcams:e=>{e.refreshWebcams=Date.now()},updateColumnCameraWidth:(e,t)=>{e.columnCameraWidth=t.payload},updateColumnCameraPosition:(e,t)=>{e.columnCameraPosition=t.payload},toggleHeaderVisibility:e=>{e.visibleHeader=!e.visibleHeader},toggleFooterVisibility:e=>{e.visibleFooter=!e.visibleFooter}}}),{addAudioDevices:Ge,addVideoDevices:Je,updateSelectedAudioDevice:Ve,updateSelectedVideoDevice:He,updatePlayAudioNotification:qe,updateShowRoomSettingsModal:$e,updateActivateWebcamsView:ze,updateActiveScreenSharingView:Qe,updateAllowPlayAudioNotification:Ye,updateShowKeyboardShortcutsModal:Xe,updateRoomAudioVolume:Ke,updateRoomVideoQuality:Ze,updateTheme:et,updateVideoObjectFit:tt,updateSelectedTabLeftPanel:rt,updateSelectedChatOption:at,updateInitiatePrivateChat:ot,updateUnreadMsgFrom:st,doRefreshWebcams:it,updateColumnCameraWidth:nt,updateColumnCameraPosition:lt,toggleHeaderVisibility:dt,toggleFooterVisibility:ct}=We.actions,ut=We.reducer,mt=(0,g.oM)({name:"whiteboard",initialState:{totalPages:10,currentPage:1,excalidrawElements:"",mousePointerLocation:"",whiteboardAppState:null,requestedWhiteboardData:{requested:!1,sendTo:""},currentWhiteboardOfficeFileId:"default",whiteboardOfficeFilePagesAndOtherImages:"",whiteboardUploadedOfficeFiles:[{fileId:"default",fileName:"default",filePath:"default",totalPages:10,currentPage:1,pageFiles:""}],refreshWhiteboard:0},reducers:{updateExcalidrawElements:(e,t)=>{e.excalidrawElements=t.payload},updateMousePointerLocation:(e,t)=>{e.mousePointerLocation=t.payload},updateMouseAppStateChanges:(e,t)=>{e.whiteboardAppState=t.payload},addWhiteboardOtherImageFile:(e,t)=>{let r=[];e.whiteboardOfficeFilePagesAndOtherImages&&(r=JSON.parse(e.whiteboardOfficeFilePagesAndOtherImages)),r.push(t.payload),e.whiteboardOfficeFilePagesAndOtherImages=JSON.stringify(r)},addWhiteboardFileAsJSON:(e,t)=>{e.whiteboardOfficeFilePagesAndOtherImages=t.payload},updateRequestedWhiteboardData:(e,t)=>{e.requestedWhiteboardData=t.payload},setWhiteboardCurrentPage:(e,t)=>{e.currentPage=t.payload},updateCurrentWhiteboardOfficeFileId:(e,t)=>{const r=e.whiteboardUploadedOfficeFiles.filter((e=>e.fileId===t.payload));r.length&&(e.currentPage=1,e.totalPages=r[0].totalPages,e.whiteboardOfficeFilePagesAndOtherImages=r[0].pageFiles,e.currentWhiteboardOfficeFileId=r[0].fileId)},addWhiteboardUploadedOfficeFiles:(e,t)=>{if(!e.whiteboardUploadedOfficeFiles.filter((e=>e.fileId===t.payload.fileId)).length){const r=[...e.whiteboardUploadedOfficeFiles];r.push(t.payload),e.whiteboardUploadedOfficeFiles=r}e.currentWhiteboardOfficeFileId=t.payload.fileId,e.whiteboardOfficeFilePagesAndOtherImages=t.payload.pageFiles,t.payload.currentPage?e.currentPage=t.payload.currentPage:e.currentPage=1,e.totalPages=t.payload.totalPages},doRefreshWhiteboard:e=>{e.refreshWhiteboard=Date.now()}}}),{updateExcalidrawElements:pt,updateMousePointerLocation:ht,updateMouseAppStateChanges:xt,addWhiteboardOtherImageFile:ft,updateRequestedWhiteboardData:gt,setWhiteboardCurrentPage:vt,addWhiteboardFileAsJSON:bt,updateCurrentWhiteboardOfficeFileId:yt,addWhiteboardUploadedOfficeFiles:kt,doRefreshWhiteboard:wt}=mt.actions,Tt=mt.reducer,jt=(0,g.oM)({name:"externalMediaPlayer",initialState:{action:"",seekTo:-1},reducers:{addExternalMediaPlayerAction:(e,t)=>{e.action=t.payload},externalMediaPlayerSeekTo:(e,t)=>{e.seekTo=t.payload},resetExternalMediaPlayer:e=>{e.action="",e.seekTo=-1}}}),{addExternalMediaPlayerAction:St,externalMediaPlayerSeekTo:_t,resetExternalMediaPlayer:Nt}=jt.actions,Ct=jt.reducer;var Et=r(848),Rt=r(5561),It=r(5659),At=r(210);class Pt extends Rt.v{constructor(e){super(),this.roomId="",this.userId="",this.pollId="",this.question="",this.options=[],It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Pt).fromBinary(e,t)}static fromJson(e,t){return(new Pt).fromJson(e,t)}static fromJsonString(e,t){return(new Pt).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Pt,e,t)}}Pt.runtime=It.w,Pt.typeName="plugnmeet.CreatePollReq",Pt.fields=It.w.util.newFieldList((()=>[{no:1,name:"room_id",kind:"scalar",T:9},{no:2,name:"user_id",kind:"scalar",T:9},{no:3,name:"poll_id",kind:"scalar",T:9},{no:4,name:"question",kind:"scalar",T:9},{no:5,name:"options",kind:"message",T:Ft,repeated:!0}]));class Ft extends Rt.v{constructor(e){super(),this.id=0,this.text="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Ft).fromBinary(e,t)}static fromJson(e,t){return(new Ft).fromJson(e,t)}static fromJsonString(e,t){return(new Ft).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Ft,e,t)}}Ft.runtime=It.w,Ft.typeName="plugnmeet.CreatePollOptions",Ft.fields=It.w.util.newFieldList((()=>[{no:1,name:"id",kind:"scalar",T:13},{no:2,name:"text",kind:"scalar",T:9}]));class Mt extends Rt.v{constructor(e){super(),this.id="",this.roomId="",this.question="",this.options=[],this.isRunning=!1,this.created=At.q.zero,this.createdBy="",this.closedBy="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Mt).fromBinary(e,t)}static fromJson(e,t){return(new Mt).fromJson(e,t)}static fromJsonString(e,t){return(new Mt).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Mt,e,t)}}Mt.runtime=It.w,Mt.typeName="plugnmeet.PollInfo",Mt.fields=It.w.util.newFieldList((()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"room_id",kind:"scalar",T:9},{no:3,name:"question",kind:"scalar",T:9},{no:4,name:"options",kind:"message",T:Ft,repeated:!0},{no:5,name:"is_running",kind:"scalar",T:8},{no:6,name:"created",kind:"scalar",T:3},{no:7,name:"created_by",kind:"scalar",T:9},{no:8,name:"closed_by",kind:"scalar",T:9}]));class Ot extends Rt.v{constructor(e){super(),this.roomId="",this.userId="",this.name="",this.pollId="",this.selectedOption=At.q.zero,It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Ot).fromBinary(e,t)}static fromJson(e,t){return(new Ot).fromJson(e,t)}static fromJsonString(e,t){return(new Ot).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Ot,e,t)}}Ot.runtime=It.w,Ot.typeName="plugnmeet.SubmitPollResponseReq",Ot.fields=It.w.util.newFieldList((()=>[{no:1,name:"room_id",kind:"scalar",T:9},{no:2,name:"user_id",kind:"scalar",T:9},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"poll_id",kind:"scalar",T:9},{no:5,name:"selected_option",kind:"scalar",T:4}]));class Dt extends Rt.v{constructor(e){super(),this.roomId="",this.userId="",this.pollId="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Dt).fromBinary(e,t)}static fromJson(e,t){return(new Dt).fromJson(e,t)}static fromJsonString(e,t){return(new Dt).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Dt,e,t)}}Dt.runtime=It.w,Dt.typeName="plugnmeet.ClosePollReq",Dt.fields=It.w.util.newFieldList((()=>[{no:1,name:"room_id",kind:"scalar",T:9},{no:2,name:"user_id",kind:"scalar",T:9},{no:3,name:"poll_id",kind:"scalar",T:9}]));class Lt extends Rt.v{constructor(e){super(),this.id=At.q.zero,this.text="",this.voteCount=At.q.zero,It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Lt).fromBinary(e,t)}static fromJson(e,t){return(new Lt).fromJson(e,t)}static fromJsonString(e,t){return(new Lt).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Lt,e,t)}}Lt.runtime=It.w,Lt.typeName="plugnmeet.PollResponsesResultOptions",Lt.fields=It.w.util.newFieldList((()=>[{no:1,name:"id",kind:"scalar",T:4},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"vote_count",kind:"scalar",T:4}]));class Bt extends Rt.v{constructor(e){super(),this.question="",this.totalResponses=At.q.zero,this.options=[],It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Bt).fromBinary(e,t)}static fromJson(e,t){return(new Bt).fromJson(e,t)}static fromJsonString(e,t){return(new Bt).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Bt,e,t)}}Bt.runtime=It.w,Bt.typeName="plugnmeet.PollResponsesResult",Bt.fields=It.w.util.newFieldList((()=>[{no:1,name:"question",kind:"scalar",T:9},{no:2,name:"total_responses",kind:"scalar",T:4},{no:3,name:"options",kind:"message",T:Lt,repeated:!0}]));class Ut extends Rt.v{constructor(e){super(),this.totalPolls=At.q.zero,this.totalRunning=At.q.zero,It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Ut).fromBinary(e,t)}static fromJson(e,t){return(new Ut).fromJson(e,t)}static fromJsonString(e,t){return(new Ut).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Ut,e,t)}}Ut.runtime=It.w,Ut.typeName="plugnmeet.PollsStats",Ut.fields=It.w.util.newFieldList((()=>[{no:1,name:"total_polls",kind:"scalar",T:4},{no:2,name:"total_running",kind:"scalar",T:4}]));class Wt extends Rt.v{constructor(e){super(),this.status=!1,this.msg="",this.responses={},this.polls=[],It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Wt).fromBinary(e,t)}static fromJson(e,t){return(new Wt).fromJson(e,t)}static fromJsonString(e,t){return(new Wt).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Wt,e,t)}}Wt.runtime=It.w,Wt.typeName="plugnmeet.PollResponse",Wt.fields=It.w.util.newFieldList((()=>[{no:1,name:"status",kind:"scalar",T:8},{no:2,name:"msg",kind:"scalar",T:9},{no:3,name:"poll_id",kind:"scalar",T:9,opt:!0},{no:4,name:"total_responses",kind:"scalar",T:4,opt:!0},{no:5,name:"voted",kind:"scalar",T:4,opt:!0},{no:6,name:"responses",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:7,name:"polls",kind:"message",T:Mt,repeated:!0},{no:8,name:"stats",kind:"message",T:Ut,opt:!0},{no:9,name:"total_polls",kind:"scalar",T:4,opt:!0},{no:10,name:"total_running",kind:"scalar",T:4,opt:!0},{no:11,name:"poll_responses_result",kind:"message",T:Bt,opt:!0}]));const Gt=(0,Et.LC)({reducerPath:"pollsApi",baseQuery:(0,v.ni)({baseUrl:window.PLUG_N_MEET_SERVER_URL+"/api/polls",prepareHeaders:(e,t)=>{const r=t.getState().session.token;return e.append("Authorization",r),e.append("Content-Type","application/json"),e}}),tagTypes:["List","PollsStats","Count","Selected","PollDetails","PollResult"],endpoints:e=>({getPollLists:e.query({query:()=>({url:"listPolls",responseHandler:async e=>{const t=await e.arrayBuffer();return Wt.fromBinary(new Uint8Array(t)).toJson()}}),providesTags:["List"]}),getCountTotalResponses:e.query({query:e=>({url:`countTotalResponses/${e}`,responseHandler:async e=>{const t=await e.arrayBuffer();return Wt.fromBinary(new Uint8Array(t)).toJson()}}),providesTags:e=>(null===e||void 0===e?void 0:e.status)?["Count",{type:"Count",id:null===e||void 0===e?void 0:e.pollId}]:["Count"]}),getUserSelectedOption:e.query({query:({pollId:e,userId:t})=>({url:`userSelectedOption/${e}/${t}`,responseHandler:async e=>{const t=await e.arrayBuffer();return Wt.fromBinary(new Uint8Array(t)).toJson()}}),providesTags:e=>(null===e||void 0===e?void 0:e.status)?["Selected",{type:"Selected",id:e.pollId}]:["Selected"]}),getPollResponsesDetails:e.query({query:e=>({url:`pollResponsesDetails/${e}`,responseHandler:async e=>{const t=await e.arrayBuffer();return Wt.fromBinary(new Uint8Array(t)).toJson()}}),providesTags:e=>(null===e||void 0===e?void 0:e.status)?["PollDetails",{type:"PollDetails",id:e.pollId}]:["PollDetails"]}),getPollResponsesResult:e.query({query:e=>({url:`pollResponsesResult/${e}`,responseHandler:async e=>{const t=await e.arrayBuffer();return Wt.fromBinary(new Uint8Array(t)).toJson()}}),providesTags:e=>(null===e||void 0===e?void 0:e.status)?["PollResult",{type:"PollResult",id:e.pollId}]:["PollResult"]}),getPollsStats:e.query({query:()=>({url:"pollsStats",responseHandler:async e=>{const t=await e.arrayBuffer();return Wt.fromBinary(new Uint8Array(t)).toJson()}}),providesTags:["PollsStats"]}),createPoll:e.mutation({query:e=>({url:"create",method:"POST",body:e.toBinary(),responseHandler:async e=>{const t=await e.arrayBuffer();return Wt.fromBinary(new Uint8Array(t)).toJson()}}),invalidatesTags:["List","PollsStats"]}),addResponse:e.mutation({query:e=>({url:"submitResponse",method:"POST",body:e.toBinary(),responseHandler:async e=>{const t=await e.arrayBuffer();return Wt.fromBinary(new Uint8Array(t)).toJson()}}),invalidatesTags:(e,t,{pollId:r})=>[{type:"Count",id:r},{type:"Selected",id:r},{type:"PollDetails",id:r}]}),closePoll:e.mutation({query:e=>({url:"closePoll",method:"POST",body:e.toBinary(),responseHandler:async e=>{const t=await e.arrayBuffer();return Wt.fromBinary(new Uint8Array(t)).toJson()}}),invalidatesTags:["List","PollsStats"]})})}),{useGetPollListsQuery:Jt,useGetCountTotalResponsesQuery:Vt,useGetUserSelectedOptionQuery:Ht,useGetPollResponsesDetailsQuery:qt,useCreatePollMutation:$t,useAddResponseMutation:zt,useClosePollMutation:Qt,useGetPollResponsesResultQuery:Yt,useGetPollsStatsQuery:Xt}=Gt,Kt=(0,g.oM)({name:"breakoutRoom",initialState:{droppedUser:{id:"",roomId:0},receivedInvitationFor:""},reducers:{updateBreakoutRoomDroppedUser:(e,t)=>{e.droppedUser=t.payload},updateReceivedInvitationFor:(e,t)=>{e.receivedInvitationFor=t.payload}}}),{updateBreakoutRoomDroppedUser:Zt,updateReceivedInvitationFor:er}=Kt.actions,tr=Kt.reducer;class rr extends Rt.v{constructor(e){super(),this.roomId="",this.requestedUserId="",this.duration=At.q.zero,this.rooms=[],It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new rr).fromBinary(e,t)}static fromJson(e,t){return(new rr).fromJson(e,t)}static fromJsonString(e,t){return(new rr).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(rr,e,t)}}rr.runtime=It.w,rr.typeName="plugnmeet.CreateBreakoutRoomsReq",rr.fields=It.w.util.newFieldList((()=>[{no:1,name:"room_id",kind:"scalar",T:9},{no:2,name:"requested_user_id",kind:"scalar",T:9},{no:3,name:"duration",kind:"scalar",T:4},{no:4,name:"welcome_msg",kind:"scalar",T:9,opt:!0},{no:5,name:"rooms",kind:"message",T:ar,repeated:!0}]));class ar extends Rt.v{constructor(e){super(),this.id="",this.title="",this.duration=At.q.zero,this.started=!1,this.created=At.q.zero,this.users=[],It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new ar).fromBinary(e,t)}static fromJson(e,t){return(new ar).fromJson(e,t)}static fromJsonString(e,t){return(new ar).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(ar,e,t)}}ar.runtime=It.w,ar.typeName="plugnmeet.BreakoutRoom",ar.fields=It.w.util.newFieldList((()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"title",kind:"scalar",T:9},{no:3,name:"duration",kind:"scalar",T:4},{no:4,name:"started",kind:"scalar",T:8},{no:5,name:"created",kind:"scalar",T:4},{no:6,name:"users",kind:"message",T:or,repeated:!0}]));class or extends Rt.v{constructor(e){super(),this.id="",this.name="",this.joined=!1,It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new or).fromBinary(e,t)}static fromJson(e,t){return(new or).fromJson(e,t)}static fromJsonString(e,t){return(new or).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(or,e,t)}}or.runtime=It.w,or.typeName="plugnmeet.BreakoutRoomUser",or.fields=It.w.util.newFieldList((()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"joined",kind:"scalar",T:8}]));class sr extends Rt.v{constructor(e){super(),this.breakoutRoomId="",this.duration=At.q.zero,this.roomId="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new sr).fromBinary(e,t)}static fromJson(e,t){return(new sr).fromJson(e,t)}static fromJsonString(e,t){return(new sr).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(sr,e,t)}}sr.runtime=It.w,sr.typeName="plugnmeet.IncreaseBreakoutRoomDurationReq",sr.fields=It.w.util.newFieldList((()=>[{no:1,name:"breakout_room_id",kind:"scalar",T:9},{no:2,name:"duration",kind:"scalar",T:4},{no:3,name:"room_id",kind:"scalar",T:9}]));class ir extends Rt.v{constructor(e){super(),this.msg="",this.roomId="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new ir).fromBinary(e,t)}static fromJson(e,t){return(new ir).fromJson(e,t)}static fromJsonString(e,t){return(new ir).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(ir,e,t)}}ir.runtime=It.w,ir.typeName="plugnmeet.BroadcastBreakoutRoomMsgReq",ir.fields=It.w.util.newFieldList((()=>[{no:1,name:"msg",kind:"scalar",T:9},{no:3,name:"room_id",kind:"scalar",T:9}]));class nr extends Rt.v{constructor(e){super(),this.breakoutRoomId="",this.userId="",this.roomId="",this.isAdmin=!1,It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new nr).fromBinary(e,t)}static fromJson(e,t){return(new nr).fromJson(e,t)}static fromJsonString(e,t){return(new nr).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(nr,e,t)}}nr.runtime=It.w,nr.typeName="plugnmeet.JoinBreakoutRoomReq",nr.fields=It.w.util.newFieldList((()=>[{no:1,name:"breakout_room_id",kind:"scalar",T:9},{no:2,name:"user_id",kind:"scalar",T:9},{no:3,name:"room_id",kind:"scalar",T:9},{no:4,name:"is_admin",kind:"scalar",T:8}]));class lr extends Rt.v{constructor(e){super(),this.breakoutRoomId="",this.roomId="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new lr).fromBinary(e,t)}static fromJson(e,t){return(new lr).fromJson(e,t)}static fromJsonString(e,t){return(new lr).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(lr,e,t)}}lr.runtime=It.w,lr.typeName="plugnmeet.EndBreakoutRoomReq",lr.fields=It.w.util.newFieldList((()=>[{no:1,name:"breakout_room_id",kind:"scalar",T:9},{no:3,name:"room_id",kind:"scalar",T:9}]));class dr extends Rt.v{constructor(e){super(),this.status=!1,this.msg="",this.rooms=[],It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new dr).fromBinary(e,t)}static fromJson(e,t){return(new dr).fromJson(e,t)}static fromJsonString(e,t){return(new dr).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(dr,e,t)}}dr.runtime=It.w,dr.typeName="plugnmeet.BreakoutRoomRes",dr.fields=It.w.util.newFieldList((()=>[{no:1,name:"status",kind:"scalar",T:8},{no:2,name:"msg",kind:"scalar",T:9},{no:3,name:"token",kind:"scalar",T:9,opt:!0},{no:4,name:"room",kind:"message",T:ar,opt:!0},{no:5,name:"rooms",kind:"message",T:ar,repeated:!0}]));const cr=(0,Et.LC)({reducerPath:"breakoutRoomApi",baseQuery:(0,v.ni)({baseUrl:window.PLUG_N_MEET_SERVER_URL+"/api/breakoutRoom",prepareHeaders:(e,t)=>{const r=t.getState().session.token;return e.append("Authorization",r),e.append("Content-Type","application/protobuf"),e}}),refetchOnMountOrArgChange:!0,tagTypes:["List","My_Rooms"],endpoints:e=>({getBreakoutRooms:e.query({query:()=>({url:"listRooms",responseHandler:async e=>{const t=await e.arrayBuffer();return dr.fromBinary(new Uint8Array(t)).toJson()}}),providesTags:["List"]}),createBreakoutRooms:e.mutation({query:e=>({url:"create",method:"POST",body:e.toBinary(),responseHandler:async e=>{const t=await e.arrayBuffer();return dr.fromBinary(new Uint8Array(t)).toJson()}}),invalidatesTags:["List"]}),increaseDuration:e.mutation({query:e=>({url:"increaseDuration",method:"POST",body:e.toBinary(),responseHandler:async e=>{const t=await e.arrayBuffer();return dr.fromBinary(new Uint8Array(t)).toJson()}}),invalidatesTags:["List"]}),broadcastBreakoutRoomMsg:e.mutation({query:e=>({url:"sendMsg",method:"POST",body:e.toBinary(),responseHandler:async e=>{const t=await e.arrayBuffer();return dr.fromBinary(new Uint8Array(t)).toJson()}})}),joinRoom:e.mutation({query:e=>({url:"join",method:"POST",body:e.toBinary(),responseHandler:async e=>{const t=await e.arrayBuffer();return dr.fromBinary(new Uint8Array(t)).toJson()}})}),getMyBreakoutRooms:e.query({query:()=>({url:"myRooms",responseHandler:async e=>{const t=await e.arrayBuffer();return dr.fromBinary(new Uint8Array(t)).toJson()}}),providesTags:["My_Rooms"]}),endSingleRoom:e.mutation({query:e=>({url:"endRoom",method:"POST",body:e.toBinary(),responseHandler:async e=>{const t=await e.arrayBuffer();return dr.fromBinary(new Uint8Array(t)).toJson()}}),invalidatesTags:["List"]}),endAllRooms:e.mutation({query:()=>({url:"endAllRooms",method:"POST",responseHandler:async e=>{const t=await e.arrayBuffer();return dr.fromBinary(new Uint8Array(t)).toJson()}}),invalidatesTags:["List"]})})}),{useGetBreakoutRoomsQuery:ur,useCreateBreakoutRoomsMutation:mr,useIncreaseDurationMutation:pr,useJoinRoomMutation:hr,useEndSingleRoomMutation:xr,useEndAllRoomsMutation:fr,useBroadcastBreakoutRoomMsgMutation:gr,useGetMyBreakoutRoomsQuery:vr}=cr,br=(0,g.xC)({reducer:{participants:F,activeSpeakers:N,session:K,bottomIconsActivity:Ce,chatMessages:Me,roomSettings:ut,whiteboard:Tt,externalMediaPlayer:Ct,breakoutRoom:tr,[Gt.reducerPath]:Gt.reducer,[cr.reducerPath]:cr.reducer},middleware:e=>e().concat(Gt.middleware,cr.middleware),enhancers:e=>e.concat((0,g.bu)()),devTools:!1});(0,v.sj)(br.dispatch);const yr=()=>(0,n.I0)(),kr=n.v9;var wr=r(2222);const Tr=({title:e,text:t})=>{var r;const a=null!==(r=window.STATIC_ASSETS_PATH)&&void 0!==r?r:"./assets";return(0,o.jsxs)("div",{id:"errorPage",className:"error-page h-screen w-full flex items-center justify-center",children:[(0,o.jsx)("div",{className:"error-app-bg absolute w-full h-full left-0 top-0 object-cover pointer-events-none bg-cover bg-center bg-no-repeat",style:{backgroundImage:`url("${a}/imgs/app-banner.jpg")`}}),(0,o.jsx)("div",{className:"content relative z-20 text-center bg-white dark:bg-darkPrimary/90 rounded-xl shadow-lg h-80 w-[450px] flex items-center justify-center",children:(0,o.jsxs)("div",{className:"inner text-center dark:text-darkText",children:[(0,o.jsx)("h2",{className:"text-3xl font-medium mb-4",children:e}),(0,o.jsx)("p",{children:t})]})})]})},jr=({text:e})=>(0,o.jsx)("div",{className:"loader opacity-1 fixed top-0 left-0 w-full h-full bg-white/90 dark:bg-darkPrimary/90 z-[999] flex flex-wrap items-center justify-center",children:(0,o.jsxs)("div",{className:"inner",children:[(0,o.jsxs)("div",{className:"lds-ripple",children:[(0,o.jsx)("div",{className:"border-secondaryColor"}),(0,o.jsx)("div",{className:"border-secondaryColor"})]}),(0,o.jsx)("p",{className:"block w-full text-center relative bottom-4 capitalize dark:text-darkText",children:e})]})});var Sr=r(5285),_r=r(7535);async function Nr(e){let t={audio:!0};"videoinput"===e&&(t={video:!0});const r=await navigator.mediaDevices.getUserMedia(t);let a=await navigator.mediaDevices.enumerateDevices();if(a=a.filter((t=>t.kind===e)),a.length>1&&"default"===a[0].deviceId){const e=a[0];for(let t=1;t<a.length;t+=1)if(a[t].groupId===e.groupId){const e=a[0];a[0]=a[t],a[t]=e;break}return a.filter((t=>t!==e))}return r.getTracks().forEach((function(e){e.stop()})),a}const Cr=e=>e.toString(16).padStart(2,"0"),Er=(e=20)=>{const t=new Uint8Array(e/2);return window.crypto.getRandomValues(t),Array.from(t,Cr).join("")},Rr=(e=10)=>{const t=new Uint8Array(e/2);return window.crypto.getRandomValues(t),Number(t.join(""))},Ir=e=>new Promise((t=>setTimeout(t,e))),Ar=()=>{var e;const t=null!==(e=window.DEFAULT_SCREEN_SHARE_RESOLUTION)&&void 0!==e?e:"h1080fps15";let r=Be.Ri.h1080fps15.resolution;switch(t){case"h360fps3":r=Be.Ri.h360fps3.resolution;break;case"h720fps5":r=Be.Ri.h720fps5.resolution;break;case"h720fps15":r=Be.Ri.h720fps15.resolution;break;case"h1080fps15":r=Be.Ri.h1080fps15.resolution;break;case"h1080fps30":r=Be.Ri.h1080fps30.resolution}return r},Pr=({deviceId:e,onSourcePlayback:t,onMediaStream:r})=>{const a=(0,s.useRef)(null);(0,s.useEffect)((()=>{const t=a.current,o={video:{deviceId:e}};return navigator.mediaDevices.getUserMedia(o).then((e=>{t&&(r(e),t.srcObject=e)})),()=>{t&&(t.pause(),t.removeAttribute("src"))}}),[e]);return(0,o.jsx)("div",{className:"preview-camera-webcam",children:(0,o.jsx)("video",{className:"my-5 w-full",ref:a,autoPlay:!0,height:"50",onLoadedData:e=>{var r,a;const o=e.target;t({htmlElement:o,width:null!==(r=o.videoWidth)&&void 0!==r?r:330,height:null!==(a=o.videoHeight)&&void 0!==a?a:200})}})})},Fr={"640x360":[640,360],"256x256":[256,256],"256x144":[256,144],"160x96":[160,96]},Mr={model:"meet",backend:"wasmSimd",inputResolution:"160x96",pipeline:"canvas2dCpu"};function Or(e,t,r,a,o,s,i){const n=a.getContext("2d"),[l,d]=Fr[r.inputResolution],c=l*d,u=new ImageData(l,d),m=document.createElement("canvas");m.width=l,m.height=d;const p=document.createElement("img");p.crossOrigin="anonymous",p.src=t.url;const h=m.getContext("2d"),x=s._getInputMemoryOffset()/4,f=s._getOutputMemoryOffset()/4;let g;return{render:async function(){"none"!==t.type&&function(){if(h.drawImage(e.htmlElement,0,0,e.width,e.height,0,0,l,d),"meet"===r.model||"mlkit"===r.model){const e=h.getImageData(0,0,l,d);for(let t=0;t<c;t++)s.HEAPF32[x+3*t]=e.data[4*t]/255,s.HEAPF32[x+3*t+1]=e.data[4*t+1]/255,s.HEAPF32[x+3*t+2]=e.data[4*t+2]/255}}(),i(),"none"!==t.type&&("bodyPix"===r.model?await async function(){const e=await o.segmentPerson(m);for(let t=0;t<c;t++)u.data[4*t+3]=e.data[t]?255:0;h.putImageData(u,0,0)}():function(){s._runInference();for(let e=0;e<c;e++)if("meet"===r.model){const t=s.HEAPF32[f+2*e],r=s.HEAPF32[f+2*e+1],a=Math.max(t,r),o=Math.exp(t-a),i=Math.exp(r-a);u.data[4*e+3]=255*i/(o+i)}else if("mlkit"===r.model){const t=s.HEAPF32[f+e];u.data[4*e+3]=255*t}h.putImageData(u,0,0)}()),i(),function(){n.globalCompositeOperation="copy",n.filter="none",(null===g||void 0===g?void 0:g.smoothSegmentationMask)&&("blur"===t.type?n.filter="blur(8px)":"image"===t.type&&(n.filter="blur(4px)"));"none"!==t.type&&(n.drawImage(m,0,0,l,d,0,0,e.width,e.height),n.globalCompositeOperation="source-in",n.filter="none");n.drawImage(e.htmlElement,0,0),"blur"===t.type?(n.globalCompositeOperation="destination-over",n.filter="blur(8px)",n.drawImage(e.htmlElement,0,0)):"image"===t.type&&(n.globalCompositeOperation="destination-over",function(e,t,r,a,o,s,i,n){2===arguments.length&&(r=a=0,o=e.canvas.width,s=e.canvas.height);(i="number"===typeof i?i:.5)<0&&(i=0);(n="number"===typeof n?n:.5)<0&&(n=0);i>1&&(i=1);n>1&&(n=1);const l=t.width,d=t.height,c=Math.min(o/l,s/d);let u,m,p,h,x=l*c,f=d*c,g=1;x<o&&(g=o/x);Math.abs(g-1)<1e-14&&f<s&&(g=s/f);x*=g,f*=g,p=l/(x/o),h=d/(f/s),u=(l-p)*i,m=(d-h)*n,u<0&&(u=0);m<0&&(m=0);p>l&&(p=l);h>d&&(h=d);e.drawImage(t,u,m,p,h,r,a,o,s)}(n,p,0,0,n.canvas.width,n.canvas.height,.5,.5))}()},updatePostProcessingConfig:function(e){g=e},cleanUp:function(){}}}const Dr=String.raw;function Lr(e,t,r,a,o){const s=function(e,t,r){const a=e.createProgram();if(e.attachShader(a,t),e.attachShader(a,r),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS))throw new Error(`Could not link WebGL program: ${e.getProgramInfoLog(a)}`);return a}(e,t,r),i=e.getAttribLocation(s,"a_position");e.enableVertexAttribArray(i),e.bindBuffer(e.ARRAY_BUFFER,a),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0);const n=e.getAttribLocation(s,"a_texCoord");return e.enableVertexAttribArray(n),e.bindBuffer(e.ARRAY_BUFFER,o),e.vertexAttribPointer(n,2,e.FLOAT,!1,0,0),s}function Br(e,t,r){const a=e.createShader(t);if(e.shaderSource(a,r),e.compileShader(a),!e.getShaderParameter(a,e.COMPILE_STATUS))throw new Error(`Could not compile shader: ${e.getShaderInfoLog(a)}`);return a}function Ur(e,t,r,a,o=e.NEAREST,s=e.NEAREST){const i=e.createTexture();return e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,s),e.texStorage2D(e.TEXTURE_2D,1,t,r,a),i}async function Wr(e,t,r,a,o,s,i,n){const l=e.createBuffer();return e.bindBuffer(e.PIXEL_PACK_BUFFER,l),e.bufferData(e.PIXEL_PACK_BUFFER,n.byteLength,e.STREAM_READ),e.readPixels(t,r,a,o,s,i,0),e.bindBuffer(e.PIXEL_PACK_BUFFER,null),await async function(e,t,r,a,o,s,i){const n=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush();const l=await function(e,t){return new Promise((r=>{function a(){const o=e.clientWaitSync(t,0,0);o!==e.WAIT_FAILED?o!==e.TIMEOUT_EXPIRED?r(o):requestAnimationFrame(a):r(o)}requestAnimationFrame(a)}))}(e,n);e.deleteSync(n),l!==e.WAIT_FAILED&&(e.bindBuffer(t,r),e.getBufferSubData(t,a,o,s,i),e.bindBuffer(t,null))}(e,e.PIXEL_PACK_BUFFER,l,0,n),e.deleteBuffer(l),n}function Gr(e,t,r,a,o,s){const i=function(e,t,r,a,o,s){const i=Dr`#version 300 es

    precision highp float;

    uniform sampler2D u_inputFrame;
    uniform sampler2D u_personMask;
    uniform vec2 u_texelSize;

    in vec2 v_texCoord;

    out vec4 outColor;

    const float offset[5] = float[](0.0, 1.0, 2.0, 3.0, 4.0);
    const float weight[5] = float[](0.2270270270, 0.1945945946, 0.1216216216,
      0.0540540541, 0.0162162162);

    void main() {
      vec4 centerColor = texture(u_inputFrame, v_texCoord);
      float personMask = texture(u_personMask, v_texCoord).a;

      vec4 frameColor = centerColor * weight[0] * (1.0 - personMask);

      for (int i = 1; i < 5; i++) {
        vec2 offset = vec2(offset[i]) * u_texelSize;

        vec2 texCoord = v_texCoord + offset;
        frameColor += texture(u_inputFrame, texCoord) * weight[i] *
          (1.0 - texture(u_personMask, texCoord).a);

        texCoord = v_texCoord - offset;
        frameColor += texture(u_inputFrame, texCoord) * weight[i] *
          (1.0 - texture(u_personMask, texCoord).a);
      }
      outColor = vec4(frameColor.rgb + (1.0 - frameColor.a) * centerColor.rgb, 1.0);
    }
  `,n=.5,l=s.width*n,d=s.height*n,c=1/l,u=1/d,m=Br(e,e.FRAGMENT_SHADER,i),p=Lr(e,t,m,r,a),h=e.getUniformLocation(p,"u_inputFrame"),x=e.getUniformLocation(p,"u_personMask"),f=e.getUniformLocation(p,"u_texelSize"),g=Ur(e,e.RGBA8,l,d,e.NEAREST,e.NEAREST),v=Ur(e,e.RGBA8,l,d,e.NEAREST,e.NEAREST),b=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,b),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,g,0);const y=e.createFramebuffer();function k(){e.viewport(0,0,l,d),e.useProgram(p),e.uniform1i(h,0),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,o);for(let t=0;t<3;t++)e.uniform2f(f,0,u),e.bindFramebuffer(e.FRAMEBUFFER,b),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,g),e.uniform1i(h,2),e.uniform2f(f,c,0),e.bindFramebuffer(e.FRAMEBUFFER,y),e.drawArrays(e.TRIANGLE_STRIP,0,4),e.bindTexture(e.TEXTURE_2D,v)}function w(){e.deleteFramebuffer(y),e.deleteFramebuffer(b),e.deleteTexture(v),e.deleteTexture(g),e.deleteProgram(p),e.deleteShader(m)}return e.bindFramebuffer(e.FRAMEBUFFER,y),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,v,0),e.useProgram(p),e.uniform1i(x,1),{render:k,cleanUp:w}}(e,t,r,a,o,s),n=function(e,t,r,a){const o=Dr`#version 300 es

    in vec2 a_position;
    in vec2 a_texCoord;

    out vec2 v_texCoord;

    void main() {
      // Flipping Y is required when rendering to canvas
      gl_Position = vec4(a_position * vec2(1.0, -1.0), 0.0, 1.0);
      v_texCoord = a_texCoord;
    }
  `,s=Dr`#version 300 es

    precision highp float;

    uniform sampler2D u_inputFrame;
    uniform sampler2D u_personMask;
    uniform sampler2D u_blurredInputFrame;
    uniform vec2 u_coverage;

    in vec2 v_texCoord;

    out vec4 outColor;

    void main() {
      vec3 color = texture(u_inputFrame, v_texCoord).rgb;
      vec3 blurredColor = texture(u_blurredInputFrame, v_texCoord).rgb;
      float personMask = texture(u_personMask, v_texCoord).a;
      personMask = smoothstep(u_coverage.x, u_coverage.y, personMask);
      outColor = vec4(mix(blurredColor, color, personMask), 1.0);
    }
  `,{width:i,height:n}=a,l=Br(e,e.VERTEX_SHADER,o),d=Br(e,e.FRAGMENT_SHADER,s),c=Lr(e,l,d,t,r),u=e.getUniformLocation(c,"u_inputFrame"),m=e.getUniformLocation(c,"u_personMask"),p=e.getUniformLocation(c,"u_blurredInputFrame"),h=e.getUniformLocation(c,"u_coverage");function x(){e.viewport(0,0,i,n),e.useProgram(c),e.bindFramebuffer(e.FRAMEBUFFER,null),e.drawArrays(e.TRIANGLE_STRIP,0,4)}function f(t){e.useProgram(c),e.uniform2f(h,t[0],t[1])}function g(){e.deleteProgram(c),e.deleteShader(d),e.deleteShader(l)}return e.useProgram(c),e.uniform1i(u,0),e.uniform1i(m,1),e.uniform1i(p,2),e.uniform2f(h,0,1),{render:x,updateCoverage:f,cleanUp:g}}(e,r,a,s);return{render:function(){i.render(),n.render()},updateCoverage:function(e){n.updateCoverage(e)},cleanUp:function(){n.cleanUp(),i.cleanUp()}}}function Jr(e,t,r,a,o,s,i){const n=Dr`#version 300 es

    in vec2 a_position;
    in vec2 a_texCoord;

    out vec2 v_texCoord;

    void main() {
      gl_Position = vec4(a_position, 0.0, 1.0);
      v_texCoord = a_texCoord;
    }
  `,{width:l,height:d}=e,[c,u]=Fr[a.inputResolution],m=o.getContext("webgl2"),p=Br(m,m.VERTEX_SHADER,n),h=m.createVertexArray();m.bindVertexArray(h);const x=m.createBuffer();m.bindBuffer(m.ARRAY_BUFFER,x),m.bufferData(m.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),m.STATIC_DRAW);const f=m.createBuffer();m.bindBuffer(m.ARRAY_BUFFER,f),m.bufferData(m.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,1,1]),m.STATIC_DRAW);const g=m.createTexture();m.bindTexture(m.TEXTURE_2D,g),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.NEAREST),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.NEAREST);const v=Ur(m,m.RGBA8,c,u),b=Ur(m,m.RGBA8,l,d),y=function(e,t,r,a,o,s){const i=Dr`#version 300 es

    precision highp float;

    uniform sampler2D u_inputFrame;

    in vec2 v_texCoord;

    out vec4 outColor;

    void main() {
      outColor = texture(u_inputFrame, v_texCoord);
    }
  `,n=s._getInputMemoryOffset()/4,[l,d]=Fr[o.inputResolution],c=l*d,u=Br(e,e.FRAGMENT_SHADER,i),m=Lr(e,t,u,r,a),p=e.getUniformLocation(m,"u_inputFrame"),h=Ur(e,e.RGBA8,l,d),x=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,x),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,h,0);const f=new Uint8Array(4*c);return e.useProgram(m),e.uniform1i(p,0),{render:function(){e.viewport(0,0,l,d),e.useProgram(m),e.bindFramebuffer(e.FRAMEBUFFER,x),e.drawArrays(e.TRIANGLE_STRIP,0,4),Wr(e,0,0,l,d,e.RGBA,e.UNSIGNED_BYTE,f);for(let e=0;e<c;e++){const t=n+3*e,r=4*e;s.HEAPF32[t]=f[r]/255,s.HEAPF32[t+1]=f[r+1]/255,s.HEAPF32[t+2]=f[r+2]/255}},cleanUp:function(){e.deleteFramebuffer(x),e.deleteTexture(h),e.deleteProgram(m),e.deleteShader(u)}}}(m,p,x,f,a,s),k="meet"===a.model?function(e,t,r,a,o,s,i){const n=Dr`#version 300 es

    precision highp float;

    uniform sampler2D u_inputSegmentation;

    in vec2 v_texCoord;

    out vec4 outColor;

    void main() {
      vec2 segmentation = texture(u_inputSegmentation, v_texCoord).rg;
      float shift = max(segmentation.r, segmentation.g);
      float backgroundExp = exp(segmentation.r - shift);
      float personExp = exp(segmentation.g - shift);
      outColor = vec4(vec3(0.0), personExp / (backgroundExp + personExp));
    }
  `,l=s._getOutputMemoryOffset()/4,[d,c]=Fr[o.inputResolution],u=Br(e,e.FRAGMENT_SHADER,n),m=Lr(e,t,u,r,a),p=e.getUniformLocation(m,"u_inputSegmentation"),h=Ur(e,e.RG32F,d,c),x=e.createFramebuffer();return e.bindFramebuffer(e.FRAMEBUFFER,x),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0),e.useProgram(m),e.uniform1i(p,1),{render:function(){e.viewport(0,0,d,c),e.useProgram(m),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,h),e.texSubImage2D(e.TEXTURE_2D,0,0,0,d,c,e.RG,e.FLOAT,s.HEAPF32,l),e.bindFramebuffer(e.FRAMEBUFFER,x),e.drawArrays(e.TRIANGLE_STRIP,0,4)},cleanUp:function(){e.deleteFramebuffer(x),e.deleteTexture(h),e.deleteProgram(m),e.deleteShader(u)}}}(m,p,x,f,a,s,v):function(e,t,r,a,o,s,i){const n=Dr`#version 300 es

    precision highp float;

    uniform sampler2D u_inputSegmentation;

    in vec2 v_texCoord;

    out vec4 outColor;

    void main() {
      float segmentation = texture(u_inputSegmentation, v_texCoord).r;
      outColor = vec4(vec3(0.0), segmentation);
    }
  `,l=s._getOutputMemoryOffset()/4,[d,c]=Fr[o.inputResolution],u=Br(e,e.FRAGMENT_SHADER,n),m=Lr(e,t,u,r,a),p=e.getUniformLocation(m,"u_inputSegmentation"),h=Ur(e,e.R32F,d,c),x=e.createFramebuffer();return e.bindFramebuffer(e.FRAMEBUFFER,x),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0),e.useProgram(m),e.uniform1i(p,1),{render:function(){e.viewport(0,0,d,c),e.useProgram(m),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,h),e.texSubImage2D(e.TEXTURE_2D,0,0,0,d,c,e.RED,e.FLOAT,s.HEAPF32,l),e.bindFramebuffer(e.FRAMEBUFFER,x),e.drawArrays(e.TRIANGLE_STRIP,0,4)},cleanUp:function(){e.deleteFramebuffer(x),e.deleteTexture(h),e.deleteProgram(m),e.deleteShader(u)}}}(m,p,x,f,a,s,v),w=function(e,t,r,a,o,s,i,n){const l=Dr`#version 300 es

    precision highp float;

    uniform sampler2D u_inputFrame;
    uniform sampler2D u_segmentationMask;
    uniform vec2 u_texelSize;
    uniform float u_step;
    uniform float u_radius;
    uniform float u_offset;
    uniform float u_sigmaTexel;
    uniform float u_sigmaColor;

    in vec2 v_texCoord;

    out vec4 outColor;

    float gaussian(float x, float sigma) {
      float coeff = -0.5 / (sigma * sigma * 4.0 + 1.0e-6);
      return exp((x * x) * coeff);
    }

    void main() {
      vec2 centerCoord = v_texCoord;
      vec3 centerColor = texture(u_inputFrame, centerCoord).rgb;
      float newVal = 0.0;

      float spaceWeight = 0.0;
      float colorWeight = 0.0;
      float totalWeight = 0.0;

      // Subsample kernel space.
      for (float i = -u_radius + u_offset; i <= u_radius; i += u_step) {
        for (float j = -u_radius + u_offset; j <= u_radius; j += u_step) {
          vec2 shift = vec2(j, i) * u_texelSize;
          vec2 coord = vec2(centerCoord + shift);
          vec3 frameColor = texture(u_inputFrame, coord).rgb;
          float outVal = texture(u_segmentationMask, coord).a;

          spaceWeight = gaussian(distance(centerCoord, coord), u_sigmaTexel);
          colorWeight = gaussian(distance(centerColor, frameColor), u_sigmaColor);
          totalWeight += spaceWeight * colorWeight;

          newVal += spaceWeight * colorWeight * outVal;
        }
      }
      newVal /= totalWeight;

      outColor = vec4(vec3(0.0), newVal);
    }
  `,[d,c]=Fr[s.inputResolution],{width:u,height:m}=n,p=1/u,h=1/m,x=Br(e,e.FRAGMENT_SHADER,l),f=Lr(e,t,x,r,a),g=e.getUniformLocation(f,"u_inputFrame"),v=e.getUniformLocation(f,"u_segmentationMask"),b=e.getUniformLocation(f,"u_texelSize"),y=e.getUniformLocation(f,"u_step"),k=e.getUniformLocation(f,"u_radius"),w=e.getUniformLocation(f,"u_offset"),T=e.getUniformLocation(f,"u_sigmaTexel"),j=e.getUniformLocation(f,"u_sigmaColor"),S=e.createFramebuffer();function _(t){t*=Math.max(u/d,m/c);const r=Math.max(1,.66*Math.sqrt(t)),a=t,o=r>1?.5*r:0,s=Math.max(p,h)*t;e.useProgram(f),e.uniform1f(y,r),e.uniform1f(k,a),e.uniform1f(w,o),e.uniform1f(T,s)}function N(t){e.useProgram(f),e.uniform1f(j,t)}return e.bindFramebuffer(e.FRAMEBUFFER,S),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0),e.useProgram(f),e.uniform1i(g,0),e.uniform1i(v,1),e.uniform2f(b,p,h),_(0),N(0),{render:function(){e.viewport(0,0,u,m),e.useProgram(f),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,o),e.bindFramebuffer(e.FRAMEBUFFER,S),e.drawArrays(e.TRIANGLE_STRIP,0,4)},updateSigmaSpace:_,updateSigmaColor:N,cleanUp:function(){e.deleteFramebuffer(S),e.deleteProgram(f),e.deleteShader(x)}}}(m,p,x,f,v,a,b,o),T="blur"===r.type?Gr(m,p,x,f,b,o):function(e,t,r,a,o,s){const i=Dr`#version 300 es

    uniform vec2 u_backgroundScale;
    uniform vec2 u_backgroundOffset;

    in vec2 a_position;
    in vec2 a_texCoord;

    out vec2 v_texCoord;
    out vec2 v_backgroundCoord;

    void main() {
      // Flipping Y is required when rendering to canvas
      gl_Position = vec4(a_position * vec2(1.0, -1.0), 0.0, 1.0);
      v_texCoord = a_texCoord;
      v_backgroundCoord = a_texCoord * u_backgroundScale + u_backgroundOffset;
    }
  `,n=Dr`#version 300 es

    precision highp float;

    uniform sampler2D u_inputFrame;
    uniform sampler2D u_personMask;
    uniform sampler2D u_background;
    uniform vec2 u_coverage;
    uniform float u_lightWrapping;
    uniform float u_blendMode;

    in vec2 v_texCoord;
    in vec2 v_backgroundCoord;

    out vec4 outColor;

    vec3 screen(vec3 a, vec3 b) {
      return 1.0 - (1.0 - a) * (1.0 - b);
    }

    vec3 linearDodge(vec3 a, vec3 b) {
      return a + b;
    }

    void main() {
      vec3 frameColor = texture(u_inputFrame, v_texCoord).rgb;
      vec3 backgroundColor = texture(u_background, v_backgroundCoord).rgb;
      float personMask = texture(u_personMask, v_texCoord).a;
      float lightWrapMask = 1.0 - max(0.0, personMask - u_coverage.y) / (1.0 - u_coverage.y);
      vec3 lightWrap = u_lightWrapping * lightWrapMask * backgroundColor;
      frameColor = u_blendMode * linearDodge(frameColor, lightWrap) +
        (1.0 - u_blendMode) * screen(frameColor, lightWrap);
      personMask = smoothstep(u_coverage.x, u_coverage.y, personMask);
      outColor = vec4(frameColor * personMask + backgroundColor * (1.0 - personMask), 1.0);
    }
  `,{width:l,height:d}=s,c=l/d,u=Br(e,e.VERTEX_SHADER,i),m=Br(e,e.FRAGMENT_SHADER,n),p=Lr(e,u,m,t,r),h=e.getUniformLocation(p,"u_backgroundScale"),x=e.getUniformLocation(p,"u_backgroundOffset"),f=e.getUniformLocation(p,"u_inputFrame"),g=e.getUniformLocation(p,"u_personMask"),v=e.getUniformLocation(p,"u_background"),b=e.getUniformLocation(p,"u_coverage"),y=e.getUniformLocation(p,"u_lightWrapping"),k=e.getUniformLocation(p,"u_blendMode");e.useProgram(p),e.uniform2f(h,1,1),e.uniform2f(x,0,0),e.uniform1i(f,0),e.uniform1i(g,1),e.uniform2f(b,0,1),e.uniform1f(y,0),e.uniform1f(k,0);let w=null;function T(t){w=Ur(e,e.RGBA8,t.naturalWidth,t.naturalHeight,e.NEAREST,e.NEAREST),e.texSubImage2D(e.TEXTURE_2D,0,0,0,t.naturalWidth,t.naturalHeight,e.RGBA,e.UNSIGNED_BYTE,t);let r=0,a=0,o=t.naturalWidth,s=t.naturalHeight;o/s<c?(s=o/c,a=(t.naturalHeight-s)/2):(o=s*c,r=(t.naturalWidth-o)/2);const i=o/t.naturalWidth,n=s/t.naturalHeight;r/=t.naturalWidth,a/=t.naturalHeight,e.uniform2f(h,i,n),e.uniform2f(x,r,a)}return(null===o||void 0===o?void 0:o.complete)?T(o):o&&(o.onload=()=>{T(o)}),{render:function(){e.viewport(0,0,l,d),e.useProgram(p),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,a),null!==w&&(e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,w),e.uniform1i(v,2)),e.bindFramebuffer(e.FRAMEBUFFER,null),e.drawArrays(e.TRIANGLE_STRIP,0,4)},updateCoverage:function(t){e.useProgram(p),e.uniform2f(b,t[0],t[1])},updateLightWrapping:function(t){e.useProgram(p),e.uniform1f(y,t)},updateBlendMode:function(t){e.useProgram(p),e.uniform1f(k,"screen"===t?0:1)},cleanUp:function(){e.deleteTexture(w),e.deleteProgram(p),e.deleteShader(m),e.deleteShader(u)}}}(m,x,f,b,t,o);return{render:async function(){m.clearColor(0,0,0,0),m.clear(m.COLOR_BUFFER_BIT),m.activeTexture(m.TEXTURE0),m.bindTexture(m.TEXTURE_2D,g),m.texImage2D(m.TEXTURE_2D,0,m.RGBA,m.RGBA,m.UNSIGNED_BYTE,e.htmlElement),m.bindVertexArray(h),y.render(),i(),s._runInference(),i(),k.render(),w.render(),T.render()},updatePostProcessingConfig:function(e){if(w.updateSigmaSpace(e.jointBilateralFilter.sigmaSpace),w.updateSigmaColor(e.jointBilateralFilter.sigmaColor),"image"===r.type){const t=T;t.updateCoverage(e.coverage),t.updateLightWrapping(e.lightWrapping),t.updateBlendMode(e.blendMode)}else if("blur"===r.type){T.updateCoverage(e.coverage)}else{const e=T;e.updateCoverage([0,.9999]),e.updateLightWrapping(0)}},cleanUp:function(){T.cleanUp(),w.cleanUp(),k.cleanUp(),y.cleanUp(),m.deleteTexture(b),m.deleteTexture(v),m.deleteTexture(g),m.deleteBuffer(f),m.deleteBuffer(x),m.deleteVertexArray(h),m.deleteShader(p)}}}const Vr=function(e,t,r,a,o){const[i,n]=(0,s.useState)(null),l=(0,s.useRef)(null),d=(0,s.useRef)(null),[c,u]=(0,s.useState)(0),[m,p]=(0,s.useState)([]);return(0,s.useEffect)((()=>{let s=!0,i=0,c=0,m=0,h=0;const x=[];let f;const g="webgl2"===r.pipeline?Jr(e,l.current,t,r,d.current,o,v):Or(e,t,r,d.current,a,o,v);function v(){const e=Date.now();x[m]=e-c,c=e,m++}return async function e(){s&&(c=Date.now(),await g.render(),function(){const e=Date.now();x[m]=e-c,h++,e>=i+1e3&&(u(1e3*h/(e-i)),p(x),i=e,h=0);m=0}(),f=requestAnimationFrame(e))}(),n(g),()=>{s=!1,cancelAnimationFrame(f),g.cleanUp(),n(null)}}),[e,t,r,a,o]),{pipeline:i,backgroundImageRef:l,canvasRef:d,fps:c,durations:m}},Hr=({sourcePlayback:e,backgroundConfig:t,segmentationConfig:r,postProcessingConfig:a,bodyPix:i,tflite:n,id:l,onCanvasRef:d})=>{const{pipeline:c,canvasRef:u}=Vr(e,t,r,i,n);return(0,s.useEffect)((()=>{c&&c.updatePostProcessingConfig(a)}),[c,a]),(0,s.useEffect)((()=>{const e=setTimeout((()=>{d&&u&&d(u)}),500);return()=>{clearTimeout(e)}}),[u]),(0,o.jsx)("div",{className:"root preview-camera-webcam",children:(0,o.jsx)("canvas",{ref:u,className:"render w-full my-5",width:e.width,height:e.height,id:l},r.pipeline)})},qr={smoothSegmentationMask:!0,jointBilateralFilter:{sigmaSpace:1,sigmaColor:.1},coverage:[.5,.75],lightWrapping:.3,blendMode:"screen"};var $r=r(2030),zr=(r(5186),r(9966));r(6823);let Qr;const Yr=function(){const[e,t]=(0,s.useState)();return(0,s.useEffect)((()=>{let e;return Qr?t(Qr):e=setTimeout((()=>{!async function(){console.log("Loading TensorFlow.js and BodyPix segmentation model"),await zr.Cd_(),Qr=await $r.zD(),t(Qr),console.log("TensorFlow.js and BodyPix loaded")}()}),500),()=>{e&&clearTimeout(e)}}),[]),e};const Xr=function(e){var t;const[r,a]=(0,s.useState)(),[o,i]=(0,s.useState)(),[n,l]=(0,s.useState)(),[d,c]=(0,s.useState)(!1),u=null!==(t=window.STATIC_ASSETS_PATH)&&void 0!==t?t:"./assets";return(0,s.useEffect)((()=>{!async function(){try{const e=await createTFLiteSIMDModule();i(e),a(e),c(!0)}catch(e){try{createTFLiteModule().then(a)}catch(t){console.warn("Failed to create TFLite WebAssembly module.",t)}}}()}),[]),(0,s.useEffect)((()=>{!async function(){if(!r||d&&!o||!d&&"wasmSimd"===e.backend||"meet"!==e.model&&"mlkit"!==e.model)return;l(void 0);const t="wasmSimd"===e.backend?o:r;if(!t)throw new Error(`TFLite backend unavailable: ${e.backend}`);const a=function(e,t){switch(e){case"meet":return"256x144"===t?"segm_full_v679":"segm_lite_v681";case"mlkit":return"selfiesegmentation_mlkit-256x256-2021_01_19-v1215.f16";default:throw new Error(`No TFLite file for this segmentation model: ${e}`)}}(e.model,e.inputResolution);console.log("Loading tflite model:",a);const s=await fetch(`${u}/models/${a}.tflite`),i=await s.arrayBuffer();console.log("Model buffer size:",i.byteLength);const n=t._getModelBufferMemoryOffset();console.log("Model buffer memory offset:",n),console.log("Loading model buffer..."),t.HEAPU8.set(new Uint8Array(i),n),console.log("_loadModel result:",t._loadModel(i.byteLength)),console.log("Input memory offset:",t._getInputMemoryOffset()),console.log("Input height:",t._getInputHeight()),console.log("Input width:",t._getInputWidth()),console.log("Input channels:",t._getInputChannelCount()),console.log("Output memory offset:",t._getOutputMemoryOffset()),console.log("Output height:",t._getOutputHeight()),console.log("Output width:",t._getOutputWidth()),console.log("Output channels:",t._getOutputChannelCount()),l(t)}()}),[r,o,d,e.model,e.backend,e.inputResolution]),{tflite:n,isSIMDSupported:d}},Kr=({sourcePlayback:e,backgroundConfig:t,id:r,onCanvasRef:a})=>{const[i,n]=(0,s.useState)(Mr),l=Yr(),{tflite:d,isSIMDSupported:c}=Xr(i);return(0,s.useEffect)((()=>{l&&n((e=>"wasmSimd"!==e.backend||c?e:{...e,backend:"wasm"}))}),[c]),(0,o.jsx)(o.Fragment,{children:e&&l&&d?(0,o.jsx)(Hr,{sourcePlayback:e,backgroundConfig:null!==t&&void 0!==t?t:ee,segmentationConfig:i,postProcessingConfig:qr,bodyPix:l,tflite:d,id:r,onCanvasRef:a}):null})};var Zr=r(5342),ea=r.n(Zr);const ta=({allowedFileTypes:e,maxFileSize:t,files:r})=>{const a=s.useRef(null),[o,i]=(0,s.useState)(!1),[n,d]=(0,s.useState)(),{t:c}=(0,m.$G)(),u=br.getState().session;(0,s.useEffect)((()=>{r&&r.length&&p(r)}),[r]);const p=r=>{var o;let s="";const n=new(ea())({target:window.PLUG_N_MEET_SERVER_URL+"/api/fileUpload",uploadMethod:"POST",query:{sid:u.currentRoom.sid,roomId:u.currentRoom.room_id,userId:null===(o=u.currentUser)||void 0===o?void 0:o.userId,resumable:!0},headers:{Authorization:u.token},fileType:e,fileTypeErrorCallback(e){(0,l.Am)(c("notifications.file-type-not-allow",{filetype:e.type}),{type:l.Am.TYPE.ERROR})},maxFileSize:t?1e6*t:void 0,maxFileSizeErrorCallback(){(0,l.Am)(c("notifications.max-file-size-exceeds"),{type:l.Am.TYPE.ERROR})}});n.on("fileAdded",(function(e){s=e.fileName,n.isUploading()||(i(!0),n.upload())})),n.on("fileSuccess",(function(e,t){const r=JSON.parse(t);i(!1),setTimeout((()=>{var e;l.Am.dismiss(null!==(e=a.current)&&void 0!==e?e:"")}),300),r.status&&d({filePath:r.filePath,fileName:r.fileName,fileExtension:r.fileExtension})})),n.on("fileError",(function(e,t){i(!1),setTimeout((()=>{var e;l.Am.dismiss(null!==(e=a.current)&&void 0!==e?e:"")}),300);try{const e=JSON.parse(t);(0,l.Am)(c(e.msg),{type:l.Am.TYPE.ERROR})}catch(r){(0,l.Am)(c("right-panel.file-upload-default-error"),{type:l.Am.TYPE.ERROR})}})),n.on("uploadStart",(function(){a.current=(0,l.Am)(c("right-panel.uploading-file",{fileName:s}),{closeButton:!1,progress:0})})),n.on("fileProgress",(function(e){var t;const r=e.progress(!1);l.Am.update(null!==(t=a.current)&&void 0!==t?t:"",{progress:Number(r)})})),n.addFiles(r)};return{isUploading:o,result:n}},ra=({onSelect:e})=>{const t=["jpg","jpeg","png"],{t:r}=(0,m.$G)(),[a,i]=(0,s.useState)(ee),[n,l]=(0,s.useState)(re),[d,c]=(0,s.useState)(),u=(0,s.useRef)(null),{isUploading:p,result:h}=ta({allowedFileTypes:t,maxFileSize:30,files:d});(0,s.useEffect)((()=>{if(h&&h.filePath){const e=window.PLUG_N_MEET_SERVER_URL+"/download/uploadedFile/"+h.filePath,t=[...n];t.push(e),l([...t]);const r=u.current;r&&(r.value="")}}),[h,u]);const x=(t,r)=>{const a={type:t,url:r};i(a),e(a)};return(0,o.jsxs)("div",{className:"flex flex-wrap items-center justify-start p-3 bg-slate-100 dark:bg-transparent shadow-header",children:[(0,o.jsx)("div",{className:"cursor-pointer rounded-md w-[62px] h-[62px] overflow-hidden flex items-center justify-center border-2 border-solid border-gray-300 dark:border-primaryColor transition transform scale-90 hover:scale-95 ease-in  "+("none"===a.type?"border-[#24aef7] dark:border-[#24aef7] scale-95":""),onClick:()=>x("none",""),children:(0,o.jsx)("i",{className:"pnm-ban-solid dark:text-darkSecondary2"})}),(0,o.jsx)("div",{className:"cursor-pointer rounded-md w-[62px] h-[62px] overflow-hidden flex items-center justify-center border-2 border-solid border-gray-300 dark:border-primaryColor transition transform scale-90 hover:scale-95 ease-in "+("blur"===a.type?"border-[#24aef7] dark:border-[#24aef7] scale-95":""),onClick:()=>x("blur",""),children:(0,o.jsx)("i",{className:"pnm-blur dark:text-darkSecondary2"})}),n.map(((e,t)=>(0,o.jsx)("div",{className:"cursor-pointer rounded-md w-[62px] h-[62px] overflow-hidden flex items-center justify-center transition transform scale-90 hover:scale-95 ease-in border-2 border-solid border-transparent "+(a.url===e?"border-[#24aef7] scale-95":""),onClick:()=>x("image",e),children:(0,o.jsx)("img",{src:e,alt:`bg-${t+1}`,className:"object-cover w-full h-full"})},e))),(0,o.jsxs)("div",{className:"upload-btn-wrap relative overflow-hidden inline-block cursor-pointer pt-2 w-full",children:[(0,o.jsx)("button",{className:"btn border border-dotted border-[#24aef7] bg-transparent py-2 px-4 rounded text-xs text-secondaryColor cursor-pointer",children:r("footer.modal.upload-background-image")}),(0,o.jsx)("input",{className:"absolute left-0 top-0 opacity-0 w-full h-full cursor-pointer",ref:u,type:"file",onChange:e=>{if(p)return;const t=e.target.files;t&&c([...t])},accept:t.map((e=>"."+e)).join(",")})]})]})},aa=({deviceId:e})=>{var t;const[r,a]=(0,s.useState)(),[i,n]=(0,s.useState)(!1),[l,d]=(0,s.useState)(),[c,u]=(0,s.useState)(),[m,p]=(0,s.useState)(),h=null===(t=br.getState().session.currentUser)||void 0===t?void 0:t.userId,x=yr(),f=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);(0,s.useEffect)((()=>{l!==e&&(n(!1),d(e))}),[e]),(0,s.useEffect)((()=>{n(!1);r&&setTimeout((()=>{n(!0)}),500)}),[r]),(0,s.useEffect)((()=>()=>{m&&m.getTracks().forEach((e=>{e.stop()}))}),[m]);return(0,o.jsxs)("div",{className:"mt-5",children:[e?(0,o.jsx)("div",{style:c?{height:"0.5px",width:"0.5px"}:{width:"auto"},children:(0,o.jsx)(Pr,{deviceId:e,onSourcePlayback:a,onMediaStream:p})}):null,i&&r&&h&&c?(0,o.jsx)(Kr,{sourcePlayback:r,backgroundConfig:c,id:h}):null,f?null:(0,o.jsx)(ra,{onSelect:t=>{x(Ne(t)),"none"===t.type?(n(!1),u(void 0)):(!i&&e&&n(!0),u(t))}})]})},oa=(0,wr.P1)((e=>e.bottomIconsActivity.showVideoShareModal),(e=>e)),sa=({onSelectedDevice:e})=>{const t=kr(oa),[r,a]=(0,s.useState)(!0),[i,n]=(0,s.useState)(""),[l,d]=(0,s.useState)([]),c=yr(),{t:u}=(0,m.$G)();(0,s.useEffect)((()=>{(async()=>{const e=await Nr("videoinput"),t=[],r=e.map((e=>{const r={id:e.deviceId,label:e.label};return t.push(r),(0,o.jsx)("option",{value:e.deviceId,children:e.label},e.deviceId)}));d(r),n(e[0].deviceId),t.length&&c(Je(t))})()}),[c]),(0,s.useEffect)((()=>{t&&a(!0)}),[t]);const p=()=>{a(!1),c(fe(!1)),c(ne(!1))};return(0,o.jsx)(o.Fragment,{children:t?(0,o.jsx)(Sr.u,{show:r,enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:(0,o.jsx)(_r.V,{open:r,onClose:()=>!1,className:"share-webcam-popup-wrap fixed z-[99999] inset-0 overflow-y-auto",children:(0,o.jsxs)("div",{className:"flex items-center justify-center min-h-screen",children:[(0,o.jsx)(_r.V.Overlay,{className:"fixed inset-0 bg-black opacity-30"}),(0,o.jsxs)("div",{className:"popup-inner bg-white dark:bg-darkPrimary w-full max-w-md rounded-3xl shadow-header relative px-6 py-14",children:[(0,o.jsxs)("button",{className:"close-btn absolute top-8 right-6 w-[25px] h-[25px] outline-none",type:"button",onClick:()=>p(),children:[(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 rotate-45"}),(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 -rotate-45"})]}),(0,o.jsx)(_r.V.Title,{className:"mb-6 dark:text-darkText",children:u("footer.modal.select-webcam")}),(0,o.jsx)("div",{className:"col-span-6 sm:col-span-3",children:(0,o.jsx)("select",{value:i,onChange:e=>n(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-transparent dark:border-darkText dark:text-darkText rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:l})}),(0,o.jsx)("div",{className:"col-span-6 sm:col-span-3",children:(0,o.jsx)(aa,{deviceId:i})}),(0,o.jsx)("div",{className:"py-3 bg-gray-50 dark:bg-transparent text-right",children:(0,o.jsx)("button",{className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primaryColor hover:bg-secondaryColor focus:outline-none",onClick:()=>(async()=>{p(),i&&e(i)})(),children:u("share")})})]})]})})}):null})};var ia=r(3788);const na=(0,wr.P1)((e=>e.roomSettings.videoDevices),(e=>e)),la=(0,wr.P1)((e=>e.roomSettings.selectedVideoDevice),(e=>e)),da=({currentRoom:e})=>{const t=yr(),{t:r}=(0,m.$G)(),a=kr(na),i=kr(la),[n,l]=(0,s.useState)(),[d,c]=(0,s.useState)();(0,s.useEffect)((()=>{const e=a.map((e=>(0,o.jsx)("div",{className:"",role:"none",children:(0,o.jsx)(ia.v.Item,{children:()=>(0,o.jsx)("p",{className:(i===e.id?"secondaryColor":"text-gray-700 dark:text-darkText")+" rounded group flex items-center px-3 py-[0.4rem] text-[10px] lg:text-xs transition ease-in hover:bg-primaryColor hover:text-white cursor-pointer",onClick:()=>c(e.id),children:e.label})})},e.id)));l(e)}),[i,a]),(0,s.useEffect)((()=>{d&&t(He(d))}),[d,t]);return(0,o.jsxs)(ia.v.Items,{static:!0,className:"origin-bottom-right z-[9999] absolute left-0 mt-2 w-40 bottom-[40px] rounded-md shadow-lg bg-white dark:bg-darkPrimary ring-1 ring-black dark:ring-secondaryColor ring-opacity-5 divide-y divide-gray-100 dark:divide-secondaryColor focus:outline-none",children:[n,(0,o.jsx)("div",{className:"",role:"none",children:(0,o.jsx)(ia.v.Item,{children:()=>(0,o.jsx)("p",{className:"text-red-900 group flex rounded-md items-center text-left w-full px-2 py-[0.4rem] text-xs transition ease-in hover:bg-red-400 hover:text-white cursor-pointer",onClick:()=>(e.localParticipant.videoTracks.forEach((async t=>{t.track&&t.track.source===Be.fQ.Source.Camera&&e.localParticipant.unpublishTrack(t.track,!0)})),t(ne(!1)),t(He("")),void t(Ne({type:"none"}))),children:r("footer.menus.leave-webcam")})})})]})},ca=({currentRoom:e})=>(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("div",{className:"absolute -bottom-[3px] md:bottom-0 right-3 lg:right-6",children:(0,o.jsx)(ia.v,{children:({open:t})=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ia.v.Button,{children:(0,o.jsx)("div",{className:"arrow-down absolute -bottom-1 -right-1 w-[15px] h-[15px] rounded-full bg-white dark:bg-secondaryColor flex items-center justify-center",children:(0,o.jsx)("i",{className:"pnm-arrow-below text-[10px] sm:text-[12px] dark:text-darkSecondary"})})}),(0,o.jsx)(Sr.u,{show:t,enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:(0,o.jsx)(da,{currentRoom:e})})]})})})}),ua=(0,wr.P1)((e=>e.bottomIconsActivity.isActiveWebcam),(e=>e)),ma=(0,wr.P1)((e=>e.bottomIconsActivity.showVideoShareModal),(e=>e)),pa=(0,wr.P1)((e=>{var t,r;return null===(r=null===(t=e.session.currentUser)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.lock_settings.lock_webcam}),(e=>e)),ha=(0,wr.P1)((e=>e.bottomIconsActivity.virtualBackground),(e=>e)),xa=(0,wr.P1)((e=>e.roomSettings.selectedVideoDevice),(e=>e)),fa=({currentRoom:e})=>{const t=yr(),r="desktop"===br.getState().session.userDeviceType,a=kr(ma),i=kr(ua),n=kr(pa),l=kr(ha),d=kr(xa),{t:c}=(0,m.$G)(),[u,p]=(0,s.useState)(!1),[h,x]=(0,s.useState)(),[f,g]=(0,s.useState)(),[v,b]=(0,s.useState)(),y=(0,s.useRef)(null);(0,s.useEffect)((()=>{if(n){p(!0);const r=E.selectById(br.getState(),e.localParticipant.identity);(null===r||void 0===r?void 0:r.videoTracks)&&(null===e||void 0===e||e.localParticipant.videoTracks.forEach((t=>{t.track&&t.source===Be.fQ.Source.Camera&&e.localParticipant.unpublishTrack(t.track,!0)})),t(ne(!1)))}else p(!1)}),[n,e,t]),(0,s.useEffect)((()=>{var e,t,r,a;const o=null===(t=null===(e=br.getState().session.currentRoom.metadata)||void 0===e?void 0:e.default_lock_settings)||void 0===t?void 0:t.lock_webcam,s=null===(a=null===(r=br.getState().session.currentUser)||void 0===r?void 0:r.metadata)||void 0===a?void 0:a.is_admin;o&&!s&&!1!==n&&p(!0)}),[]),(0,s.useEffect)((()=>{i||!v||d||v.getTracks().forEach((e=>e.stop())),i||d||!h||x(void 0)}),[d]),(0,s.useEffect)((()=>{if(!d||!h)return;if(d===h)return;"none"===l.type?(async t=>{await e.switchActiveDevice("videoinput",t)})(d):(async e=>{await w(e)})(d),x(d)}),[d]),(0,s.useEffect)((()=>{if(v&&y){const e=y.current;e&&(e.srcObject=v)}return()=>{v&&v.getTracks().forEach((e=>e.stop()))}}),[v]);const k=()=>{var e,t;const r=y.current;r&&g({htmlElement:r,width:null!==(e=r.videoWidth)&&void 0!==e?e:320,height:null!==(t=r.videoHeight)&&void 0!==t?t:180})},w=async r=>{if("none"===l.type){const a=(()=>{var e;const t=null!==(e=window.DEFAULT_WEBCAM_RESOLUTION)&&void 0!==e?e:"h720";let r=Be.OM.h720.resolution;switch(t){case"h90":r=Be.OM.h90.resolution;break;case"h180":r=Be.OM.h180.resolution;break;case"h216":r=Be.OM.h216.resolution;break;case"h360":r=Be.OM.h360.resolution;break;case"h540":r=Be.OM.h540.resolution;break;case"h720":r=Be.OM.h720.resolution;break;case"h1080":r=Be.OM.h1080.resolution;break;case"h1440":r=Be.OM.h1440.resolution;break;case"h2160":r=Be.OM.h2160.resolution}return r})(),o=await(0,Be.gJ)({deviceId:{exact:r,ideal:r},resolution:a});await e.localParticipant.publishTrack(o),t(ne(!0))}else{const e={video:{deviceId:{exact:r,ideal:r}}},t=await navigator.mediaDevices.getUserMedia(e);b(t)}},T=async e=>{x(e),await w(e),t(He(e))},j=r=>{r.current.captureStream(25).getTracks().forEach((async r=>{r.kind===Be.fQ.Kind.Video&&(await e.localParticipant.publishTrack(r,{source:Be.fQ.Source.Camera,name:"canvas"}),t(ne(!0)))}))},S=()=>(0,o.jsxs)("div",{className:"relative z-10",children:[(0,o.jsxs)("div",{className:"camera footer-icon relative h-[35px] lg:h-[40px] w-[35px] lg:w-[40px] rounded-full bg-[#F2F2F2] dark:bg-darkSecondary2 hover:bg-[#ECF4FF] mr-3 lg:mr-6 flex items-center justify-center cursor-pointer "+(r?"has-tooltip":""),onClick:()=>{u||(i?i&&(e.localParticipant.videoTracks.forEach((async t=>{t.track&&t.track.source===Be.fQ.Source.Camera&&e.localParticipant.unpublishTrack(t.track,!0)})),t(ne(!1)),t(He("")),t(Ne({type:"none"}))):t(fe(!i)))},children:[(0,o.jsx)("span",{className:"tooltip !-left-3 tooltip-left",children:i||n?!i&&n?c("footer.icons.webcam-locked"):i?c("footer.icons.leave-webcam"):void 0:c("footer.icons.start-webcam")}),i?null:(0,o.jsx)("i",{className:"pnm-webcam primaryColor dark:text-darkText text-[12px] lg:text-[14px]"}),u?(0,o.jsx)("div",{className:"arrow-down absolute -bottom-1 -right-1 w-[16px] h-[16px] rounded-full bg-white dark:bg-darkSecondary3 flex items-center justify-center",children:(0,o.jsx)("i",{className:"pnm-lock primaryColor"})}):null,i?(0,o.jsx)("i",{className:"pnm-webcam secondaryColor text-[12px] lg:text-[14px]"}):null]}),i?(0,o.jsx)(ca,{currentRoom:e}):null]});return(0,o.jsx)(o.Fragment,{children:(()=>{var e,t;const r=br.getState().session,a=null===(e=r.currentRoom.metadata)||void 0===e?void 0:e.room_features,o=r.currentUser;return!!(null===a||void 0===a?void 0:a.allow_webcams)&&!((null===a||void 0===a?void 0:a.admin_only_webcams)&&!(null===(t=null===o||void 0===o?void 0:o.metadata)||void 0===t?void 0:t.is_admin))})()?(0,o.jsxs)(o.Fragment,{children:[S(),a?(0,o.jsx)(sa,{onSelectedDevice:T}):null,f&&h&&"none"!==l.type?(0,o.jsx)("div",{style:{display:"none"},children:(0,o.jsx)(Kr,{sourcePlayback:f,id:h,backgroundConfig:l,onCanvasRef:j})}):null,v?(0,o.jsx)("div",{style:{display:"none"},children:(0,o.jsx)("video",{ref:y,autoPlay:!0,onLoadedData:k})}):null]}):null})},ga=(0,wr.P1)((e=>e.bottomIconsActivity.showMicrophoneModal),(e=>e)),va=({currentRoom:e})=>{var t,r;const a=kr(ga),[i,n]=(0,s.useState)(!0),[l,d]=(0,s.useState)(""),[c,u]=(0,s.useState)([]),p=yr(),{t:h}=(0,m.$G)(),x=null!==(r=null===(t=br.getState().session.currentRoom.metadata)||void 0===t?void 0:t.room_features.mute_on_start)&&void 0!==r&&r;(0,s.useEffect)((()=>{(async()=>{const e=await Nr("audioinput"),t=[],r=e.map((e=>{const r={id:e.deviceId,label:e.label};return t.push(r),(0,o.jsx)("option",{value:e.deviceId,children:e.label},e.deviceId)}));u(r),d(e[0].deviceId),t.length&&p(Ge(t))})()}),[p]),(0,s.useEffect)((()=>{a&&n(!0)}),[a]);return(0,o.jsx)(o.Fragment,{children:a?(0,o.jsx)(Sr.u,{show:i,enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:(0,o.jsx)(_r.V,{open:i,onClose:()=>!1,className:"share-microphone-popup-wrap fixed z-[99999] inset-0 overflow-y-auto",children:(0,o.jsxs)("div",{className:"flex items-center justify-center min-h-screen",children:[(0,o.jsx)(_r.V.Overlay,{className:"fixed inset-0 bg-black opacity-30"}),(0,o.jsxs)("div",{className:"popup-inner bg-white dark:bg-darkPrimary w-full max-w-sm rounded-3xl shadow-header relative px-6 py-14",children:[(0,o.jsxs)("button",{className:"close-btn absolute top-8 right-6 w-[25px] h-[25px] outline-none",type:"button",onClick:()=>(n(!1),void p(xe(!1))),children:[(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 rotate-45"}),(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 -rotate-45"})]}),(0,o.jsx)(_r.V.Title,{className:"mb-6 dark:text-darkText",children:h("footer.modal.select-microphone")}),(0,o.jsx)("div",{className:"col-span-6 sm:col-span-3",children:(0,o.jsx)("select",{value:l,onChange:e=>d(e.target.value),className:"mt-1 block w-full py-2 px-3 border border-gray-300 bg-transparent dark:border-darkText dark:text-darkText rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:c})}),(0,o.jsx)("div",{className:"py-3 text-right",children:(0,o.jsx)("button",{className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primaryColor hover:bg-secondaryColor focus:outline-none",onClick:()=>(async()=>{n(!1),p(xe(!1)),l&&((await(0,Be.Ai)({audio:{deviceId:l},video:!1})).forEach((async t=>{t.kind===Be.fQ.Kind.Audio&&(await(null===e||void 0===e?void 0:e.localParticipant.publishTrack(t)),p(se(!0)))})),x&&setTimeout((async()=>{null===e||void 0===e||e.localParticipant.audioTracks.forEach((async e=>{e.track&&e.track.source===Be.fQ.Source.Microphone&&(e.isMuted||(await e.track.mute(),p(ie(!0)),p(Y(!1))))}))}),500),p(Ve(l)))})(),children:h("join")})})]})]})})}):null})},ba=(0,wr.P1)((e=>e.roomSettings.audioDevices),(e=>e)),ya=(0,wr.P1)((e=>e.bottomIconsActivity.isMicMuted),(e=>e)),ka=(0,wr.P1)((e=>e.roomSettings.selectedAudioDevice),(e=>e)),wa=({currentRoom:e})=>{const t=yr(),{t:r}=(0,m.$G)(),a=kr(ba),i=kr(ya),n=kr(ka),[l,d]=(0,s.useState)(),[c,u]=(0,s.useState)();(0,s.useEffect)((()=>{const e=a.map((e=>(0,o.jsx)("div",{className:"",role:"none",children:(0,o.jsx)(ia.v.Item,{children:()=>(0,o.jsx)("p",{className:(n===e.id?"secondaryColor":"text-gray-700 dark:text-darkText")+" rounded group flex items-center px-3 py-[0.4rem] text-[10px] lg:text-xs transition ease-in hover:bg-primaryColor hover:text-white cursor-pointer",onClick:()=>u(e.id),children:e.label})})},e.id)));d(e)}),[a,n]),(0,s.useEffect)((()=>{c&&((async t=>{await e.switchActiveDevice("audioinput",t)})(c),t(Ve(c)))}),[c,e,t]);return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(ia.v.Items,{static:!0,className:"origin-bottom-right z-[9999] absolute left-0 mt-2 w-40 bottom-[40px] rounded-md shadow-lg bg-white dark:bg-darkPrimary ring-1 ring-black dark:ring-secondaryColor ring-opacity-5 divide-y divide-gray-100 dark:divide-secondaryColor focus:outline-none",children:[l,(0,o.jsx)("div",{className:"",role:"none",children:(0,o.jsx)(ia.v.Item,{children:()=>(0,o.jsx)("p",{className:"text-gray-700 dark:text-darkText rounded group flex items-center px-3 py-[0.4rem] text-xs transition ease-in hover:bg-primaryColor hover:text-white cursor-pointer",onClick:()=>{null===e||void 0===e||e.localParticipant.audioTracks.forEach((async e=>{e.track&&e.track.source===Be.fQ.Source.Microphone&&(e.isMuted?(await e.track.unmute(),t(ie(!1))):(await e.track.mute(),t(ie(!0))))}))},children:r(i?"footer.menus.unmute-microphone":"footer.menus.mute-microphone")})})}),(0,o.jsx)("div",{className:"",role:"none",children:(0,o.jsx)(ia.v.Item,{children:()=>(0,o.jsx)("p",{className:"text-red-900 group flex rounded-md items-center text-left w-full px-2 py-[0.4rem] text-xs transition ease-in hover:bg-red-400 hover:text-white cursor-pointer",onClick:()=>(null===e||void 0===e||e.localParticipant.audioTracks.forEach((async t=>{t.track&&t.kind===Be.fQ.Kind.Audio&&e.localParticipant.unpublishTrack(t.track,!0)})),t(se(!1)),t(ie(!1)),void t(Ve(""))),children:r("footer.menus.leave-microphone")})})})]})})},Ta=({currentRoom:e})=>(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("div",{className:"absolute bottom-0 right-3 lg:right-6",children:(0,o.jsx)(ia.v,{children:({open:t})=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ia.v.Button,{children:(0,o.jsx)("div",{className:"arrow-down absolute -bottom-1 -right-1 w-[15px] h-[15px] rounded-full bg-white dark:bg-secondaryColor flex items-center justify-center",children:(0,o.jsx)("i",{className:"pnm-arrow-below text-[10px] dark:text-darkPrimary sm:text-[12px]"})})}),(0,o.jsx)(Sr.u,{show:t,enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:(0,o.jsx)(wa,{currentRoom:e})})]})})})}),ja=(0,wr.P1)((e=>e.bottomIconsActivity.isActiveMicrophone),(e=>e)),Sa=(0,wr.P1)((e=>e.bottomIconsActivity.showMicrophoneModal),(e=>e)),_a=(0,wr.P1)((e=>{var t,r;return null===(r=null===(t=e.session.currentUser)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.lock_settings.lock_microphone}),(e=>e)),Na=(0,wr.P1)((e=>e.bottomIconsActivity.isMicMuted),(e=>e)),Ca=({currentRoom:e})=>{const t=yr(),r="desktop"===br.getState().session.userDeviceType,{t:a}=(0,m.$G)(),i=kr(Sa),n=kr(ja),l=kr(_a),d=kr(Na),[c,u]=(0,s.useState)(!1);(0,s.useEffect)((()=>{if(l){u(!0);const r=E.selectById(br.getState(),e.localParticipant.identity);(null===r||void 0===r?void 0:r.audioTracks)&&(null===e||void 0===e||e.localParticipant.audioTracks.forEach((t=>{t.track&&t.source===Be.fQ.Source.Microphone&&e.localParticipant.unpublishTrack(t.track,!0)})),t(se(!1)),t(ie(!1)))}else u(!1)}),[l,e,t]),(0,s.useEffect)((()=>{var e,t,r,a;const o=null===(t=null===(e=br.getState().session.currentRoom.metadata)||void 0===e?void 0:e.default_lock_settings)||void 0===t?void 0:t.lock_microphone,s=null===(a=null===(r=br.getState().session.currentUser)||void 0===r?void 0:r.metadata)||void 0===a?void 0:a.is_admin;o&&!s&&!1!==l&&u(!0)}),[]);const p=()=>{n||c||t(xe(!0)),n&&(null===e||void 0===e||e.localParticipant.audioTracks.forEach((async e=>{e.track&&e.track.source===Be.fQ.Source.Microphone&&(e.isMuted?(await e.track.unmute(),t(ie(!1))):(await e.track.mute(),t(ie(!0))))})))};return(0,o.jsxs)("div",{className:"relative z-10",children:[i?(0,o.jsx)(va,{currentRoom:e}):null,(0,o.jsxs)("div",{className:"microphone footer-icon relative h-[35px] lg:h-[40px] w-[35px] lg:w-[40px] rounded-full bg-[#F2F2F2] dark:bg-darkSecondary2 hover:bg-[#ECF4FF] mr-3 lg:mr-6 flex items-center justify-center cursor-pointer "+(r?"has-tooltip":""),onClick:()=>p(),children:[(0,o.jsx)("span",{className:"tooltip",children:n||c?!n&&c?a("footer.icons.microphone-locked"):n&&!d?a("footer.menus.mute-microphone"):n&&d?a("footer.menus.unmute-microphone"):void 0:a("footer.icons.start-microphone-sharing")}),n?null:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("i",{className:"pnm-mic-unmute primaryColor dark:text-darkText text-[12px] lg:text-[14px]"}),c?(0,o.jsx)("div",{className:"arrow-down absolute -bottom-1 -right-1 w-[16px] h-[16px] rounded-full bg-white dark:bg-darkSecondary3 flex items-center justify-center",children:(0,o.jsx)("i",{className:"pnm-lock primaryColor dark:text-darkText"})}):null]}),!d&&n?(0,o.jsx)("i",{className:"pnm-mic-unmute secondaryColor  text-[12px] lg:text-[14px]"}):null,d&&n?(0,o.jsx)("i",{className:"pnm-mic-mute secondaryColor text-[12px] lg:text-[14px]"}):null]}),n?(0,o.jsx)(Ta,{currentRoom:e}):null]})},Ea=(0,wr.P1)((e=>e.bottomIconsActivity.isActiveChatPanel),(e=>e)),Ra=(0,wr.P1)((e=>e.bottomIconsActivity.totalUnreadChatMsgs),(e=>e)),Ia=()=>{const e=yr(),t="desktop"===br.getState().session.userDeviceType,{t:r}=(0,m.$G)(),a=kr(Ea),i=kr(Ra),[n,l]=(0,s.useState)("primaryColor"),[d,c]=(0,s.useState)(!0);(0,s.useEffect)((()=>{l(a?"secondaryColor":"primaryColor dark:text-darkText")}),[a]),(0,s.useEffect)((()=>{var t;(null===(t=br.getState().session.currentRoom.metadata.room_features)||void 0===t?void 0:t.chat_features.allow_chat)||(c(!1),e(le(!1)))}),[e]);return(0,o.jsx)(o.Fragment,{children:d?(0,o.jsxs)("div",{className:"message footer-icon h-[35px] lg:h-[40px] w-[35px] lg:w-[40px] relative rounded-full bg-[#F2F2F2] dark:bg-darkSecondary2 hover:bg-[#ECF4FF] mr-3 lg:mr-6 flex items-center justify-center cursor-pointer "+(t?"has-tooltip":""),onClick:()=>{e(le(!a))},children:[(0,o.jsx)("span",{className:"tooltip",children:r(a?"footer.icons.hide-chat-panel":"footer.icons.show-chat-panel")}),(0,o.jsx)("i",{className:`pnm-chat ${n} text-[14px] lg:text-[16px]`}),!a&&i>0?(0,o.jsx)("div",{className:"unseen-message-count bg-brandRed w-5 h-5 rounded-full text-xs text-white absolute -top-2 -right-1 flex justify-center items-center",children:i}):null]}):null})},Aa=(0,wr.P1)((e=>e.bottomIconsActivity.isActiveParticipantsPanel),(e=>e)),Pa=(0,wr.P1)((e=>e.participants),(e=>e)),Fa=()=>{const e=yr(),t="desktop"===br.getState().session.userDeviceType,{t:r}=(0,m.$G)(),a=kr(Aa),i=kr(Pa),[n,l]=(0,s.useState)("primaryColor");(0,s.useEffect)((()=>{l(a?"secondaryColor":"primaryColor dark:text-darkText")}),[a]);return(0,o.jsxs)("div",{className:"participants footer-icon h-[35px] lg:h-[40px] w-[35px] lg:w-[40px] mr-3 lg:mr-6 relative rounded-full bg-[#F2F2F2] dark:bg-darkSecondary2 hover:bg-[#ECF4FF] flex items-center justify-center cursor-pointer "+(t?"has-tooltip":""),onClick:()=>{e(de(!a))},children:[(0,o.jsx)("span",{className:"tooltip",children:r(a?"footer.icons.hide-users-list":"footer.icons.show-users-list")}),(0,o.jsx)("i",{className:`pnm-participant ${n} text-[14px] lg:text-[16px]`}),a?null:(0,o.jsx)("div",{className:"unseen-message-count bg-secondaryColor w-5 h-5 rounded-full text-xs text-white absolute -top-2 -right-1 flex justify-center items-center",children:i.ids.length})]})};var Ma,Oa,Da,La,Ba,Ua=r(2861);!function(e){e[e.USER=0]="USER",e[e.SYSTEM=1]="SYSTEM",e[e.WHITEBOARD=2]="WHITEBOARD"}(Ma||(Ma={})),It.w.util.setEnumType(Ma,"plugnmeet.DataMsgType",[{no:0,name:"USER"},{no:1,name:"SYSTEM"},{no:2,name:"WHITEBOARD"}]),function(e){e[e.RAISE_HAND=0]="RAISE_HAND",e[e.LOWER_HAND=1]="LOWER_HAND",e[e.OTHER_USER_LOWER_HAND=2]="OTHER_USER_LOWER_HAND",e[e.FILE_UPLOAD=3]="FILE_UPLOAD",e[e.INFO=4]="INFO",e[e.ALERT=5]="ALERT",e[e.SEND_CHAT_MSGS=6]="SEND_CHAT_MSGS",e[e.RENEW_TOKEN=7]="RENEW_TOKEN",e[e.UPDATE_LOCK_SETTINGS=8]="UPDATE_LOCK_SETTINGS",e[e.INIT_WHITEBOARD=9]="INIT_WHITEBOARD",e[e.USER_VISIBILITY_CHANGE=10]="USER_VISIBILITY_CHANGE",e[e.EXTERNAL_MEDIA_PLAYER_EVENTS=11]="EXTERNAL_MEDIA_PLAYER_EVENTS",e[e.POLL_CREATED=12]="POLL_CREATED",e[e.NEW_POLL_RESPONSE=13]="NEW_POLL_RESPONSE",e[e.POLL_CLOSED=14]="POLL_CLOSED",e[e.JOIN_BREAKOUT_ROOM=15]="JOIN_BREAKOUT_ROOM",e[e.CHAT=16]="CHAT",e[e.SCENE_UPDATE=17]="SCENE_UPDATE",e[e.POINTER_UPDATE=18]="POINTER_UPDATE",e[e.ADD_WHITEBOARD_FILE=19]="ADD_WHITEBOARD_FILE",e[e.ADD_WHITEBOARD_OFFICE_FILE=20]="ADD_WHITEBOARD_OFFICE_FILE",e[e.PAGE_CHANGE=21]="PAGE_CHANGE",e[e.WHITEBOARD_APP_STATE_CHANGE=22]="WHITEBOARD_APP_STATE_CHANGE"}(Oa||(Oa={})),It.w.util.setEnumType(Oa,"plugnmeet.DataMsgBodyType",[{no:0,name:"RAISE_HAND"},{no:1,name:"LOWER_HAND"},{no:2,name:"OTHER_USER_LOWER_HAND"},{no:3,name:"FILE_UPLOAD"},{no:4,name:"INFO"},{no:5,name:"ALERT"},{no:6,name:"SEND_CHAT_MSGS"},{no:7,name:"RENEW_TOKEN"},{no:8,name:"UPDATE_LOCK_SETTINGS"},{no:9,name:"INIT_WHITEBOARD"},{no:10,name:"USER_VISIBILITY_CHANGE"},{no:11,name:"EXTERNAL_MEDIA_PLAYER_EVENTS"},{no:12,name:"POLL_CREATED"},{no:13,name:"NEW_POLL_RESPONSE"},{no:14,name:"POLL_CLOSED"},{no:15,name:"JOIN_BREAKOUT_ROOM"},{no:16,name:"CHAT"},{no:17,name:"SCENE_UPDATE"},{no:18,name:"POINTER_UPDATE"},{no:19,name:"ADD_WHITEBOARD_FILE"},{no:20,name:"ADD_WHITEBOARD_OFFICE_FILE"},{no:21,name:"PAGE_CHANGE"},{no:22,name:"WHITEBOARD_APP_STATE_CHANGE"}]);class Wa extends Rt.v{constructor(e){super(),this.type=Ma.USER,this.roomSid="",this.roomId="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Wa).fromBinary(e,t)}static fromJson(e,t){return(new Wa).fromJson(e,t)}static fromJsonString(e,t){return(new Wa).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Wa,e,t)}}Wa.runtime=It.w,Wa.typeName="plugnmeet.DataMessage",Wa.fields=It.w.util.newFieldList((()=>[{no:1,name:"type",kind:"enum",T:It.w.getEnumType(Ma)},{no:2,name:"message_id",kind:"scalar",T:9,opt:!0},{no:3,name:"room_sid",kind:"scalar",T:9},{no:4,name:"room_id",kind:"scalar",T:9},{no:5,name:"to",kind:"scalar",T:9,opt:!0},{no:6,name:"body",kind:"message",T:Ga}]));class Ga extends Rt.v{constructor(e){super(),this.type=Oa.RAISE_HAND,this.msg="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Ga).fromBinary(e,t)}static fromJson(e,t){return(new Ga).fromJson(e,t)}static fromJsonString(e,t){return(new Ga).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Ga,e,t)}}Ga.runtime=It.w,Ga.typeName="plugnmeet.DataMsgBody",Ga.fields=It.w.util.newFieldList((()=>[{no:1,name:"type",kind:"enum",T:It.w.getEnumType(Oa)},{no:2,name:"message_id",kind:"scalar",T:9,opt:!0},{no:3,name:"time",kind:"scalar",T:9,opt:!0},{no:4,name:"from",kind:"message",T:Ja},{no:5,name:"msg",kind:"scalar",T:9},{no:6,name:"is_private",kind:"scalar",T:13,opt:!0}]));class Ja extends Rt.v{constructor(e){super(),this.sid="",this.userId="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Ja).fromBinary(e,t)}static fromJson(e,t){return(new Ja).fromJson(e,t)}static fromJsonString(e,t){return(new Ja).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Ja,e,t)}}Ja.runtime=It.w,Ja.typeName="plugnmeet.DataMsgReqFrom",Ja.fields=It.w.util.newFieldList((()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"user_id",kind:"scalar",T:9},{no:3,name:"name",kind:"scalar",T:9,opt:!0}])),function(e){e[e.PROMOTE=0]="PROMOTE",e[e.DEMOTE=1]="DEMOTE"}(Da||(Da={})),It.w.util.setEnumType(Da,"plugnmeet.SwitchPresenterTask",[{no:0,name:"PROMOTE"},{no:1,name:"DEMOTE"}]),function(e){e[e.START_PLAYBACK=0]="START_PLAYBACK",e[e.END_PLAYBACK=1]="END_PLAYBACK"}(La||(La={})),It.w.util.setEnumType(La,"plugnmeet.ExternalMediaPlayerTask",[{no:0,name:"START_PLAYBACK"},{no:1,name:"END_PLAYBACK"}]),function(e){e[e.START_EXTERNAL_LINK=0]="START_EXTERNAL_LINK",e[e.STOP_EXTERNAL_LINK=1]="STOP_EXTERNAL_LINK"}(Ba||(Ba={})),It.w.util.setEnumType(Ba,"plugnmeet.ExternalDisplayLinkTask",[{no:0,name:"START_EXTERNAL_LINK"},{no:1,name:"STOP_EXTERNAL_LINK"}]);class Va extends Rt.v{constructor(e){super(),this.status=!1,this.msg="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Va).fromBinary(e,t)}static fromJson(e,t){return(new Va).fromJson(e,t)}static fromJsonString(e,t){return(new Va).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Va,e,t)}}Va.runtime=It.w,Va.typeName="plugnmeet.CommonResponse",Va.fields=It.w.util.newFieldList((()=>[{no:1,name:"status",kind:"scalar",T:8},{no:2,name:"msg",kind:"scalar",T:9}]));class Ha extends Rt.v{constructor(e){super(),It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Ha).fromBinary(e,t)}static fromJson(e,t){return(new Ha).fromJson(e,t)}static fromJsonString(e,t){return(new Ha).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Ha,e,t)}}Ha.runtime=It.w,Ha.typeName="plugnmeet.VerifyTokenReq",Ha.fields=It.w.util.newFieldList((()=>[{no:1,name:"is_production",kind:"scalar",T:8,opt:!0}]));class qa extends Rt.v{constructor(e){super(),this.status=!1,this.msg="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new qa).fromBinary(e,t)}static fromJson(e,t){return(new qa).fromJson(e,t)}static fromJsonString(e,t){return(new qa).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(qa,e,t)}}qa.runtime=It.w,qa.typeName="plugnmeet.VerifyTokenRes",qa.fields=It.w.util.newFieldList((()=>[{no:1,name:"status",kind:"scalar",T:8},{no:2,name:"msg",kind:"scalar",T:9},{no:3,name:"livekit_host",kind:"scalar",T:9,opt:!0},{no:4,name:"token",kind:"scalar",T:9,opt:!0},{no:5,name:"server_version",kind:"scalar",T:9,opt:!0}]));class $a extends Rt.v{constructor(e){super(),this.sid="",this.roomId="",this.userId="",this.trackSid="",this.muted=!1,this.RequestedUserId="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new $a).fromBinary(e,t)}static fromJson(e,t){return(new $a).fromJson(e,t)}static fromJsonString(e,t){return(new $a).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals($a,e,t)}}$a.runtime=It.w,$a.typeName="plugnmeet.MuteUnMuteTrackReq",$a.fields=It.w.util.newFieldList((()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"room_id",kind:"scalar",T:9},{no:3,name:"user_id",kind:"scalar",T:9},{no:4,name:"track_sid",kind:"scalar",T:9},{no:5,name:"muted",kind:"scalar",T:8},{no:6,name:"Requested_user_id",kind:"scalar",T:9}]));class za extends Rt.v{constructor(e){super(),this.sid="",this.roomId="",this.userId="",this.msg="",this.blockUser=!1,It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new za).fromBinary(e,t)}static fromJson(e,t){return(new za).fromJson(e,t)}static fromJsonString(e,t){return(new za).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(za,e,t)}}za.runtime=It.w,za.typeName="plugnmeet.RemoveParticipantReq",za.fields=It.w.util.newFieldList((()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"room_id",kind:"scalar",T:9},{no:3,name:"user_id",kind:"scalar",T:9},{no:4,name:"msg",kind:"scalar",T:9},{no:5,name:"block_user",kind:"scalar",T:8}]));class Qa extends Rt.v{constructor(e){super(),this.roomId="",this.roomSid="",this.userId="",this.userSid="",this.msgBodyType=Oa.RAISE_HAND,this.msg="",this.RequestedUserId="",this.sendTo=[],this.isAdmin=!1,It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Qa).fromBinary(e,t)}static fromJson(e,t){return(new Qa).fromJson(e,t)}static fromJsonString(e,t){return(new Qa).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Qa,e,t)}}Qa.runtime=It.w,Qa.typeName="plugnmeet.DataMessageReq",Qa.fields=It.w.util.newFieldList((()=>[{no:1,name:"room_id",kind:"scalar",T:9},{no:2,name:"room_sid",kind:"scalar",T:9},{no:3,name:"user_id",kind:"scalar",T:9},{no:4,name:"user_sid",kind:"scalar",T:9},{no:5,name:"msg_body_type",kind:"enum",T:It.w.getEnumType(Oa)},{no:6,name:"msg",kind:"scalar",T:9},{no:7,name:"Requested_user_id",kind:"scalar",T:9},{no:8,name:"send_to",kind:"scalar",T:9,repeated:!0},{no:9,name:"is_admin",kind:"scalar",T:8}]));class Ya extends Rt.v{constructor(e){super(),this.roomId="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Ya).fromBinary(e,t)}static fromJson(e,t){return(new Ya).fromJson(e,t)}static fromJsonString(e,t){return(new Ya).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Ya,e,t)}}Ya.runtime=It.w,Ya.typeName="plugnmeet.RoomEndAPIReq",Ya.fields=It.w.util.newFieldList((()=>[{no:1,name:"room_id",kind:"scalar",T:9}]));class Xa extends Rt.v{constructor(e){super(),this.roomId="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Xa).fromBinary(e,t)}static fromJson(e,t){return(new Xa).fromJson(e,t)}static fromJsonString(e,t){return(new Xa).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Xa,e,t)}}Xa.runtime=It.w,Xa.typeName="plugnmeet.ChangeVisibilityRes",Xa.fields=It.w.util.newFieldList((()=>[{no:1,name:"room_id",kind:"scalar",T:9},{no:2,name:"visible_notepad",kind:"scalar",T:8,opt:!0},{no:3,name:"visible_white_board",kind:"scalar",T:8,opt:!0}]));class Ka extends Rt.v{constructor(e){super(),this.task=Da.PROMOTE,this.userId="",this.roomId="",this.RequestedUserId="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Ka).fromBinary(e,t)}static fromJson(e,t){return(new Ka).fromJson(e,t)}static fromJsonString(e,t){return(new Ka).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Ka,e,t)}}Ka.runtime=It.w,Ka.typeName="plugnmeet.SwitchPresenterReq",Ka.fields=It.w.util.newFieldList((()=>[{no:1,name:"task",kind:"enum",T:It.w.getEnumType(Da)},{no:2,name:"user_id",kind:"scalar",T:9},{no:3,name:"room_id",kind:"scalar",T:9},{no:4,name:"Requested_user_id",kind:"scalar",T:9}]));class Za extends Rt.v{constructor(e){super(),this.task=La.START_PLAYBACK,this.roomId="",this.userId="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Za).fromBinary(e,t)}static fromJson(e,t){return(new Za).fromJson(e,t)}static fromJsonString(e,t){return(new Za).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Za,e,t)}}Za.runtime=It.w,Za.typeName="plugnmeet.ExternalMediaPlayerReq",Za.fields=It.w.util.newFieldList((()=>[{no:1,name:"task",kind:"enum",T:It.w.getEnumType(La)},{no:2,name:"url",kind:"scalar",T:9,opt:!0},{no:3,name:"seek_to",kind:"scalar",T:1,opt:!0},{no:4,name:"room_id",kind:"scalar",T:9},{no:5,name:"user_id",kind:"scalar",T:9}]));class eo extends Rt.v{constructor(e){super(),this.task=Ba.START_EXTERNAL_LINK,this.roomId="",this.userId="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new eo).fromBinary(e,t)}static fromJson(e,t){return(new eo).fromJson(e,t)}static fromJsonString(e,t){return(new eo).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(eo,e,t)}}eo.runtime=It.w,eo.typeName="plugnmeet.ExternalDisplayLinkReq",eo.fields=It.w.util.newFieldList((()=>[{no:1,name:"task",kind:"enum",T:It.w.getEnumType(Ba)},{no:2,name:"url",kind:"scalar",T:9,opt:!0},{no:4,name:"room_id",kind:"scalar",T:9},{no:5,name:"user_id",kind:"scalar",T:9}]));class to extends Rt.v{constructor(e){super(),this.status=!1,this.msg="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new to).fromBinary(e,t)}static fromJson(e,t){return(new to).fromJson(e,t)}static fromJsonString(e,t){return(new to).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(to,e,t)}}to.runtime=It.w,to.typeName="plugnmeet.CreateEtherpadSessionRes",to.fields=It.w.util.newFieldList((()=>[{no:1,name:"status",kind:"scalar",T:8},{no:2,name:"msg",kind:"scalar",T:9},{no:3,name:"pad_id",kind:"scalar",T:9,opt:!0},{no:4,name:"readonly_pad_id",kind:"scalar",T:9,opt:!0}]));class ro extends Rt.v{constructor(e){super(),this.roomId="",this.nodeId="",this.padId="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new ro).fromBinary(e,t)}static fromJson(e,t){return(new ro).fromJson(e,t)}static fromJsonString(e,t){return(new ro).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(ro,e,t)}}ro.runtime=It.w,ro.typeName="plugnmeet.CleanEtherpadReq",ro.fields=It.w.util.newFieldList((()=>[{no:1,name:"room_id",kind:"scalar",T:9},{no:2,name:"node_id",kind:"scalar",T:9},{no:3,name:"pad_id",kind:"scalar",T:9}]));class ao extends Rt.v{constructor(e){super(),this.roomId="",this.isActive=!1,It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new ao).fromBinary(e,t)}static fromJson(e,t){return(new ao).fromJson(e,t)}static fromJsonString(e,t){return(new ao).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(ao,e,t)}}ao.runtime=It.w,ao.typeName="plugnmeet.ChangeEtherpadStatusReq",ao.fields=It.w.util.newFieldList((()=>[{no:1,name:"room_id",kind:"scalar",T:9},{no:2,name:"is_active",kind:"scalar",T:8}]));class oo extends Rt.v{constructor(e){super(),this.roomId="",this.userId="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new oo).fromBinary(e,t)}static fromJson(e,t){return(new oo).fromJson(e,t)}static fromJsonString(e,t){return(new oo).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(oo,e,t)}}oo.runtime=It.w,oo.typeName="plugnmeet.ApproveWaitingUsersReq",oo.fields=It.w.util.newFieldList((()=>[{no:1,name:"room_id",kind:"scalar",T:9},{no:2,name:"user_id",kind:"scalar",T:9}]));class so extends Rt.v{constructor(e){super(),this.roomId="",this.msg="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new so).fromBinary(e,t)}static fromJson(e,t){return(new so).fromJson(e,t)}static fromJsonString(e,t){return(new so).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(so,e,t)}}so.runtime=It.w,so.typeName="plugnmeet.UpdateWaitingRoomMessageReq",so.fields=It.w.util.newFieldList((()=>[{no:1,name:"room_id",kind:"scalar",T:9},{no:2,name:"msg",kind:"scalar",T:9}]));class io extends Rt.v{constructor(e){super(),this.roomSid="",this.roomId="",this.userId="",this.service="",this.direction="",this.RequestedUserId="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new io).fromBinary(e,t)}static fromJson(e,t){return(new io).fromJson(e,t)}static fromJsonString(e,t){return(new io).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(io,e,t)}}io.runtime=It.w,io.typeName="plugnmeet.UpdateUserLockSettingsReq",io.fields=It.w.util.newFieldList((()=>[{no:1,name:"room_sid",kind:"scalar",T:9},{no:2,name:"room_id",kind:"scalar",T:9},{no:3,name:"user_id",kind:"scalar",T:9},{no:4,name:"service",kind:"scalar",T:9},{no:5,name:"direction",kind:"scalar",T:9},{no:6,name:"Requested_user_id",kind:"scalar",T:9}]));const no=Ua.Z.create({baseURL:window.PLUG_N_MEET_SERVER_URL+"/api"}),lo=()=>{var e;if(br.getState().session.token)return br.getState().session.token;return null!==(e=new URLSearchParams(window.location.search).get("access_token"))&&void 0!==e?e:""},co=async(e,t,r=!0,a="application/json",o="json")=>{try{r&&(t=JSON.stringify(t));return(await no.post(e,t,{headers:{Authorization:lo(),"Content-Type":a},responseType:o})).data}catch(s){if(console.error(s.message),r)return{status:!1,msg:s.code+": "+s.message};return new Va({status:!1,msg:s.code+": "+s.message}).toBinary()}};var uo;!function(e){e.RAISE_HAND="RAISE_HAND",e.LOWER_HAND="LOWER_HAND",e.OTHER_USER_LOWER_HAND="OTHER_USER_LOWER_HAND",e.FILE_UPLOAD="FILE_UPLOAD",e.INFO="INFO",e.ALERT="ALERT",e.SEND_CHAT_MSGS="SEND_CHAT_MSGS",e.RENEW_TOKEN="RENEW_TOKEN",e.UPDATE_LOCK_SETTINGS="UPDATE_LOCK_SETTINGS",e.INIT_WHITEBOARD="INIT_WHITEBOARD",e.USER_VISIBILITY_CHANGE="USER_VISIBILITY_CHANGE",e.EXTERNAL_MEDIA_PLAYER_EVENTS="EXTERNAL_MEDIA_PLAYER_EVENTS",e.POLL_CREATED="POLL_CREATED",e.NEW_POLL_RESPONSE="NEW_POLL_RESPONSE",e.POLL_CLOSED="POLL_CLOSED",e.JOIN_BREAKOUT_ROOM="JOIN_BREAKOUT_ROOM"}(uo||(uo={}));const mo=(0,wr.P1)((e=>e.bottomIconsActivity.isActiveRaisehand),(e=>e)),po=({currentRoom:e})=>{const t="desktop"===br.getState().session.userDeviceType,{t:r}=(0,m.$G)(),a=yr(),i=kr(mo),[n,d]=(0,s.useState)("primaryColor");(0,s.useEffect)((()=>{d(i?"secondaryColor":"primaryColor dark:text-darkText")}),[i]);return(0,o.jsxs)("div",{className:"hands footer-icon h-[35px] lg:h-[40px] w-[35px] lg:w-[40px] overflow-hidden rounded-full bg-[#F2F2F2] dark:bg-darkSecondary2 hover:bg-[#ECF4FF] mr-3 lg:mr-6 flex items-center justify-center cursor-pointer "+(t?"has-tooltip":""),onClick:()=>(async()=>{if(i){const t=new Qa({roomSid:e.sid,roomId:e.name,msgBodyType:Oa.LOWER_HAND,msg:uo.LOWER_HAND}),r=await co("dataMessage",t.toBinary(),!1,"application/protobuf","arraybuffer"),o=Va.fromBinary(new Uint8Array(r));o.status?a(ce(!1)):(0,l.Am)(o.msg,{type:"error"})}else{const t=new Qa({roomSid:e.sid,roomId:e.name,msgBodyType:Oa.RAISE_HAND,msg:r("footer.notice.has-raised-hand",{user:e.localParticipant.name}).toString()}),o=await co("dataMessage",t.toBinary(),!1,"application/protobuf","arraybuffer"),s=Va.fromBinary(new Uint8Array(o));s.status?(a(ce(!0)),(0,l.Am)(r("footer.notice.you-raised-hand"),{type:"info"})):(0,l.Am)(s.msg,{type:"error"})}})(),children:[(0,o.jsx)("span",{className:"tooltip !bottom-[62px]",children:r(i?"footer.icons.lower-hand":"footer.icons.raise-hand")}),(0,o.jsx)("i",{className:`pnm-raise-hand ${n} text-[14px] lg:text-[16px]`})]})},ho=(0,wr.P1)((e=>e.bottomIconsActivity.isActiveScreenshare),(e=>e)),xo=(0,wr.P1)((e=>e.session.screenSharing),(e=>e)),fo=(0,wr.P1)((e=>{var t,r;return null===(r=null===(t=e.session.currentUser)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.lock_settings.lock_screen_sharing}),(e=>e)),go=({currentRoom:e})=>{var t,r;const a="desktop"===br.getState().session.userDeviceType,i=yr(),{t:n}=(0,m.$G)(),d=kr(ho),c=kr(xo),u=kr(fo),[p,h]=(0,s.useState)("primaryColor"),[x,f]=(0,s.useState)(!1),g=null===(r=null===(t=br.getState().session.currentUser)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.is_admin;(0,s.useEffect)((()=>{c.isActive&&c.sharedBy===e.localParticipant.identity?h("secondaryColor"):h("primaryColor dark:text-darkText")}),[c]);const v=(0,s.useCallback)((()=>{d&&(e.localParticipant.tracks.forEach((t=>{t.source!==Be.fQ.Source.ScreenShare&&t.source!==Be.fQ.Source.ScreenShareAudio||!t.track||e.localParticipant.unpublishTrack(t.track,!0)})),i(me(!1)),i(J({isActive:!1,sharedBy:""})))}),[d,i,e]);(0,s.useEffect)((()=>{g||(u?(f(!0),v()):u||f(!1))}),[v,u]),(0,s.useEffect)((()=>{!c.isActive&&d&&i(me(!1))}),[c]);return(0,o.jsx)(o.Fragment,{children:(()=>{var e;return null===(e=br.getState().session.currentRoom.metadata.room_features)||void 0===e?void 0:e.allow_screen_share})()?(0,o.jsxs)("div",{className:"share-screen footer-icon h-[35px] lg:h-[40px] w-[35px] lg:w-[40px] relative rounded-full bg-[#F2F2F2] dark:bg-darkSecondary2 hover:bg-[#ECF4FF] mr-3 lg:mr-6 hidden md:flex items-center justify-center cursor-pointer "+(a?"has-tooltip":""),onClick:()=>(async()=>{if(!x)if(d)v();else{if(c.isActive)return void(0,l.Am)(n("footer.notice.already-active-screen-sharing"),{toastId:"dup-screen-share",type:"warning"});(await(0,Be.QK)({audio:!0,resolution:Ar()})).forEach((async t=>{await e.localParticipant.publishTrack(t)})),i(me(!0)),i(J({isActive:!0,sharedBy:e.localParticipant.identity}))}})(),children:[(0,o.jsx)("span",{className:"tooltip",children:d?n("footer.icons.stop-screen-sharing"):d||x?x?n("footer.icons.screen-sharing-locked"):void 0:n("footer.icons.start-screen-sharing")}),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("i",{className:`pnm-screen-share ${p} text-[14px] lg:text-[16px]`}),x?(0,o.jsx)("div",{className:"arrow-down absolute -bottom-1 -right-1 w-[16px] h-[16px] rounded-full bg-white flex items-center justify-center",children:(0,o.jsx)("i",{className:"pnm-lock primaryColor"})}):null]})]}):null})};var vo,bo;!function(e){e.NONE="none",e.STARTED_RECORDING="started_recording",e.STOPPING_RECORDING="STOPPING_RECORDING",e.STOPPED_RECORDING="stopped_recording"}(vo||(vo={})),function(e){e.RECORDING_TYPE_NONE="none",e.RECORDING_TYPE_LOCAL="local",e.RECORDING_TYPE_CLOUD="cloud"}(bo||(bo={}));const yo=({showModal:e,recordingFeatures:t,onCloseModal:r})=>{const[a,i]=(0,s.useState)(bo.RECORDING_TYPE_LOCAL),{t:n}=(0,m.$G)();return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(Sr.u,{appear:!0,show:e,as:s.Fragment,children:(0,o.jsx)(_r.V,{as:"div",className:"fixed inset-0 z-[9999] overflow-y-auto",onClose:()=>!1,children:(0,o.jsxs)("div",{className:"min-h-screen px-4 text-center",children:[(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,o.jsx)(_r.V.Overlay,{className:"fixed inset-0 bg-black opacity-30"})}),(0,o.jsx)("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"\u200b"}),(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,o.jsxs)("div",{className:"inline-block w-full max-w-lg p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white dark:bg-darkPrimary shadow-xl rounded-2xl",children:[(0,o.jsxs)("button",{className:"close-btn absolute top-8 right-6 w-[25px] h-[25px] outline-none",type:"button",onClick:()=>{r(bo.RECORDING_TYPE_NONE)},children:[(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 rotate-45"}),(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 -rotate-45"})]}),(0,o.jsx)(_r.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-white text-left mb-2",children:n("footer.icons.how-to-record")}),(0,o.jsx)("hr",{}),(0,o.jsx)("div",{className:"mt-6",children:(0,o.jsxs)("form",{action:"#",method:"POST",onSubmit:e=>(e=>{e.preventDefault(),r(a)})(e),children:[(0,o.jsxs)("div",{className:"mb-10 pl-3",children:[(0,o.jsx)("p",{className:"text-sm text-gray-500 dark:text-darkText",children:n("footer.icons.recording-types-des")}),(0,o.jsxs)("div",{className:"mt-4 pl-2 space-y-4",children:[t.is_allow_local?(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("input",{type:"radio",value:"1",name:"block",id:"yes",checked:a===bo.RECORDING_TYPE_LOCAL,onChange:()=>i(bo.RECORDING_TYPE_LOCAL)}),(0,o.jsx)("label",{htmlFor:"yes",className:"ml-3 block text-sm font-medium text-gray-700 dark:text-darkText",children:n("footer.icons.local-recording")})]}):null,t.is_allow_cloud?(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("input",{type:"radio",value:"0",name:"block",id:"no",checked:a===bo.RECORDING_TYPE_CLOUD,onChange:()=>i(bo.RECORDING_TYPE_CLOUD)}),(0,o.jsx)("label",{htmlFor:"no",className:"ml-3 block text-sm font-medium text-gray-700 dark:text-darkText",children:n("footer.icons.cloud-recording")})]}):null]})]}),(0,o.jsx)("div",{className:"px-4 py-3 bg-gray-50 dark:bg-transparent text-right sm:px-6 mt-4",children:(0,o.jsx)("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primaryColor hover:bg-secondaryColor focus:outline-none focus:ring-2 focus:ring-offset-2 focus:bg-secondaryColor",children:n("footer.icons.start-recording")})})]})})]})})]})})})})};var ko=r(2003);const wo=({closeToast:e})=>{const{t}=(0,m.$G)(),r=yr();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{className:"text-black dark:text-darkText",children:t("polls.new-poll")}),(0,o.jsx)("div",{className:"button-section flex items-center justify-start",children:(0,o.jsx)("button",{className:"text-center py-1 px-3 mt-1 text-xs transition ease-in bg-primaryColor hover:bg-secondaryColor text-white font-semibold rounded-lg",onClick:()=>{r(de(!0)),r(rt(1)),e&&e()},children:t("open")})})]})},To=e=>{const t=Re.selectAll(br.getState()),r=br.getState().session;t.filter((e=>"system"!==e.from.sid)).slice(-30).map((async t=>{var a,o;const s=new Wa({type:Ma.USER,to:null===(o=null===(a=e.body)||void 0===a?void 0:a.from)||void 0===o?void 0:o.userId,roomId:r.currentRoom.room_id,roomSid:r.currentRoom.sid,messageId:"",body:{type:Oa.CHAT,messageId:t.message_id,time:t.time,from:{sid:t.from.sid,userId:t.from.userId,name:t.from.name},msg:t.msg,isPrivate:t.isPrivate?1:0}});Wo(s.toBinary())}))},jo=e=>{var t,r,a;br.getState().whiteboard.requestedWhiteboardData.requested||br.dispatch(gt({requested:!0,sendTo:null!==(a=null===(r=null===(t=e.body)||void 0===t?void 0:t.from)||void 0===r?void 0:r.sid)&&void 0!==a?a:""}))},So=e=>{var t,r;br.dispatch(L(null!==(r=null===(t=e.body)||void 0===t?void 0:t.msg)&&void 0!==r?r:""))},_o=e=>{var t;switch(null===(t=e.body)||void 0===t?void 0:t.type){case Oa.INFO:(0,l.Am)(e.body.msg,{toastId:"info-status",type:"info"});break;case Oa.ALERT:(0,l.Am)(e.body.msg,{toastId:"alert-status",type:"warning"})}},No=e=>{var t,r,a,o;br.dispatch(P({id:null!==(a=null===(r=null===(t=e.body)||void 0===t?void 0:t.from)||void 0===r?void 0:r.userId)&&void 0!==a?a:"",changes:{visibility:null===(o=e.body)||void 0===o?void 0:o.msg}}))},Co=e=>{if(!e.body)return;const t=JSON.parse(e.body.msg);br.dispatch(St(t.action)),"undefined"!==typeof t.seekTo&&br.dispatch(_t(t.seekTo))},Eo=e=>{var t,r,a,s;(null===(t=br.getState().session.currentUser)||void 0===t?void 0:t.isRecorder)||((null===(r=e.body)||void 0===r?void 0:r.type)===Oa.POLL_CREATED?((0,l.Am)((0,o.jsx)(wo,{}),{toastId:"info-status",type:"info",autoClose:!1}),br.dispatch(Gt.util.invalidateTags(["List","PollsStats"]))):(null===(a=e.body)||void 0===a?void 0:a.type)===Oa.NEW_POLL_RESPONSE?br.dispatch(Gt.util.invalidateTags([{type:"Count",id:e.body.msg},{type:"PollDetails",id:e.body.msg}])):(null===(s=e.body)||void 0===s?void 0:s.type)===Oa.POLL_CLOSED&&br.dispatch(Gt.util.invalidateTags(["List","PollsStats"])))},Ro=e=>{e.body&&(br.dispatch(er(e.body.msg)),br.dispatch(cr.util.invalidateTags(["My_Rooms"])))},Io=e=>{const t=JSON.parse(e);br.dispatch(kt(t))};let Ao,Po=!1,Fo=!1,Mo=!1;const Oo="websocketStatus",Do=()=>{Ao=new ko.Z(Bo,[],{connectionTimeout:4e3,maxRetries:20}),Ao.binaryType="arraybuffer",Ao.onopen=()=>{Po=!0,(()=>{var e,t,r,a,o,s,i,n;const l=br.getState().session,d=E.selectAll(br.getState()).filter((e=>{var t;return e.sid!==(null===(t=l.currentUser)||void 0===t?void 0:t.sid)}));if(!d.length)return;d.sort(((e,t)=>e.joinedAt-t.joinedAt));const c=d[0],u=new Wa({type:Ma.SYSTEM,roomSid:l.currentRoom.sid,roomId:l.currentRoom.room_id,to:c.sid,body:{type:Oa.SEND_CHAT_MSGS,from:{sid:null!==(t=null===(e=l.currentUser)||void 0===e?void 0:e.sid)&&void 0!==t?t:"",userId:null!==(a=null===(r=l.currentUser)||void 0===r?void 0:r.userId)&&void 0!==a?a:""},msg:""}});Wo(u.toBinary());const m=new Wa({type:Ma.SYSTEM,roomSid:l.currentRoom.sid,roomId:l.currentRoom.room_id,to:c.sid,body:{type:Oa.INIT_WHITEBOARD,from:{sid:null!==(s=null===(o=l.currentUser)||void 0===o?void 0:o.sid)&&void 0!==s?s:"",userId:null!==(n=null===(i=l.currentUser)||void 0===i?void 0:i.userId)&&void 0!==n?n:""},msg:""}});Wo(m.toBinary())})(),br.dispatch($(!0)),Mo&&(Mo=!1,l.Am.dismiss(Oo))},Ao.onclose=()=>{Po=!1,br.dispatch($(!1)),Fo||(l.Am.loading(f.t("notifications.websocket-disconnected"),{type:l.Am.TYPE.ERROR,autoClose:!1,toastId:Oo,closeButton:!0}),Mo=!0)},Ao.onerror=()=>{(0,l.Am)(f.t("notifications.websocket-error"),{type:l.Am.TYPE.ERROR,autoClose:5e3,toastId:Oo})},Ao.onmessage=e=>{Lo(e)}},Lo=e=>{if(e.data){let r;try{r=Wa.fromBinary(new Uint8Array(e.data))}catch(t){return void console.error(t)}r.type===Ma.USER&&r.body?((e,t,r)=>{var a,o,s,i,n,l,d,c,u,m,p,h;if(e.type===Oa.CHAT){e.messageId||(e.messageId=t);const x={type:"CHAT",message_id:null!==(a=e.messageId)&&void 0!==a?a:"",time:null!==(o=e.time)&&void 0!==o?o:"",from:{sid:null!==(i=null===(s=e.from)||void 0===s?void 0:s.sid)&&void 0!==i?i:"",userId:null!==(l=null===(n=e.from)||void 0===n?void 0:n.userId)&&void 0!==l?l:"",name:null===(d=e.from)||void 0===d?void 0:d.name},isPrivate:1===e.isPrivate,msg:e.msg};r&&(x.to=r),br.dispatch(Ae(x));const f=br.getState().bottomIconsActivity.isActiveChatPanel,g=br.getState().roomSettings.selectedChatOption,v=br.getState().session.currentUser,b=null!==(c="RECORDER_BOT"===(null===v||void 0===v?void 0:v.userId)||"RTMP_BOT"===(null===v||void 0===v?void 0:v.userId))&&void 0!==c&&c;f||(b?br.dispatch(le(!0)):br.dispatch(_e())),e.isPrivate||"public"===g?e.isPrivate&&g!==(null===(u=e.from)||void 0===u?void 0:u.userId)&&(null===(m=e.from)||void 0===m?void 0:m.userId)!==(null===v||void 0===v?void 0:v.userId)&&br.dispatch(st({task:"ADD",id:null!==(h=null===(p=e.from)||void 0===p?void 0:p.userId)&&void 0!==h?h:""})):br.dispatch(st({task:"ADD",id:"public"}))}})(r.body,r.messageId,r.to):r.type===Ma.SYSTEM?(e=>{var t;switch(null===(t=e.body)||void 0===t?void 0:t.type){case Oa.SEND_CHAT_MSGS:To(e);break;case Oa.INIT_WHITEBOARD:jo(e);break;case Oa.RENEW_TOKEN:So(e);break;case Oa.INFO:case Oa.ALERT:_o(e);break;case Oa.USER_VISIBILITY_CHANGE:No(e);break;case Oa.EXTERNAL_MEDIA_PLAYER_EVENTS:Co(e);break;case Oa.POLL_CREATED:case Oa.POLL_CLOSED:case Oa.NEW_POLL_RESPONSE:Eo(e);break;case Oa.JOIN_BREAKOUT_ROOM:Ro(e)}})(r):r.type===Ma.WHITEBOARD&&r.body&&(e=>{var t,r;const a=null===(r=null===(t=br.getState().session.currentUser)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.is_presenter;e.type===Oa.SCENE_UPDATE?br.dispatch(pt(e.msg)):e.type===Oa.POINTER_UPDATE?br.dispatch(ht(e.msg)):e.type===Oa.ADD_WHITEBOARD_FILE?br.dispatch(bt(e.msg)):e.type===Oa.PAGE_CHANGE?a||br.dispatch(vt(Number(e.msg))):e.type===Oa.ADD_WHITEBOARD_OFFICE_FILE?Io(e.msg):e.type===Oa.WHITEBOARD_APP_STATE_CHANGE&&(a||br.dispatch(xt(JSON.parse(e.msg))))})(r.body)}},Bo=()=>{const e=new URL(window.PLUG_N_MEET_SERVER_URL),t=br.getState().session;let r,a="ws://";"https:"===e.protocol&&(a="wss://"),r=a+e.host,"/"!==e.pathname&&(r+=e.pathname);const o=t.token,s=t.currentUser,i=t.currentRoom;return r=r+"/ws?token="+o+"&roomSid="+i.sid+"&userSid="+(null===s||void 0===s?void 0:s.sid)+"&roomId="+i.room_id+"&userId="+(null===s||void 0===s?void 0:s.userId),r},Uo=()=>Po,Wo=e=>{null===Ao||void 0===Ao||Ao.send(e)},Go=(e,t)=>{const[r,a]=(0,s.useState)(vo.NONE),[o,i]=(0,s.useState)(!1),[n,d]=(0,s.useState)(null),[c,u]=(0,s.useState)(null),p=bo.RECORDING_TYPE_LOCAL;let h=[];const x={preferCurrentTab:!0,video:!0,audio:!0},f=br.getState().session,{t:g}=(0,m.$G)(),v=r=>{var o,s;const n=new Date,l=`${t}_${n.toLocaleString()}`,c=new AudioContext,m=c.createMediaStreamDestination();r.getAudioTracks().length&&c.createMediaStreamSource(r).connect(m);const p=e.getTrack(Be.fQ.Source.Microphone);(null===(o=null===p||void 0===p?void 0:p.audioTrack)||void 0===o?void 0:o.mediaStream)&&c.createMediaStreamSource(null===(s=null===p||void 0===p?void 0:p.audioTrack)||void 0===s?void 0:s.mediaStream).connect(m);let x="video/webm";/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&(x="video/mp4");const f=[r.getVideoTracks()[0]];if(m.stream.getTracks().length){const e=m.stream.getTracks()[0];f.push(e)}const g=new MediaStream(f),v=new MediaRecorder(g,{mimeType:x});v.onstart=()=>{a(vo.STARTED_RECORDING),i(!1),b(!0)},v.ondataavailable=e=>{h.push(e.data)},v.onstop=()=>{a(vo.STOPPED_RECORDING),i(!1);const e=new Blob(h,{type:x}),t=URL.createObjectURL(e),o=document.createElement("a");document.body.appendChild(o),o.style="display: none",o.href=t,o.download=l,o.click(),window.URL.revokeObjectURL(t),r&&(null===r||void 0===r||r.getTracks().forEach((e=>e.stop())),d(null)),u(null),h=[],b(!1)},v.onerror=()=>{i(!0),r&&(null===r||void 0===r||r.getTracks().forEach((e=>e.stop())),d(null)),u(null),h=[]},v.start(),u(v)},b=(e=!0)=>{var t,r,a,o;const s={type:Ma.SYSTEM,roomSid:f.currentRoom.sid,roomId:f.currentRoom.room_id,body:{type:Oa.INFO,from:{sid:null===(t=f.currentUser)||void 0===t?void 0:t.sid,userId:null===(r=f.currentUser)||void 0===r?void 0:r.userId}}};s.body.msg=e?g("notifications.local-recording-started",{name:null===(a=f.currentUser)||void 0===a?void 0:a.name}):g("notifications.local-recording-ended",{name:null===(o=f.currentUser)||void 0===o?void 0:o.name});const i=new Wa(s);Wo(i.toBinary())};return{TYPE_OF_RECORDING:p,recordingEvent:r,hasError:o,startRecording:async()=>{if(!n)try{const e=await navigator.mediaDevices.getDisplayMedia(x);d(e),v(e)}catch(e){const t=`Error: ${e}`;(0,l.Am)(t,{toastId:"recording-status",type:"error"}),i(!0),d(null)}},stopRecording:()=>{c&&c.stop(),n&&(null===n||void 0===n||n.getTracks().forEach((e=>e.stop())),d(null))},resetError:()=>{o&&i(!1)}}};var Jo,Vo;!function(e){e[e.START_RECORDING=0]="START_RECORDING",e[e.STOP_RECORDING=1]="STOP_RECORDING",e[e.START_RTMP=2]="START_RTMP",e[e.STOP_RTMP=3]="STOP_RTMP",e[e.END_RECORDING=4]="END_RECORDING",e[e.END_RTMP=5]="END_RTMP",e[e.RECORDING_PROCEEDED=6]="RECORDING_PROCEEDED",e[e.STOP=7]="STOP"}(Jo||(Jo={})),It.w.util.setEnumType(Jo,"plugnmeet.RecordingTasks",[{no:0,name:"START_RECORDING"},{no:1,name:"STOP_RECORDING"},{no:2,name:"START_RTMP"},{no:3,name:"STOP_RTMP"},{no:4,name:"END_RECORDING"},{no:5,name:"END_RTMP"},{no:6,name:"RECORDING_PROCEEDED"},{no:7,name:"STOP"}]),function(e){e[e.RECORDING=0]="RECORDING",e[e.RTMP=1]="RTMP"}(Vo||(Vo={})),It.w.util.setEnumType(Vo,"plugnmeet.RecorderServiceType",[{no:0,name:"RECORDING"},{no:1,name:"RTMP"}]);class Ho extends Rt.v{constructor(e){super(),this.from="",this.task=Jo.START_RECORDING,this.roomId="",this.roomSid="",this.recordingId="",this.recorderId="",this.accessToken="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Ho).fromBinary(e,t)}static fromJson(e,t){return(new Ho).fromJson(e,t)}static fromJsonString(e,t){return(new Ho).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Ho,e,t)}}Ho.runtime=It.w,Ho.typeName="plugnmeet.PlugNmeetToRecorder",Ho.fields=It.w.util.newFieldList((()=>[{no:1,name:"from",kind:"scalar",T:9},{no:2,name:"task",kind:"enum",T:It.w.getEnumType(Jo)},{no:3,name:"room_id",kind:"scalar",T:9},{no:4,name:"room_sid",kind:"scalar",T:9},{no:5,name:"recording_id",kind:"scalar",T:9},{no:6,name:"recorder_id",kind:"scalar",T:9},{no:7,name:"access_token",kind:"scalar",T:9},{no:8,name:"rtmp_url",kind:"scalar",T:9,opt:!0}]));class qo extends Rt.v{constructor(e){super(),this.from="",this.task=Jo.START_RECORDING,this.status=!1,this.msg="",this.recordingId="",this.roomId="",this.roomSid="",this.recorderId="",this.filePath="",this.fileSize=0,It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new qo).fromBinary(e,t)}static fromJson(e,t){return(new qo).fromJson(e,t)}static fromJsonString(e,t){return(new qo).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(qo,e,t)}}qo.runtime=It.w,qo.typeName="plugnmeet.RecorderToPlugNmeet",qo.fields=It.w.util.newFieldList((()=>[{no:1,name:"from",kind:"scalar",T:9},{no:2,name:"task",kind:"enum",T:It.w.getEnumType(Jo)},{no:3,name:"status",kind:"scalar",T:8},{no:4,name:"msg",kind:"scalar",T:9},{no:5,name:"recording_id",kind:"scalar",T:9},{no:6,name:"room_id",kind:"scalar",T:9},{no:7,name:"room_sid",kind:"scalar",T:9},{no:8,name:"recorder_id",kind:"scalar",T:9},{no:9,name:"file_path",kind:"scalar",T:9},{no:10,name:"file_size",kind:"scalar",T:2}]));class $o extends Rt.v{constructor(e){super(),this.task=Jo.START_RECORDING,this.recordingId="",this.roomId="",this.roomSid="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new $o).fromBinary(e,t)}static fromJson(e,t){return(new $o).fromJson(e,t)}static fromJsonString(e,t){return(new $o).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals($o,e,t)}}$o.runtime=It.w,$o.typeName="plugnmeet.FromParentToChild",$o.fields=It.w.util.newFieldList((()=>[{no:1,name:"task",kind:"enum",T:It.w.getEnumType(Jo)},{no:2,name:"recording_id",kind:"scalar",T:9},{no:3,name:"room_id",kind:"scalar",T:9},{no:4,name:"room_sid",kind:"scalar",T:9}]));class zo extends Rt.v{constructor(e){super(),this.task=Jo.START_RECORDING,this.status=!1,this.msg="",this.recordingId="",this.roomId="",this.roomSid="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new zo).fromBinary(e,t)}static fromJson(e,t){return(new zo).fromJson(e,t)}static fromJsonString(e,t){return(new zo).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(zo,e,t)}}zo.runtime=It.w,zo.typeName="plugnmeet.FromChildToParent",zo.fields=It.w.util.newFieldList((()=>[{no:1,name:"task",kind:"enum",T:It.w.getEnumType(Jo)},{no:2,name:"status",kind:"scalar",T:8},{no:3,name:"msg",kind:"scalar",T:9},{no:4,name:"recording_id",kind:"scalar",T:9},{no:5,name:"room_id",kind:"scalar",T:9},{no:6,name:"room_sid",kind:"scalar",T:9}]));class Qo extends Rt.v{constructor(e){super(),this.roomId="",this.recordingId="",this.roomSid="",this.accessToken="",this.postMp4Convert=!1,this.serviceType=Vo.RECORDING,this.websocketUrl="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Qo).fromBinary(e,t)}static fromJson(e,t){return(new Qo).fromJson(e,t)}static fromJsonString(e,t){return(new Qo).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Qo,e,t)}}Qo.runtime=It.w,Qo.typeName="plugnmeet.StartRecorderChildArgs",Qo.fields=It.w.util.newFieldList((()=>[{no:1,name:"room_id",kind:"scalar",T:9},{no:2,name:"recording_id",kind:"scalar",T:9},{no:3,name:"room_sid",kind:"scalar",T:9},{no:4,name:"access_token",kind:"scalar",T:9},{no:5,name:"plug_n_meet_info",kind:"message",T:Yo},{no:6,name:"post_mp4_convert",kind:"scalar",T:8},{no:7,name:"copy_to_path",kind:"message",T:Xo},{no:8,name:"serviceType",kind:"enum",T:It.w.getEnumType(Vo)},{no:9,name:"recorder_id",kind:"scalar",T:9,opt:!0},{no:10,name:"rtmp_url",kind:"scalar",T:9,opt:!0},{no:11,name:"websocket_url",kind:"scalar",T:9},{no:12,name:"custom_chrome_path",kind:"scalar",T:9,opt:!0}]));class Yo extends Rt.v{constructor(e){super(),this.host="",this.apiKey="",this.apiSecret="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Yo).fromBinary(e,t)}static fromJson(e,t){return(new Yo).fromJson(e,t)}static fromJsonString(e,t){return(new Yo).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Yo,e,t)}}Yo.runtime=It.w,Yo.typeName="plugnmeet.PlugNmeetInfo",Yo.fields=It.w.util.newFieldList((()=>[{no:1,name:"host",kind:"scalar",T:9},{no:2,name:"api_key",kind:"scalar",T:9},{no:3,name:"api_secret",kind:"scalar",T:9},{no:4,name:"join_host",kind:"scalar",T:9,opt:!0}]));class Xo extends Rt.v{constructor(e){super(),this.mainPath="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Xo).fromBinary(e,t)}static fromJson(e,t){return(new Xo).fromJson(e,t)}static fromJsonString(e,t){return(new Xo).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Xo,e,t)}}Xo.runtime=It.w,Xo.typeName="plugnmeet.CopyToPath",Xo.fields=It.w.util.newFieldList((()=>[{no:1,name:"main_path",kind:"scalar",T:9},{no:2,name:"sub_path",kind:"scalar",T:9,opt:!0}]));class Ko extends Rt.v{constructor(e){super(),this.task=Jo.START_RECORDING,this.sid="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Ko).fromBinary(e,t)}static fromJson(e,t){return(new Ko).fromJson(e,t)}static fromJsonString(e,t){return(new Ko).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Ko,e,t)}}Ko.runtime=It.w,Ko.typeName="plugnmeet.RecordingReq",Ko.fields=It.w.util.newFieldList((()=>[{no:1,name:"task",kind:"enum",T:It.w.getEnumType(Jo)},{no:2,name:"sid",kind:"scalar",T:9},{no:3,name:"rtmp_url",kind:"scalar",T:9,opt:!0},{no:4,name:"custom_design",kind:"scalar",T:9,opt:!0}]));const Zo=e=>{const t=bo.RECORDING_TYPE_LOCAL,[r,a]=(0,s.useState)(!1),{t:o}=(0,m.$G)();return{TYPE_OF_RECORDING:t,hasError:r,startRecording:async()=>{const t=new Ko({task:Jo.START_RECORDING,sid:e});"undefined"!==typeof window.DESIGN_CUSTOMIZATION&&(t.customDesign=`${window.DESIGN_CUSTOMIZATION}`.replace(/\s/g,""));const r=await co("recording",t.toBinary(),!1,"application/protobuf","arraybuffer"),s=Va.fromBinary(new Uint8Array(r));let i="footer.notice.start-recording-progress";s.status||(a(!0),i=s.msg),(0,l.Am)(o(i),{toastId:"recording-status",type:"info"})},stopRecording:async()=>{const t=new Ko({task:Jo.STOP_RECORDING,sid:e}),r=await co("recording",t.toBinary(),!1,"application/protobuf","arraybuffer"),s=Va.fromBinary(new Uint8Array(r));let i="footer.notice.stop-recording-service-in-progress";s.status||(a(!0),i=s.msg),(0,l.Am)(o(i).toString(),{toastId:"recording-status",type:"info"})},resetError:()=>{r&&a(!1)}}},es=(0,wr.P1)((e=>e.session.isActiveRecording),(e=>e)),ts=({currentRoom:e})=>{var t,r,a,i;const n="desktop"===br.getState().session.userDeviceType,{hasError:d,recordingEvent:c,startRecording:u,stopRecording:p,resetError:h}=Go(e.localParticipant,e.name),{hasError:x,resetError:f,startRecording:g,stopRecording:v}=Zo(e.sid),{t:b}=(0,m.$G)(),y=br.getState().session.currentRoom.metadata,k=y.room_features.recording_features.is_allow,w=null===(r=null===(t=br.getState().session.currentUser)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.is_admin,T=null===(i=null===(a=br.getState().session.currentUser)||void 0===a?void 0:a.metadata)||void 0===i?void 0:i.is_presenter,j=kr(es),[S,_]=(0,s.useState)(!1),[N,C]=(0,s.useState)(!1),[E,R]=(0,s.useState)(!0),[I,A]=(0,s.useState)(!1),[P,F]=(0,s.useState)(bo.RECORDING_TYPE_NONE),[M,O]=(0,s.useState)(void 0),[D,L]=(0,s.useState)(!1);(0,s.useEffect)((()=>{j&&P!==bo.RECORDING_TYPE_CLOUD?(P===bo.RECORDING_TYPE_LOCAL&&I&&p(),F(bo.RECORDING_TYPE_CLOUD),clearTimeout(M),_(!1),A(!0)):j&&P===bo.RECORDING_TYPE_CLOUD&&!I?(clearTimeout(M),_(!1),A(!0)):!j&&P===bo.RECORDING_TYPE_CLOUD&&I&&(clearTimeout(M),_(!1),A(!1),F(bo.RECORDING_TYPE_NONE))}),[j,P,I,M]),(0,s.useEffect)((()=>{k||R(!1)}),[]),(0,s.useEffect)((()=>()=>{M&&clearTimeout(M)}),[M]),(0,s.useEffect)((()=>{c===vo.STARTED_RECORDING?(_(!1),A(!0)):c===vo.STOPPED_RECORDING&&(_(!1),A(!1))}),[c]),(0,s.useEffect)((()=>{const e=()=>{_(!1),A(!1),M&&clearTimeout(M)};x&&(e(),f()),d&&(e(),h())}),[x,d]);const B=e=>{if(e===bo.RECORDING_TYPE_LOCAL)_(!0),F(e),u();else if(e===bo.RECORDING_TYPE_CLOUD){_(!0),F(e),g();const t=setTimeout((()=>{_(!1),(0,l.Am)(b("footer.notice.recording-not-start"),{toastId:"recording-status",type:"error"})}),3e4);O(t)}};(0,s.useEffect)((()=>{let e;return k&&w&&T&&!j&&!D&&y.room_features.recording_features.enable_auto_cloud_recording&&(e=setTimeout((()=>{B(bo.RECORDING_TYPE_CLOUD)}),1e3)),L(!0),()=>{e&&clearTimeout(e)}}),[j]);return(0,o.jsx)(o.Fragment,{children:E&&w?(0,o.jsxs)(o.Fragment,{children:[N?(0,o.jsx)(yo,{showModal:N,recordingFeatures:y.room_features.recording_features,onCloseModal:e=>(e=>{C(!1),B(e)})(e)}):null,(0,o.jsxs)("button",{className:`${I?"record":""} footer-icon h-[35px] lg:h-[40px] w-[35px] lg:w-[40px] overflow-hidden rounded-full bg-[#F2F2F2] dark:bg-darkSecondary2 hover:bg-[#ECF4FF] mr-3 lg:mr-6 flex items-center justify-center cursor-pointer ${n?"has-tooltip":""}`,onClick:()=>(()=>{if(I){if(C(!1),_(!0),P===bo.RECORDING_TYPE_LOCAL)p();else if(P===bo.RECORDING_TYPE_CLOUD){v();const e=setTimeout((()=>{_(!1),(0,l.Am)(b("footer.notice.recording-did-not-stop"),{toastId:"recording-status",type:"error"})}),3e4);O(e)}}else C(!0)})(),disabled:S,children:[(0,o.jsx)("span",{className:"tooltip !bottom-[62px]",children:b(I?"footer.icons.stop-recording":"footer.icons.start-recording")}),(0,o.jsx)("i",{className:"pnm-rec primaryColor dark:text-darkText text-[11px] lg:text-[12px] font-['Nunito Sans'] font-bold"})]})]}):null})};var rs=r(2395);const as=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.default_lock_settings}),(e=>e)),os=()=>{const e=yr(),{t}=(0,m.$G)(),r=kr(as),a=br.getState().session,i=async(e,r)=>{const o=e?"lock":"unlock",s=new io({roomSid:a.currentRoom.sid,roomId:a.currentRoom.room_id,userId:"all",service:r,direction:o}),i=await co("updateLockSettings",s.toBinary(),!1,"application/protobuf","arraybuffer"),n=Va.fromBinary(new Uint8Array(i));n.status?(0,l.Am)(t("footer.notice.applied-settings"),{toastId:"lock-setting-status",type:"info"}):(0,l.Am)(n.msg,{type:"error"})},n=()=>{var e,a,s,n,l,d,c,u,m;return(0,o.jsxs)(rs.r.Group,{children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,o.jsx)(rs.r.Label,{className:"pr-4 w-full dark:text-darkText",children:t("footer.modal.lock-microphone")}),(0,o.jsx)(rs.r,{checked:null!==(e=null===r||void 0===r?void 0:r.lock_microphone)&&void 0!==e&&e,onChange:e=>i(e,"mic"),className:((null===r||void 0===r?void 0:r.lock_microphone)?"bg-primaryColor dark:bg-darkSecondary2":"bg-gray-200 dark:bg-secondaryColor")+" relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2",children:(0,o.jsx)("span",{className:((null===r||void 0===r?void 0:r.lock_microphone)?"translate-x-6":"translate-x-1")+" inline-block w-4 h-4 transform bg-white rounded-full transition-transform"})})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,o.jsx)(rs.r.Label,{className:"pr-4 w-full dark:text-darkText",children:t("footer.modal.lock-webcams")}),(0,o.jsx)(rs.r,{checked:null!==(a=null===r||void 0===r?void 0:r.lock_webcam)&&void 0!==a&&a,onChange:e=>i(e,"webcam"),className:((null===r||void 0===r?void 0:r.lock_webcam)?"bg-primaryColor dark:bg-darkSecondary2":"bg-gray-200 dark:bg-secondaryColor")+" relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2",children:(0,o.jsx)("span",{className:((null===r||void 0===r?void 0:r.lock_webcam)?"translate-x-6":"translate-x-1")+" inline-block w-4 h-4 transform bg-white rounded-full transition-transform"})})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,o.jsx)(rs.r.Label,{className:"pr-4 w-full dark:text-darkText",children:t("footer.modal.lock-screen-sharing")}),(0,o.jsx)(rs.r,{checked:null!==(s=null===r||void 0===r?void 0:r.lock_screen_sharing)&&void 0!==s&&s,onChange:e=>i(e,"screenShare"),className:((null===r||void 0===r?void 0:r.lock_screen_sharing)?"bg-primaryColor dark:bg-darkSecondary2":"bg-gray-200 dark:bg-secondaryColor")+" relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2",children:(0,o.jsx)("span",{className:((null===r||void 0===r?void 0:r.lock_screen_sharing)?"translate-x-6":"translate-x-1")+" inline-block w-4 h-4 transform bg-white rounded-full transition-transform"})})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,o.jsx)(rs.r.Label,{className:"pr-4 w-full dark:text-darkText",children:t("footer.modal.lock-whiteboard")}),(0,o.jsx)(rs.r,{checked:null!==(n=null===r||void 0===r?void 0:r.lock_whiteboard)&&void 0!==n&&n,onChange:e=>i(e,"whiteboard"),className:((null===r||void 0===r?void 0:r.lock_whiteboard)?"bg-primaryColor dark:bg-darkSecondary2":"bg-gray-200 dark:bg-secondaryColor")+" relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2",children:(0,o.jsx)("span",{className:((null===r||void 0===r?void 0:r.lock_whiteboard)?"translate-x-6":"translate-x-1")+" inline-block w-4 h-4 transform bg-white rounded-full transition-transform"})})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,o.jsx)(rs.r.Label,{className:"pr-4 w-full dark:text-darkText",children:t("footer.modal.lock-shared-notepad")}),(0,o.jsx)(rs.r,{checked:null!==(l=null===r||void 0===r?void 0:r.lock_shared_notepad)&&void 0!==l&&l,onChange:e=>i(e,"sharedNotepad"),className:((null===r||void 0===r?void 0:r.lock_shared_notepad)?"bg-primaryColor dark:bg-darkSecondary2":"bg-gray-200 dark:bg-secondaryColor")+" relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2",children:(0,o.jsx)("span",{className:((null===r||void 0===r?void 0:r.lock_shared_notepad)?"translate-x-6":"translate-x-1")+" inline-block w-4 h-4 transform bg-white rounded-full transition-transform"})})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,o.jsx)(rs.r.Label,{className:"pr-4 w-full dark:text-darkText",children:t("footer.modal.lock-chat")}),(0,o.jsx)(rs.r,{checked:null!==(d=null===r||void 0===r?void 0:r.lock_chat)&&void 0!==d&&d,onChange:e=>i(e,"chat"),className:((null===r||void 0===r?void 0:r.lock_chat)?"bg-primaryColor dark:bg-darkSecondary2":"bg-gray-200 dark:bg-secondaryColor")+" relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2",children:(0,o.jsx)("span",{className:((null===r||void 0===r?void 0:r.lock_chat)?"translate-x-6":"translate-x-1")+" inline-block w-4 h-4 transform bg-white rounded-full transition-transform"})})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,o.jsx)(rs.r.Label,{className:"pr-4 w-full dark:text-darkText",children:t("footer.modal.lock-send-message")}),(0,o.jsx)(rs.r,{checked:null!==(c=null===r||void 0===r?void 0:r.lock_chat_send_message)&&void 0!==c&&c,onChange:e=>i(e,"sendChatMsg"),className:((null===r||void 0===r?void 0:r.lock_chat_send_message)?"bg-primaryColor dark:bg-darkSecondary2":"bg-gray-200 dark:bg-secondaryColor")+" relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2",children:(0,o.jsx)("span",{className:((null===r||void 0===r?void 0:r.lock_chat_send_message)?"translate-x-6":"translate-x-1")+" inline-block w-4 h-4 transform bg-white rounded-full transition-transform"})})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,o.jsx)(rs.r.Label,{className:"pr-4 w-full dark:text-darkText",children:t("footer.modal.lock-chat-file-share")}),(0,o.jsx)(rs.r,{checked:null!==(u=null===r||void 0===r?void 0:r.lock_chat_file_share)&&void 0!==u&&u,onChange:e=>i(e,"chatFile"),className:((null===r||void 0===r?void 0:r.lock_chat_file_share)?"bg-primaryColor dark:bg-darkSecondary2":"bg-gray-200 dark:bg-secondaryColor")+" relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2",children:(0,o.jsx)("span",{className:((null===r||void 0===r?void 0:r.lock_chat_file_share)?"translate-x-6":"translate-x-1")+" inline-block w-4 h-4 transform bg-white rounded-full transition-transform"})})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,o.jsx)(rs.r.Label,{className:"pr-4 w-full dark:text-darkText",children:t("footer.modal.lock-private-chat")}),(0,o.jsx)(rs.r,{checked:null!==(m=null===r||void 0===r?void 0:r.lock_private_chat)&&void 0!==m&&m,onChange:e=>i(e,"privateChat"),className:((null===r||void 0===r?void 0:r.lock_private_chat)?"bg-primaryColor dark:bg-darkSecondary2":"bg-gray-200 dark:bg-secondaryColor")+" relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2",children:(0,o.jsx)("span",{className:((null===r||void 0===r?void 0:r.lock_private_chat)?"translate-x-6":"translate-x-1")+" inline-block w-4 h-4 transform bg-white rounded-full transition-transform"})})]})]})};return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(Sr.u,{appear:!0,show:!0,as:s.Fragment,children:(0,o.jsx)(_r.V,{as:"div",className:"fixed inset-0 z-[9999] overflow-y-auto",onClose:()=>!1,children:(0,o.jsxs)("div",{className:"min-h-screen px-4 text-center",children:[(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,o.jsx)(_r.V.Overlay,{className:"fixed inset-0 bg-black opacity-30"})}),(0,o.jsx)("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"\u200b"}),(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,o.jsxs)("div",{className:"inline-block w-full max-w-lg p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white dark:bg-darkPrimary shadow-xl rounded-2xl",children:[(0,o.jsxs)("button",{className:"close-btn absolute top-8 right-6 w-[25px] h-[25px] outline-none",type:"button",onClick:()=>{e(ge(!1))},children:[(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 rotate-45"}),(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 -rotate-45"})]}),(0,o.jsx)(_r.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-white mb-2",children:t("footer.modal.lock-settings-title")}),(0,o.jsx)("hr",{}),(0,o.jsx)("div",{className:"mt-6",children:n()})]})})]})})})})})};var ss=r(8966);const is=(0,wr.P1)((e=>e.session.isActiveRtmpBroadcasting),(e=>e)),ns=()=>{const e=yr(),{t}=(0,m.$G)(),r=kr(is),[a,i]=(0,s.useState)("youtube"),[n,d]=(0,s.useState)(!1),[c,u]=(0,s.useState)(""),[p,h]=(0,s.useState)(""),x={youtube:"rtmp://a.rtmp.youtube.com/live2/",facebook:"rtmps://live-api-s.facebook.com:443/rtmp/"};(0,s.useEffect)((()=>{d("other"===a)}),[a]);const f=async(r=!1)=>{if(e(be(!1)),!r)return;const a=new Ko({task:Jo.STOP_RTMP,sid:br.getState().session.currentRoom.sid}),o=await co("rtmp",a.toBinary(),!1,"application/protobuf","arraybuffer"),s=Va.fromBinary(new Uint8Array(o));let i=t("footer.notice.rtmp-ending");s.status||(i=s.msg),(0,l.Am)(t(i),{toastId:"rtmp-status",type:"info"})};return(0,o.jsx)(o.Fragment,{children:r?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(Sr.u,{appear:!0,show:r,as:s.Fragment,children:(0,o.jsx)(_r.V,{as:"div",className:"fixed inset-0 z-[9999] overflow-y-auto",onClose:f,children:(0,o.jsxs)("div",{className:"min-h-screen px-4 text-center",children:[(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,o.jsx)(_r.V.Overlay,{className:"fixed inset-0 bg-black opacity-30"})}),(0,o.jsx)("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"\u200b"}),(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,o.jsxs)("div",{className:"inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white shadow-xl rounded-2xl",children:[(0,o.jsxs)("button",{className:"close-btn absolute top-8 right-6 w-[25px] h-[25px] outline-none",type:"button",onClick:()=>f(),children:[(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor absolute top-0 left-0 rotate-45"}),(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor absolute top-0 left-0 -rotate-45"})]}),(0,o.jsx)(_r.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900",children:t("footer.modal.rtmp-close-confirm")}),(0,o.jsx)("div",{className:"mt-2",children:(0,o.jsx)("p",{className:"text-sm text-gray-500",children:t("footer.modal.rtmp-close-msg")})}),(0,o.jsxs)("div",{className:"mt-4",children:[(0,o.jsx)("button",{className:"inline-flex justify-center px-4 py-2 text-sm font-medium text-white bg-red-600 mr-4 border border-transparent rounded-md hover:bg-red-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500",onClick:()=>f(!0),children:t("ok")}),(0,o.jsx)("button",{type:"button",className:"inline-flex justify-center px-4 py-2 text-sm font-medium text-blue-900 bg-blue-100 border border-transparent rounded-md hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500",onClick:()=>f(!1),children:t("close")})]})]})})]})})})}):(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(Sr.u,{appear:!0,show:!r,as:s.Fragment,children:(0,o.jsx)(_r.V,{as:"div",className:"fixed inset-0 z-[9999] overflow-y-auto",onClose:()=>!1,children:(0,o.jsxs)("div",{className:"min-h-screen px-4 text-center",children:[(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,o.jsx)(_r.V.Overlay,{className:"fixed inset-0 bg-black opacity-30"})}),(0,o.jsx)("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"\u200b"}),(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,o.jsxs)("div",{className:"inline-block w-full max-w-lg p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white dark:bg-darkPrimary shadow-xl rounded-2xl",children:[(0,o.jsxs)("button",{className:"close-btn absolute top-8 right-6 w-[25px] h-[25px] outline-none",type:"button",onClick:()=>{e(be(!1))},children:[(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 rotate-45"}),(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 -rotate-45"})]}),(0,o.jsx)(_r.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-white text-left mb-2",children:t("footer.modal.rtmp-title")}),(0,o.jsx)("hr",{}),(0,o.jsx)("div",{className:"mt-6",children:(0,o.jsxs)("form",{action:"#",method:"POST",onSubmit:r=>(async r=>{if(r.preventDefault(),"other"===a&&(0,ss.isEmpty)(c))return;if((0,ss.isEmpty)(p))return;let o="";if(o="other"===a?c:x[a],!(0,ss.isURL)(o,{protocols:["rtmp","rtmps"]}))return;const s=new Ko({task:Jo.START_RTMP,sid:br.getState().session.currentRoom.sid,rtmpUrl:o+"/"+p});"undefined"!==typeof window.DESIGN_CUSTOMIZATION&&(s.customDesign=`${window.DESIGN_CUSTOMIZATION}`.replace(/\s/g,""));const i=await co("rtmp",s.toBinary(),!1,"application/protobuf","arraybuffer"),n=Va.fromBinary(new Uint8Array(i));let d="footer.notice.rtmp-starting";n.status||(d=n.msg),(0,l.Am)(t(d),{toastId:"rtmp-status",type:"info"}),e(be(!1))})(r),children:[(0,o.jsx)("div",{className:"s",children:(0,o.jsxs)("div",{className:"grid grid-cols-6 gap-6",children:[(0,o.jsxs)("div",{className:"col-span-6 sm:col-span-4",children:[(0,o.jsx)("label",{htmlFor:"provider",className:"block text-sm font-medium text-gray-700 dark:text-darkText",children:t("footer.modal.rtmp-select-provider")}),(0,o.jsxs)("select",{id:"provider",name:"provider",className:"mt-1 block w-full py-2 px-3 bg-transparent border border-gray-300 dark:border-darkText rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:text-darkText",onChange:e=>i(e.currentTarget.value),value:a,children:[(0,o.jsx)("option",{value:"youtube",children:"YouTube"}),(0,o.jsx)("option",{value:"facebook",children:"Facebook"}),(0,o.jsx)("option",{value:"other",children:"Other"})]})]}),n?(0,o.jsxs)("div",{className:"col-span-6 sm:col-span-4",children:[(0,o.jsx)("label",{htmlFor:"stream-url",className:"block text-sm font-medium text-gray-700 dark:text-darkText",children:t("footer.modal.rtmp-server-url")}),(0,o.jsx)("input",{type:"text",name:"stream-url",id:"stream-url",value:c,onChange:e=>u(e.currentTarget.value),className:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 dark:border-darkText rounded-md h-10 border border-solid border-black/50 bg-transparent dark:text-darkText"})]}):null,(0,o.jsxs)("div",{className:"col-span-6 sm:col-span-4",children:[(0,o.jsx)("label",{htmlFor:"stream-key",className:"block text-sm font-medium text-gray-700 dark:text-darkText",children:t("footer.modal.rtmp-stream-key")}),(0,o.jsx)("input",{type:"text",name:"stream-key",id:"stream-key",value:p,onChange:e=>h(e.currentTarget.value),className:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 dark:border-darkText rounded-md h-10 border border-solid border-black/50 bg-transparent dark:text-darkText"})]})]})}),(0,o.jsx)("div",{className:"px-4 py-3 bg-gray-50 dark:bg-transparent text-right sm:px-6 mt-4",children:(0,o.jsx)("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primaryColor hover:bg-secondaryColor focus:outline-none focus:ring-2 focus:ring-offset-2 focus:bg-secondaryColor",children:t("footer.modal.rtmp-start-broadcast")})})]})})]})})]})})})})})};var ls=r(1466),ds=r(6486),cs=r(6310);const us=()=>{const e=yr(),{t}=(0,m.$G)(),[r,a]=(0,s.useState)(""),[i,n]=(0,s.useState)();return(0,o.jsxs)("form",{method:"POST",onSubmit:a=>(async a=>{if(a.preventDefault(),(0,ds.isEmpty)(r))return void n(t("footer.notice.external-media-player-url-required").toString());if(!cs.Z.canPlay(r))return void n(t("footer.notice.external-media-player-url-invalid").toString());n(void 0),e(ye(!1));const o=l.Am.loading(t("footer.notice.external-media-player-starting"),{type:"info"}),s=new Za({task:La.START_PLAYBACK,url:r}),i=await co("externalMediaPlayer",s.toBinary(),!1,"application/protobuf","arraybuffer"),d=Va.fromBinary(new Uint8Array(i));d.status||l.Am.update(o,{render:t(d.msg),type:"error",isLoading:!1,autoClose:1e3}),l.Am.dismiss(o),e(ye(!1))})(a),children:[(0,o.jsx)("div",{className:"s",children:(0,o.jsx)("div",{className:"",children:(0,o.jsxs)("div",{className:"",children:[(0,o.jsx)("label",{htmlFor:"stream-key",className:"block text-sm font-medium text-gray-700 dark:text-darkText",children:t("footer.modal.external-media-player-url")}),(0,o.jsx)("input",{type:"text",name:"stream-key",id:"stream-key",value:r,onChange:e=>{i&&n(void 0),a(e.currentTarget.value)},className:"mt-1 px-2 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm rounded-md h-10 border border-solid border-black/50 dark:border-darkText bg-transparent dark:text-darkText autofill:bg-transparent"}),i?(0,o.jsx)("div",{className:"error-msg absolute text-xs text-red-600 py-2",children:i}):null]})})}),(0,o.jsx)("div",{className:"pb-3 pt-4 bg-gray-50 dark:bg-transparent text-right mt-4",children:(0,o.jsx)("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primaryColor hover:bg-secondaryColor focus:outline-none focus:ring-2 focus:ring-offset-2 focus:bg-secondaryColor",children:t("footer.modal.external-media-player-play")})})]})},ms=()=>{const{t:e}=(0,m.$G)(),t=yr(),[r,a]=(0,s.useState)(),[i,n]=(0,s.useState)(),d=["mp4","mp3","webm"],{isUploading:c,result:u}=ta({allowedFileTypes:d,maxFileSize:void 0,files:r});(0,s.useEffect)((()=>{if(u&&u.filePath){(async r=>{const a=l.Am.loading(e("footer.notice.external-media-player-starting"),{type:"info"}),o=new Za({task:La.START_PLAYBACK,url:r}),s=await co("externalMediaPlayer",o.toBinary(),!1,"application/protobuf","arraybuffer"),i=Va.fromBinary(new Uint8Array(s));i.status||l.Am.update(a,{render:e(i.msg),type:"error",isLoading:!1,autoClose:1e3}),l.Am.dismiss(a),t(ye(!1))})(window.PLUG_N_MEET_SERVER_URL+"/download/uploadedFile/"+u.filePath)}}),[u]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"ex-m-p-file-upload relative h-[80px] mt-[10px] mb-[50px]",children:[(0,o.jsx)("div",{className:"absolute -bottom-[30px] dark:text-darkText",children:e("footer.modal.external-media-player-upload-supported-files",{files:d.map((e=>"."+e)).join(", ")})}),(0,o.jsx)("input",{type:"file",id:"chat-file",accept:d.map((e=>"."+e)).join(","),onChange:e=>(e=>{const t=e.target.files;t.length&&n([...t])})(e),className:"absolute w-full h-full top-0 py-[28px] px-5 border border-dashed border-primaryColor dark:border-darkText dark:text-darkText cursor-pointer rounded"})]}),(0,o.jsx)("div",{className:"pb-3 pt-4 bg-gray-50 dark:bg-transparent text-right mt-4",children:(0,o.jsx)("button",{className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primaryColor hover:bg-secondaryColor focus:outline-none focus:ring-2 focus:ring-offset-2 focus:bg-secondaryColor",disabled:c,onClick:()=>{!c&&i&&a([...i])},children:e("footer.modal.external-media-player-upload-file-play")})})]})},ps=({isActive:e})=>{const t=yr(),{t:r}=(0,m.$G)(),a=[{id:1,title:(0,o.jsx)(o.Fragment,{children:r("footer.modal.external-media-player-direct-link")}),elm:(0,o.jsx)(us,{})},{id:2,title:(0,o.jsx)(o.Fragment,{children:r("footer.modal.external-media-player-upload-file")}),elm:(0,o.jsx)(ms,{})}];return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(Sr.u,{appear:!0,show:!e,as:s.Fragment,children:(0,o.jsx)(_r.V,{as:"div",className:"fixed inset-0 z-[9999] overflow-y-auto",onClose:()=>!1,children:(0,o.jsxs)("div",{className:"min-h-screen px-4 text-center",children:[(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,o.jsx)(_r.V.Overlay,{className:"fixed inset-0 bg-black opacity-30"})}),(0,o.jsx)("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"\u200b"}),(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,o.jsxs)("div",{className:"inline-block w-full max-w-lg p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white dark:bg-darkPrimary shadow-xl rounded-2xl",children:[(0,o.jsxs)("button",{className:"close-btn absolute top-8 right-6 w-[25px] h-[25px] outline-none",type:"button",onClick:()=>{t(ye(!1))},children:[(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 rotate-45"}),(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 -rotate-45"})]}),(0,o.jsx)(_r.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-white text-left mb-2",children:r("footer.modal.external-media-player-title")}),(0,o.jsx)("hr",{}),(0,o.jsx)("div",{className:"mt-6",children:(0,o.jsxs)(ls.O.Group,{vertical:!0,children:[(0,o.jsx)(ls.O.List,{className:"flex",children:a.map((e=>(0,o.jsx)(ls.O,{className:({selected:e})=>((...e)=>e.filter(Boolean).join(" "))("w-full py-2 text-xs text-black dark:text-darkText font-bold leading-5 border-b-4 border-solid transition ease-in",e?"border-[#004d90]":"border-[#004d90]/20"),children:(0,o.jsx)("div",{className:"name relative inline-block",children:e.title})},e.id)))}),(0,o.jsx)(ls.O.Panels,{className:"relative h-[calc(100%-45px)]",children:a.map((e=>(0,o.jsx)(ls.O.Panel,{className:""+(2===e.id||3===e.id?"polls h-full":"px-2 xl:px-4 pt-2 xl:pt-5 h-full overflow-auto scrollBar"),children:(0,o.jsx)(o.Fragment,{children:e.elm})},e.id)))})]})})]})})]})})})})},hs=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_features.external_media_player_features.is_active}),(e=>e)),xs=()=>{const e=kr(hs);return(0,o.jsx)(o.Fragment,{children:e?null:(0,o.jsx)(ps,{isActive:null!==e&&void 0!==e&&e})})},fs=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_features.waiting_room_features.waiting_room_msg}),(e=>e)),gs=()=>{const{t:e}=(0,m.$G)(),t=kr(fs),[r,a]=(0,s.useState)(null!==t&&void 0!==t?t:"");return(0,o.jsxs)("div",{className:"mb-4 text-right",children:[(0,o.jsx)("p",{className:"text-sm text-black dark:text-darkText capitalize mb-2 block text-left",children:e("waiting-room.update-waiting-message")}),(0,o.jsx)("textarea",{value:r,onChange:e=>a(e.currentTarget.value),className:"border border-solid border-primaryColor/20 dark:border-darkText bg-transparent h-20 w-full block p-3 rounded-xl outline-none text-sm dark:text-darkText"}),(0,o.jsx)("button",{onClick:async()=>{if((0,ds.isEmpty)(r))return;const t=new so({msg:r}),a=await co("waitingRoom/updateMsg",t.toBinary(),!1,"application/protobuf","arraybuffer"),o=Va.fromBinary(new Uint8Array(a));o.status?(0,l.Am)(e("waiting-room.updated-msg"),{type:"info"}):(0,l.Am)(e(o.msg),{type:"error"})},className:"py-1 px-6 mt-2 rounded-xl text-white text-sm inline-block mr-0 ml-auto transition ease-in bg-primaryColor hover:bg-secondaryColor",children:e("waiting-room.update-msg")})]})},vs=({waitingParticipants:e})=>{const{t}=(0,m.$G)();return(0,o.jsxs)("div",{className:"mb-4 flex flex-wrap items-center justify-start",children:[(0,o.jsx)("button",{onClick:()=>{e.forEach((async e=>{const r=new oo({userId:e.userId}),a=await co("waitingRoom/approveUsers",r.toBinary(),!1,"application/protobuf","arraybuffer"),o=Va.fromBinary(new Uint8Array(a));o.status||(0,l.Am)(t(o.msg),{type:"error"})}))},className:"py-1 px-6 mr-4 rounded-xl text-white text-sm block transition ease-in bg-primaryColor hover:bg-secondaryColor",children:t("waiting-room.accept-all")}),(0,o.jsx)("button",{onClick:()=>{const r=br.getState().session,a=new za({sid:r.currentRoom.sid,roomId:r.currentRoom.room_id});e.forEach((async e=>{a.userId=e.userId,a.msg=t("notifications.you-have-reject"),a.blockUser=!1;const r=await co("removeParticipant",a.toBinary(),!1,"application/protobuf","arraybuffer"),o=Va.fromBinary(new Uint8Array(r));o.status||(0,l.Am)(t(o.msg),{type:"error"})}))},className:"py-1 px-6 rounded-xl text-white text-sm block transition ease-in bg-primaryColor hover:bg-secondaryColor",children:t("waiting-room.reject-all")})]})},bs=({waitingParticipants:e})=>{const{t}=(0,m.$G)(),r=async(e,r)=>{const a=br.getState().session,o=new za({sid:a.currentRoom.sid,roomId:a.currentRoom.room_id,userId:e,msg:t("notifications.you-have-reject").toString(),blockUser:r}),s=await co("removeParticipant",o.toBinary(),!1,"application/protobuf","arraybuffer"),i=Va.fromBinary(new Uint8Array(s));i.status?(0,l.Am)(t("left-panel.menus.notice.participant-removed"),{toastId:"user-remove-status",type:"info"}):(0,l.Am)(t(i.msg),{type:"error"})};return(0,o.jsxs)("div",{className:"waiting-list-wrap",children:[(0,o.jsx)("p",{className:"text-lg my-4 text-black dark:text-white font-bold",children:t("waiting-room.list-waiting-participants",{count:e.length})}),(0,o.jsx)("div",{className:"waiting-list scrollBar h-[130px] overflow-auto",children:(0,o.jsx)("div",{className:"waiting-list-inner",children:e.map((e=>(0,o.jsxs)("div",{className:"waiting-list-item mb-2 pb-2 border-b border-solid border-primaryColor w-full max-w-max",children:[(0,o.jsx)("p",{className:"text-base text-black dark:text-darkText",children:e.name}),(0,o.jsx)("button",{onClick:()=>(async e=>{const r=new oo({userId:e}),a=await co("waitingRoom/approveUsers",r.toBinary(),!1,"application/protobuf","arraybuffer"),o=Va.fromBinary(new Uint8Array(a));o.status?(0,l.Am)(t("left-panel.menus.notice.user-approved",{name}),{type:"info"}):(0,l.Am)(t(o.msg),{type:"error"})})(e.userId),className:"text-xs text-white py-[1px] px-2 rounded-lg transition ease-in bg-primaryColor hover:bg-secondaryColor",children:t("left-panel.approve")}),(0,o.jsx)("button",{onClick:()=>r(e.userId,!1),className:"text-xs text-white py-[1px] px-2 rounded-lg transition ease-in bg-red-600 hover:bg-red-800 ml-2",children:t("left-panel.reject")}),(0,o.jsx)("button",{onClick:()=>r(e.userId,!0),className:"text-xs text-white py-[1px] px-2 rounded-lg transition ease-in bg-red-600 hover:bg-red-800 ml-2",children:t("waiting-room.reject-and-block-user")})]},e.userId)))})})]})},ys=()=>{const{t:e}=(0,m.$G)(),t=yr(),r=kr(E.selectAll),[a,i]=(0,s.useState)(!0),[n,l]=(0,s.useState)();(0,s.useEffect)((()=>{if(r.length){const e=r.filter((e=>e.metadata.wait_for_approval));l(e)}}),[r]);return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(Sr.u,{appear:!0,show:a,as:s.Fragment,children:(0,o.jsx)(_r.V,{as:"div",className:"fixed inset-0 z-[9999] overflow-y-auto",onClose:()=>!1,children:(0,o.jsxs)("div",{className:"min-h-screen px-4 text-center",children:[(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,o.jsx)(_r.V.Overlay,{className:"fixed inset-0 bg-black opacity-30"})}),(0,o.jsx)("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"\u200b"}),(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,o.jsxs)("div",{className:"inline-block w-full max-w-lg p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white dark:bg-darkPrimary shadow-xl rounded-2xl",children:[(0,o.jsxs)("button",{className:"close-btn absolute top-8 right-6 w-[25px] h-[25px] outline-none",type:"button",onClick:()=>(i(!1),void t(ve(!1))),children:[(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 rotate-45"}),(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 -rotate-45"})]}),(0,o.jsx)(_r.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-darkText text-left mb-2",children:e("waiting-room.modal-title")}),(0,o.jsx)("hr",{}),(0,o.jsxs)("div",{className:"mt-6",children:[(0,o.jsx)(gs,{}),(0,o.jsx)(vs,{waitingParticipants:null!==n&&void 0!==n?n:[]}),(0,o.jsx)(bs,{waitingParticipants:null!==n&&void 0!==n?n:[]})]})]})})]})})})})},ks=e=>{const t=(0,s.useRef)();return(0,s.useEffect)((()=>{t.current=e})),t.current};var ws=r(994),Ts=r(6487);const js="user",Ss=({name:e,id:t})=>{const[{isDragging:r},a]=(0,Ts.c)((()=>({type:js,item:{name:e,id:t},collect:e=>({isDragging:e.isDragging(),handlerId:e.getHandlerId()})}))),s=r?.4:1;return(0,o.jsx)("div",{ref:a,style:{opacity:s},className:"userBox text-sm sm:text-base text-black dark:text-darkText bg-white dark:bg-darkSecondary2 border-b border-solid border-black/80 dark:border-darkText/90 w-full px-2 py-1 cursor-move",children:e})},_s=({roomId:e,name:t,users:r})=>{const a=yr(),[{canDrop:s,isOver:i},n]=(0,ws.L)((()=>({accept:js,drop:t=>{a(Zt({id:t.id,roomId:e}))},collect:e=>({isOver:e.isOver(),canDrop:e.canDrop()})}))),l=s&&i;let d="bg-white dark:bg-darkPrimary";return l?d="bg-primaryColor":s&&(d="bg-secondaryColor"),(0,o.jsxs)("div",{ref:n,className:`roomBox scrollBar scrollBar2 overflow-hidden overflow-y-auto h-60 w-full sm:w-[13rem] lg:w-[13.2rem] xl:w-[13.75rem] mr-4 lg:mr-6 mb-2 sm:mb-6  border border-solid border-black dark:border-darkText ${d}`,children:[(0,o.jsx)("p",{className:"text-sm sm:text-base  px-2 py-1 border-b-2 border-solid\n        "+(l||s?"text-white border-white":"text-black dark:text-darkText border-black dark:border-darkText"),children:t}),r.map((e=>(0,o.jsx)("div",{children:(0,o.jsx)(Ss,{name:e.name,id:e.id})},e.id)))]})},Ns=(0,wr.P1)((e=>e.breakoutRoom.droppedUser),(e=>e)),Cs=()=>{var e,t;const{t:r}=(0,m.$G)(),a=yr(),i=kr(E.selectAll),n=kr(Ns),[d,c]=(0,s.useState)(1),u=ks(d),[p,h]=(0,s.useState)(15),[x,f]=(0,s.useState)(null!==(t=null===(e=br.getState().session.currentRoom.metadata)||void 0===e?void 0:e.welcome_message)&&void 0!==t?t:""),[g,v]=(0,s.useState)(),[b,y]=(0,s.useState)([]),[k,{isLoading:w,data:T}]=mr();(0,s.useEffect)((()=>()=>{a(Zt({id:"",roomId:0}))}),[a]),(0,s.useEffect)((()=>{if(b.length===i.length)return;const e=[];i.forEach((t=>{const r=b.filter((e=>e.id===t.userId));r.length?e.push(r[0]):e.push({id:t.userId,name:t.name,roomId:0,joined:!1})})),y(e)}),[i,b]),(0,s.useEffect)((()=>{if(d===u||d>u)return;const e=[];i.forEach((t=>{e.push({id:t.userId,name:t.name,roomId:0,joined:!1})})),y(e)}),[i,d,u]),(0,s.useEffect)((()=>{const e=[{id:0,name:r("breakout-room.main-room")}];for(let t=0;t<d;t++)e.push({id:t+1,name:r("breakout-room.new-room",{num:t+1})});v(e)}),[d]),(0,s.useEffect)((()=>{if(""===n.id)return;const e=b.map((e=>(e.id===n.id&&(e.roomId=n.roomId),e)));y(e)}),[n]),(0,s.useEffect)((()=>{!w&&T&&(T.status?((0,l.Am)(r("breakout-room.rooms-created"),{type:"info"}),a(ke(!1))):(0,l.Am)(r(T.msg),{type:"error"}))}),[w,T]);return(0,o.jsxs)("div",{className:"break-out-room-main-area",children:[(0,o.jsxs)("div",{className:"row flex flex-wrap justify-start items-end",children:[(()=>{var e,t,a,s;const i=null!==(s=null===(a=null===(t=null===(e=br.getState().session.currentRoom.metadata)||void 0===e?void 0:e.room_features)||void 0===t?void 0:t.breakout_room_features)||void 0===a?void 0:a.allowed_number_rooms)&&void 0!==s?s:6,n=[];for(let r=0;r<i;r++)n.push((0,o.jsx)("option",{value:r+1,children:r+1},r));return(0,o.jsxs)("div",{className:"numbers-of-room w-full sm:w-56 mb-4 sm:mr-10",children:[(0,o.jsx)("label",{className:"block text-base text-black dark:text-darkText mb-1",htmlFor:"breakout-room-number",children:r("breakout-room.num-rooms")}),(0,o.jsx)("select",{className:"w-full block outline-none border border-solid rounded p-1 h-9 bg-transparent dark:border-darkText dark:text-darkText",id:"breakout-room-number",onChange:e=>c(Number(e.currentTarget.value)),children:n})]})})(),(0,o.jsxs)("div",{className:"room-durations w-full sm:w-56 mb-4",children:[(0,o.jsx)("label",{className:"block text-base text-black dark:text-darkText mb-1",htmlFor:"breakout-room-duration",children:r("breakout-room.duration")}),(0,o.jsx)("input",{className:"w-full block outline-none border border-solid rounded p-1 h-9 dark:text-darkText dark:border-darkText bg-transparent",id:"breakout-room-duration",type:"number",value:p,onChange:e=>h(Number(e.currentTarget.value))})]})]}),(0,o.jsxs)("div",{className:"row flex flex-wrap justify-between items-end",children:[(0,o.jsxs)("div",{className:"room-welcome-messages w-full sm:max-w-[30.5rem] mb-4 sm:mr-10",children:[(0,o.jsx)("label",{className:"block text-base text-black dark:text-darkText mb-1",htmlFor:"breakout-room-welcome",children:r("breakout-room.welcome-msg")}),(0,o.jsx)("textarea",{className:"w-full block outline-none border border-solid rounded p-2 min-h-[60px] dark:text-white/90 dark:border-darkText bg-transparent",id:"breakout-room-welcome",onChange:e=>f(e.currentTarget.value),value:x})]}),(0,o.jsx)("div",{className:"random-room-select mb-4 mr-6",children:(0,o.jsx)("button",{className:"text-base text-primaryColor dark:text-secondaryColor",onClick:()=>{if(!b||!g)return;const e=[...b],t=[...g];t.shift();for(let r=0;r<e.length;r++){const a=Math.floor(Math.random()*t.length);e[r].roomId=t[a].id}y(e)},children:r("breakout-room.random-selection")})})]}),(0,o.jsx)("div",{className:"draggable-room-area overflow-hidden clear-both flex flex-wrap",children:null===g||void 0===g?void 0:g.map((e=>(0,o.jsx)("div",{className:"room-box-wrap w-[calc(50%-6px)] m-[3px] sm:m-0 sm:w-auto",children:(0,o.jsx)(_s,{roomId:e.id,name:e.name,users:b.filter((t=>t.roomId===e.id))})},e.id)))}),(0,o.jsx)("div",{className:"pb-3 pt-4 bg-gray-50 dark:bg-transparent text-right mt-4",children:(0,o.jsx)("button",{className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primaryColor hover:bg-secondaryColor focus:outline-none focus:ring-2 focus:ring-offset-2 focus:bg-secondaryColor",onClick:()=>{const e=[];if(null===g||void 0===g||g.forEach((t=>{if(0!==t.id){const r=b.filter((e=>e.roomId===t.id));if(r.length){const a=new ar({id:`${t.id}`,title:t.name,users:r,duration:BigInt(p),started:!1,created:BigInt(Date.now())});e.push(a)}}})),!e.length)return void(0,l.Am)(r("breakout-room.need-one-user"),{type:"error"});const t=new rr({duration:BigInt(p),welcomeMsg:x,rooms:e});k(t)},children:r("breakout-room.start")})})]})},Es=()=>{const{t:e}=(0,m.$G)(),[t,r]=(0,s.useState)(""),[a,i]=(0,s.useState)(!1),[n,{isLoading:d,data:c}]=gr();(0,s.useEffect)((()=>{i(!!d)}),[d]),(0,s.useEffect)((()=>{c&&(c.status?((0,l.Am)(e("breakout-room.broadcast-msg-success"),{type:"info"}),r("")):(0,l.Am)(e(c.msg),{type:"error"}))}),[c]);return(0,o.jsxs)("div",{className:"broadcasting-message pb-4 mb-4 border-b border-solid border-primaryColor/50 flex flex-wrap items-end",children:[(0,o.jsx)("textarea",{value:t,onChange:e=>r(e.currentTarget.value),className:"w-full sm:w-[calc(100%-12rem)] block outline-none border border-solid border-primaryColor dark:border-darkText rounded p-2 min-h-[60px] bg-transparent dark:text-darkText"}),(0,o.jsx)("button",{onClick:()=>{""!==t&&n(new ir({msg:t}))},disabled:a,className:"inline-flex w-44 sm:ml-4 mt-2 justify-center px-3 py-1 text-sm font-medium text-white bg-primaryColor rounded-md hover:bg-secondaryColor focus:outline-none",children:e("breakout-room.broadcast-msg")})]})};var Rs=r(6141);const Is=({breakoutRoomId:e})=>{const{t}=(0,m.$G)(),[r,{isLoading:a,data:i}]=xr(),[n,d]=(0,s.useState)(!1);(0,s.useEffect)((()=>{d(!!a)}),[a]),(0,s.useEffect)((()=>{i&&(i.status?(0,l.Am)(t("breakout-room.room-ended"),{type:"info"}):(0,l.Am)(t(i.msg),{type:"error"}))}),[i]);return(0,o.jsx)("div",{className:"end-room-btn",children:(0,o.jsx)("button",{className:"text-center py-1 px-3 mt-1 text-xs transition ease-in bg-brandRed hover:bg-brandRed/90 text-white font-semibold rounded-lg",onClick:()=>{r(new lr({breakoutRoomId:e}))},disabled:n,children:t("breakout-room.end-room")})})},As=({users:e})=>{const{t}=(0,m.$G)();return(0,o.jsx)("div",{className:"",children:e.map((e=>(0,o.jsxs)("p",{className:"inline-block pr-2 mr-2 border-r border-solid border-black leading-4 last:border-none last:mr-0 last:pr-0",children:[e.name," (",e.joined?t("breakout-room.user-joined"):t("breakout-room.not-joined"),")"]},e.id)))})},Ps=({duration:e,created:t})=>{const[r,a]=(0,s.useState)("00:00");return(0,s.useEffect)((()=>{const r=1e3*Number(t);let o,s,i;const n=setInterval((()=>{o=60*Number(e)-((Date.now()-r)/1e3|0),s=o/60|0,i=o%60|0,s=s<10?"0"+s:s,i=i<10?"0"+i:i,a(s+":"+i),o<=0&&a("00:00")}),1e3);return()=>{n&&clearInterval(n)}}),[e,t]),(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("div",{className:"timer text-xs md:text-sm border border-solid border-primaryColor dark:border-white dark:text-white sm:py-[2px] px-3 rounded-br-lg -mt-[1px] -ml-[1px]",children:r})})},Fs=({breakoutRoomId:e})=>{const{t}=(0,m.$G)(),[r,a]=(0,s.useState)(!1),[i,n]=(0,s.useState)(""),[d,{isLoading:c,data:u}]=hr();(0,s.useEffect)((()=>{a(!!c)}),[c]),(0,s.useEffect)((()=>{var e;if(!c&&u){if(!u.status)return void(0,l.Am)(t(u.msg),{type:"error"});n(null!==(e=u.token)&&void 0!==e?e:"")}}),[u,c]),(0,s.useEffect)((()=>{if(""!==i){const e=new URLSearchParams(window.location.search);e.set("access_token",i);const r=location.protocol+"//"+location.host+window.location.pathname+"?"+e.toString();window.open(r,"_blank")||(0,l.Am)(t("breakout-room.open-tab-error"),{type:"error"})}}),[i]);return(0,o.jsx)("div",{className:"join-btn mr-4",children:(0,o.jsx)("button",{className:"text-center py-1 px-3 mt-1 text-xs transition ease-in bg-primaryColor hover:bg-secondaryColor text-white font-semibold rounded-lg",onClick:()=>{var t,r;d(new nr({breakoutRoomId:e,userId:null!==(r=null===(t=br.getState().session.currentUser)||void 0===t?void 0:t.userId)&&void 0!==r?r:""}))},disabled:r,children:t("breakout-room.join")})})},Ms=({breakoutRoomId:e})=>{const{t}=(0,m.$G)(),[r,a]=(0,s.useState)(5),[i,n]=(0,s.useState)(!1),[d,{isLoading:c,data:u}]=pr();(0,s.useEffect)((()=>{n(!!c)}),[c]),(0,s.useEffect)((()=>{u&&(u.status?(0,l.Am)(t("breakout-room.duration-extended"),{type:"info"}):(0,l.Am)(t(u.msg),{type:"error"}))}),[u]);return(0,o.jsxs)("div",{className:"extend-time-wrapper flex items-center mr-2 mb-2",children:[(0,o.jsx)("input",{value:r,onChange:e=>a(Number(e.currentTarget.value)),placeholder:t("breakout-room.extend-duration").toString(),className:"w-full max-w-[100px] sm:max-w-[140px] block outline-none border border-solid border-secondaryColor rounded py-1 px-2 h-9 bg-transparent dark:text-darkText dark:border-darkText"}),(0,o.jsx)("button",{onClick:()=>{d(new sr({breakoutRoomId:e,duration:BigInt(r)}))},disabled:i,className:"ml-2 sm:ml-4 w-[180px] text-center py-1 px-3 h-8 text-xs transition ease-in bg-primaryColor hover:bg-secondaryColor text-white font-semibold rounded-lg",children:t("breakout-room.extend-duration")})]})},Os=()=>{const{t:e}=(0,m.$G)(),{data:t,isLoading:r}=ur(void 0,{pollingInterval:1e4}),a=(0,s.useMemo)((()=>{if(t&&t.rooms){const e=t.rooms.slice();return e.sort(((e,t)=>t.title.localeCompare(e.title))),e}}),[t]),i=t=>(0,o.jsx)(Rs.p,{children:({open:r})=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(Rs.p.Button,{className:"flex items-center w-full justify-between rounded-lg transition ease-in bg-secondaryColor px-4 py-2 text-left text-sm font-medium text-white hover:bg-primaryColor outline-none",children:[(0,o.jsx)("p",{children:t.title}),(0,o.jsxs)("div",{className:"flex items-center",children:[t.started?(0,o.jsx)(Ps,{duration:t.duration,created:t.created}):e("breakout-room.not-started"),(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:(r?"rotate-180 transform":"")+" h-5 w-5 ml-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]})]}),(0,o.jsxs)(Rs.p.Panel,{className:"sm:px-4 py-6 text-sm text-gray-500 dark:text-darkText",children:[(0,o.jsxs)("div",{className:"row flex flex-wrap items-center justify-between mb-4",children:[(0,o.jsx)(Ms,{breakoutRoomId:t.id}),(0,o.jsxs)("div",{className:"row flex mb-2",children:[(0,o.jsx)(Fs,{breakoutRoomId:t.id}),(0,o.jsx)(Is,{breakoutRoomId:t.id})]})]}),(0,o.jsx)(As,{users:t.users})]})]})});return(0,o.jsxs)("div",{className:"breakout-room-list-wrapper min-h-[90px] relative",children:[r?(0,o.jsx)("div",{className:"loading absolute text-center top-1/2 -translate-y-1/2 z-[999] left-0 right-0 m-auto",children:(0,o.jsxs)("div",{className:"lds-ripple",children:[(0,o.jsx)("div",{className:"border-secondaryColor"}),(0,o.jsx)("div",{className:"border-secondaryColor"})]})}):null,null===a||void 0===a?void 0:a.map((e=>(0,o.jsx)("div",{className:"breakout-room-list-item my-1",children:i(e)},e.id)))]})},Ds=()=>{const{t:e}=(0,m.$G)(),t=yr(),[r,a]=(0,s.useState)(!1),[i,{isLoading:n,data:d}]=fr();(0,s.useEffect)((()=>{a(!!n)}),[n]),(0,s.useEffect)((()=>{d&&(d.status?((0,l.Am)(e("breakout-room.end-all-success"),{type:"info"}),t(ke(!1))):(0,l.Am)(e(d.msg),{type:"error"}))}),[d]);return(0,o.jsxs)("div",{className:"manage-breakout-room-wrap",children:[(0,o.jsx)(Es,{}),(0,o.jsx)(Os,{}),(0,o.jsx)("div",{className:"btn pb-3 pt-4 bg-gray-50 dark:bg-transparent flex items-end justify-end",children:(0,o.jsx)("button",{className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primaryColor hover:bg-secondaryColor focus:outline-none focus:ring-2 focus:ring-offset-2 focus:bg-secondaryColor",onClick:()=>{i()},disabled:r,children:e("breakout-room.end-all")})})]})},Ls=()=>{var e;const{t}=(0,m.$G)(),r=yr(),a=null===(e=br.getState().session.currentRoom.metadata)||void 0===e?void 0:e.room_features.breakout_room_features.is_active,[i,n]=(0,s.useState)(!0);return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(Sr.u,{appear:!0,show:i,as:s.Fragment,children:(0,o.jsx)(_r.V,{as:"div",className:"fixed inset-0 z-[9999] overflow-y-auto",onClose:()=>!1,static:!1,children:(0,o.jsxs)("div",{className:"min-h-screen px-4 text-center flex items-center justify-center",children:[(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,o.jsx)(_r.V.Overlay,{className:"fixed inset-0 bg-black opacity-30"})}),(0,o.jsx)("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"\u200b"}),(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,o.jsxs)("div",{className:"inline-block w-full max-w-5xl h-full p-4 md:p-6 my-16 overflow-hidden text-left transition-all transform bg-white dark:bg-darkPrimary shadow-xl rounded-2xl",children:[(0,o.jsxs)("button",{className:"close-btn absolute top-8 right-6 w-[25px] h-[25px] outline-none",type:"button",onClick:()=>(n(!1),void r(ke(!1))),children:[(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 rotate-45"}),(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 -rotate-45"})]}),(0,o.jsx)(_r.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-white text-left mb-2",children:t("breakout-room.modal-title")}),(0,o.jsx)("hr",{}),(0,o.jsx)("div",{className:"mt-2",children:a?(0,o.jsx)(Ds,{}):(0,o.jsx)(Cs,{})})]})})]})})})})},Bs=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_features.display_external_link_features.is_active}),(e=>e)),Us=()=>{const e=yr(),{t}=(0,m.$G)(),r=kr(Bs),[a,i]=(0,s.useState)(""),[n,d]=(0,s.useState)(),[c,u]=(0,s.useState)({name:!1,userId:!1,role:!1,meetingId:!1});return(0,o.jsx)(o.Fragment,{children:r?null:(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(Sr.u,{appear:!0,show:!r,as:s.Fragment,children:(0,o.jsx)(_r.V,{as:"div",className:"fixed inset-0 z-[9999] overflow-y-auto",onClose:()=>!1,children:(0,o.jsxs)("div",{className:"min-h-screen px-4 text-center",children:[(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,o.jsx)(_r.V.Overlay,{className:"fixed inset-0 bg-black opacity-30"})}),(0,o.jsx)("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"\u200b"}),(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,o.jsxs)("div",{className:"inline-block w-full max-w-2xl p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white dark:bg-darkPrimary shadow-xl rounded-2xl",children:[(0,o.jsxs)("button",{className:"close-btn absolute top-8 right-6 w-[25px] h-[25px] outline-none",type:"button",onClick:()=>{e(we(!1))},children:[(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 rotate-45"}),(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 -rotate-45"})]}),(0,o.jsx)(_r.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-white text-left mb-2",children:t("external-display-link-display.modal-title")}),(0,o.jsx)("hr",{}),(0,o.jsx)("div",{className:"mt-6",children:(0,o.jsxs)("form",{method:"POST",onSubmit:r=>(async r=>{var o,s,i,n,u,m;let p;r.preventDefault(),d(void 0);try{p=new URL(a)}catch(b){return void d(t("external-display-link-display.link-invalid").toString())}const h=br.getState().session;c.name&&p.searchParams.set("name",null!==(s=null===(o=h.currentUser)||void 0===o?void 0:o.name)&&void 0!==s?s:""),c.userId&&p.searchParams.set("userId",null!==(n=null===(i=h.currentUser)||void 0===i?void 0:i.userId)&&void 0!==n?n:""),c.role&&p.searchParams.set("role",(null===(m=null===(u=h.currentUser)||void 0===u?void 0:u.metadata)||void 0===m?void 0:m.is_admin)?"admin":"participant"),c.meetingId&&p.searchParams.set("meetingId",h.currentRoom.room_id);const x=l.Am.loading(t("please-wait"),{type:"info"}),f=new eo({task:Ba.START_EXTERNAL_LINK,url:p.toString()}),g=await co("externalDisplayLink",f.toBinary(),!1,"application/protobuf","arraybuffer"),v=Va.fromBinary(new Uint8Array(g));v.status||l.Am.update(x,{render:t(v.msg),type:"error",isLoading:!1,autoClose:1e3}),l.Am.dismiss(x),e(we(!1))})(r),children:[(0,o.jsxs)("div",{className:"",children:[(0,o.jsx)("label",{htmlFor:"stream-key",className:"block text-sm font-medium text-gray-700 dark:text-darkText",children:t("external-display-link-display.url")}),(0,o.jsx)("input",{type:"text",name:"stream-key",id:"stream-key",value:a,onChange:e=>i(e.currentTarget.value),className:"mt-1 px-4 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm rounded-md h-10 border border-solid border-black/50 dark:border-darkText bg-transparent dark:text-darkText"}),n?(0,o.jsx)("div",{className:"error-msg text-xs text-red-600 py-2",children:n}):null,(0,o.jsx)("div",{className:"text-xs py-2 dark:text-darkText",children:t("external-display-link-display.note")})]}),(0,o.jsx)("div",{className:"mt-4",children:(0,o.jsxs)("fieldset",{children:[(0,o.jsx)("div",{className:"text-base font-medium text-gray-900 dark:text-white","aria-hidden":"true",children:t("external-display-link-display.send-extra-values")}),(0,o.jsxs)("div",{className:"mt-4 flex flex-wrap justify-between",children:[(0,o.jsxs)("div",{className:"w-1/2 md:w-1/4 mb-4",children:[(0,o.jsx)("div",{className:"flex items-center w-full justify-center mb-2",children:(0,o.jsx)("input",{id:"name",name:"name",type:"checkbox",checked:c.name,onChange:()=>{const e=Object.assign({},c);e.name=!c.name,u(e)},className:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded"})}),(0,o.jsxs)("div",{className:"text-sm w-full text-center",children:[(0,o.jsx)("label",{htmlFor:"name",className:"font-medium text-gray-700 dark:text-darkText",children:t("external-display-link-display.name")}),(0,o.jsx)("p",{className:"text-gray-500 dark:text-darkText/60",children:t("external-display-link-display.name-des")})]})]}),(0,o.jsxs)("div",{className:"w-1/2 md:w-1/4 mb-4",children:[(0,o.jsx)("div",{className:"flex items-center w-full justify-center mb-2",children:(0,o.jsx)("input",{id:"user-id",name:"user-id",type:"checkbox",checked:c.userId,onChange:()=>{const e=Object.assign({},c);e.userId=!c.userId,u(e)},className:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded"})}),(0,o.jsxs)("div",{className:"text-sm w-full text-center",children:[(0,o.jsx)("label",{htmlFor:"user-id",className:"font-medium text-gray-700 dark:text-darkText",children:t("external-display-link-display.user-id")}),(0,o.jsx)("p",{className:"text-gray-500 dark:text-darkText/60",children:t("external-display-link-display.user-id-des")})]})]}),(0,o.jsxs)("div",{className:"w-1/2 md:w-1/4 mb-4",children:[(0,o.jsx)("div",{className:"flex items-center w-full justify-center mb-2",children:(0,o.jsx)("input",{id:"user-role",name:"user-role",type:"checkbox",checked:c.role,onChange:()=>{const e=Object.assign({},c);e.role=!c.role,u(e)},className:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded"})}),(0,o.jsxs)("div",{className:"text-sm w-full text-center",children:[(0,o.jsx)("label",{htmlFor:"user-role",className:"font-medium text-gray-700 dark:text-darkText",children:t("external-display-link-display.user-role")}),(0,o.jsx)("p",{className:"text-gray-500 dark:text-darkText/60",children:t("external-display-link-display.user-role-des")})]})]}),(0,o.jsxs)("div",{className:"w-1/2 md:w-1/4 mb-4",children:[(0,o.jsx)("div",{className:"flex items-center w-full justify-center mb-2",children:(0,o.jsx)("input",{id:"meeting-id",name:"meeting-id",type:"checkbox",checked:c.meetingId,onChange:()=>{const e=Object.assign({},c);e.meetingId=!c.meetingId,u(e)},className:"focus:ring-indigo-500 h-4 w-4 text-indigo-600 border-gray-300 rounded"})}),(0,o.jsxs)("div",{className:"text-sm w-full text-center",children:[(0,o.jsx)("label",{htmlFor:"meeting-id",className:"font-medium text-gray-700 dark:text-darkText",children:t("external-display-link-display.meeting-id")}),(0,o.jsx)("p",{className:"text-gray-500 dark:text-darkText/60",children:t("external-display-link-display.meeting-id-des")})]})]})]})]})}),(0,o.jsx)("div",{className:"pb-3 pt-4 bg-gray-50 dark:bg-transparent text-right mt-4",children:(0,o.jsx)("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primaryColor hover:bg-secondaryColor focus:outline-none focus:ring-2 focus:ring-offset-2 focus:bg-secondaryColor",children:t("external-display-link-display.display")})})]})})]})})]})})})})})},Ws=(0,wr.P1)((e=>e.bottomIconsActivity.showLockSettingsModal),(e=>e)),Gs=(0,wr.P1)((e=>e.session.isActiveRtmpBroadcasting),(e=>e)),Js=(0,wr.P1)((e=>e.bottomIconsActivity.showRtmpModal),(e=>e)),Vs=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_features.shared_note_pad_features.is_active}),(e=>e)),Hs=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_features.external_media_player_features.is_active}),(e=>e)),qs=(0,wr.P1)((e=>e.bottomIconsActivity.showExternalMediaPlayerModal),(e=>e)),$s=(0,wr.P1)((e=>e.bottomIconsActivity.showManageWaitingRoomModal),(e=>e)),zs=(0,wr.P1)((e=>e.bottomIconsActivity.showManageBreakoutRoomModal),(e=>e)),Qs=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_features.display_external_link_features.is_active}),(e=>e)),Ys=(0,wr.P1)((e=>e.bottomIconsActivity.showDisplayExternalLinkModal),(e=>e)),Xs=()=>{var e,t;const r=br.getState().session,a=yr(),{t:s}=(0,m.$G)(),i=kr(Ws),n=kr(Vs),d=kr(Js),c=kr(Gs),u=kr(Hs),p=kr(qs),h=kr($s),x=kr(zs),f=kr(Qs),g=kr(Ys),v=null===(t=null===(e=br.getState().session.currentRoom)||void 0===e?void 0:e.metadata)||void 0===t?void 0:t.room_features;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"menu relative z-10",children:(0,o.jsx)(ia.v,{children:({open:e})=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ia.v.Button,{className:"footer-icon h-[35px] lg:h-[40px] w-[35px] lg:w-[40px] rounded-full bg-[#F2F2F2] dark:bg-darkSecondary2 hover:bg-[#ECF4FF] flex items-center justify-center cursor-pointer",children:(0,o.jsx)("i",{className:"pnm-menu-horizontal primaryColor dark:text-darkText text-[5px] lg:text-[5px]"})}),(0,o.jsx)(Sr.u,{show:e,enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:(0,o.jsxs)(ia.v.Items,{static:!0,className:"origin-bottom-left sm:-left-20 right-0 sm:right-auto z-[9999] absolute mt-2 w-60 bottom-[48px] rounded-md shadow-lg bg-white dark:bg-darkPrimary ring-1 ring-black dark:ring-secondaryColor ring-opacity-5 divide-y divide-gray-100 dark:divide-secondaryColor focus:outline-none",children:[(null===v||void 0===v?void 0:v.allow_rtmp)?(0,o.jsx)("div",{className:"py-1",role:"none",children:(0,o.jsx)(ia.v.Item,{children:(0,o.jsxs)("button",{className:"footer-podcast-button text-gray-700 dark:text-darkText rounded group flex items-center py-1 lg:py-2 px-4 text-xs lg:text-sm text-left w-full transition ease-in hover:text-secondaryColor hover:dark:text-secondaryColor",onClick:()=>{a(be(!0))},children:[c?(0,o.jsxs)("div",{className:"lds-ripple",children:[(0,o.jsx)("div",{className:"border-secondaryColor"}),(0,o.jsx)("div",{className:"border-secondaryColor"})]}):null,(0,o.jsx)("i",{className:"pnm-broadcasting text-primaryColor mr-2 transition ease-in group-hover:text-secondaryColor"}),s(c?"footer.icons.stop-rtmp-broadcasting":"footer.icons.start-rtmp-broadcasting")]})})}):null,(0,o.jsx)("div",{className:"py-1",role:"none",children:(0,o.jsx)(ia.v.Item,{children:(0,o.jsxs)("button",{className:"text-gray-700 dark:text-darkText rounded group flex items-center py-1 lg:py-2 px-4 text-xs lg:text-sm text-left w-full transition ease-in hover:text-secondaryColor hover:dark:text-secondaryColor",onClick:()=>(async()=>{const e=new $a({sid:r.currentRoom.sid,roomId:r.currentRoom.room_id,userId:"all",muted:!0}),t=await co("muteUnmuteTrack",e.toBinary(),!1,"application/protobuf","arraybuffer"),a=Va.fromBinary(new Uint8Array(t));a.status?(0,l.Am)(s("footer.notice.muted-all-microphone"),{toastId:"asked-status",type:"info"}):(0,l.Am)(s(a.msg),{toastId:"asked-status",type:"error"})})(),children:[(0,o.jsx)("i",{className:"pnm-mic-mute text-primaryColor mr-2 transition ease-in group-hover:text-secondaryColor"}),s("footer.menus.mute-all-users")]})})}),(null===v||void 0===v?void 0:v.shared_note_pad_features.allowed_shared_note_pad)?(0,o.jsx)("div",{className:"py-1",role:"none",children:(0,o.jsx)(ia.v.Item,{children:(0,o.jsxs)("button",{className:"text-gray-700 dark:text-darkText rounded group flex items-center py-1 lg:py-2 px-4 text-xs lg:text-sm text-left w-full transition ease-in hover:text-secondaryColor hover:dark:text-secondaryColor",onClick:()=>(async()=>{var e;const t=null===(e=br.getState().session.currentRoom.metadata)||void 0===e?void 0:e.room_features.shared_note_pad_features.host;if(t||n){if(t&&!n){const e=new ao({roomId:br.getState().session.currentRoom.room_id,isActive:!0}),t=await co("etherpad/changeStatus",e.toBinary(),!1,"application/protobuf","arraybuffer"),r=to.fromBinary(new Uint8Array(t));r.status?a(pe(!0)):(0,l.Am)(s(r.msg),{type:"error"})}else if(t&&n){const e=new ao({roomId:br.getState().session.currentRoom.room_id,isActive:!1}),t=await co("etherpad/changeStatus",e.toBinary(),!1,"application/protobuf","arraybuffer"),r=to.fromBinary(new Uint8Array(t));r.status?a(pe(!1)):(0,l.Am)(s(r.msg),{type:"error"})}}else{const e=await co("etherpad/create",{},!1,"application/protobuf","arraybuffer"),t=to.fromBinary(new Uint8Array(e));t.status?a(pe(!0)):(0,l.Am)(s(t.msg),{type:"error"})}})(),children:[(0,o.jsx)("i",{className:"pnm-notepad text-primaryColor mr-2 transition ease-in group-hover:text-secondaryColor"}),s(n?"footer.menus.disable-shared-notepad":"footer.menus.enable-shared-notepad")]})})}):null,(null===v||void 0===v?void 0:v.external_media_player_features.allowed_external_media_player)?(0,o.jsx)("div",{className:"py-1",role:"none",children:(0,o.jsx)(ia.v.Item,{children:(0,o.jsxs)("button",{className:"text-gray-700 dark:text-darkText rounded group flex items-center py-1 lg:py-2 px-4 text-xs lg:text-sm text-left w-full transition ease-in hover:text-secondaryColor hover:dark:text-secondaryColor",onClick:()=>(async()=>{if(!u)return void(f?(0,l.Am)(s("notifications.need-to-disable-display-external-link"),{type:"error"}):a(ye(!0)));const e=l.Am.loading(s("please-wait"),{type:"info"}),t=new Za({task:La.END_PLAYBACK}),r=await co("externalMediaPlayer",t.toBinary(),!1,"application/protobuf","arraybuffer"),o=Va.fromBinary(new Uint8Array(r));o.status?l.Am.dismiss(e):l.Am.update(e,{render:s(o.msg),type:"error",isLoading:!1,autoClose:3e3})})(),children:[(0,o.jsx)("i",{className:"pnm-file-play text-primaryColor mr-2 transition ease-in group-hover:text-secondaryColor"}),s(u?"footer.menus.stop-external-media-player":"footer.menus.start-external-media-player")]})})}):null,(null===v||void 0===v?void 0:v.display_external_link_features.is_allow)?(0,o.jsx)("div",{className:"py-1",role:"none",children:(0,o.jsx)(ia.v.Item,{children:(0,o.jsxs)("button",{className:"text-gray-700 dark:text-darkText rounded group flex items-center py-1 lg:py-2 px-4 text-xs lg:text-sm text-left w-full transition ease-in hover:text-secondaryColor hover:dark:text-secondaryColor",onClick:()=>(async()=>{if(!f)return void(u?(0,l.Am)(s("notifications.need-to-disable-external-media-player"),{type:"error"}):a(we(!0)));const e=new eo({task:Ba.STOP_EXTERNAL_LINK}),t=l.Am.loading(s("please-wait"),{type:"info"}),r=await co("externalDisplayLink",e.toBinary(),!1,"application/protobuf","arraybuffer"),o=Va.fromBinary(new Uint8Array(r));o.status?l.Am.dismiss(t):l.Am.update(t,{render:s(o.msg),type:"error",isLoading:!1,autoClose:3e3})})(),children:[(0,o.jsx)("i",{className:"pnm-display text-primaryColor mr-2 transition ease-in group-hover:text-secondaryColor"}),s(f?"footer.menus.stop-display-external-link":"footer.menus.start-display-external-link")]})})}):null,(null===v||void 0===v?void 0:v.waiting_room_features.is_active)?(0,o.jsx)("div",{className:"py-1",role:"none",children:(0,o.jsx)(ia.v.Item,{children:(0,o.jsxs)("button",{className:"text-gray-700 dark:text-darkText rounded group flex items-center py-1 lg:py-2 px-4 text-xs lg:text-sm text-left w-full transition ease-in hover:text-secondaryColor hover:dark:text-secondaryColor",onClick:()=>{a(ve(!0))},children:[(0,o.jsx)("i",{className:"pnm-waiting-room text-primaryColor mr-2 transition ease-in group-hover:text-secondaryColor"}),s("footer.menus.manage-waiting-room")]})})}):null,(null===v||void 0===v?void 0:v.breakout_room_features.is_allow)?(0,o.jsx)("div",{className:"py-1",role:"none",children:(0,o.jsx)(ia.v.Item,{children:(0,o.jsxs)("button",{className:"text-gray-700 dark:text-darkText rounded group flex items-center py-1 lg:py-2 px-4 text-xs lg:text-sm text-left w-full transition ease-in hover:text-secondaryColor hover:dark:text-secondaryColor",onClick:()=>{a(ke(!0))},children:[(0,o.jsx)("i",{className:"pnm-breakout-room text-primaryColor mr-2 transition ease-in group-hover:text-secondaryColor"}),s("footer.menus.manage-breakout-room")]})})}):null,(0,o.jsx)("div",{className:"py-1",role:"none",children:(0,o.jsx)(ia.v.Item,{children:(0,o.jsxs)("button",{className:"text-gray-700 dark:text-darkText rounded group flex items-center py-1 lg:py-2 px-4 text-xs lg:text-sm text-left w-full transition ease-in hover:text-secondaryColor hover:dark:text-secondaryColor",onClick:()=>{a(ge(!0))},children:[(0,o.jsx)("i",{className:"pnm-lock text-primaryColor mr-2 transition ease-in group-hover:text-secondaryColor"}),s("footer.menus.room-lock-settings")]})})})]})})]})})}),i?(0,o.jsx)(os,{}):null,d?(0,o.jsx)(ns,{}):null,p?(0,o.jsx)(xs,{}):null,h?(0,o.jsx)(ys,{}):null,x?(0,o.jsx)(Ls,{}):null,g?(0,o.jsx)(Us,{}):null]})},Ks=(0,wr.P1)((e=>e.bottomIconsActivity.isActiveSharedNotePad),(e=>e)),Zs=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_features.shared_note_pad_features.is_active}),(e=>e)),ei=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_features.shared_note_pad_features.visible}),(e=>e)),ti=()=>{var e,t,r;const{t:a}=(0,m.$G)(),i=yr(),n="desktop"===br.getState().session.userDeviceType,[l,d]=(0,s.useState)("primaryColor"),c=kr(Ks),u=kr(Zs),p=kr(ei),[h,x]=(0,s.useState)(!1),f=null===(t=null===(e=br.getState().session.currentUser)||void 0===e?void 0:e.metadata)||void 0===t?void 0:t.is_admin,g=null===(r=br.getState().session.currentUser)||void 0===r?void 0:r.isRecorder;(0,s.useEffect)((()=>{i(pe(!!u))}),[u,i]),(0,s.useEffect)((()=>{c?(d("secondaryColor"),br.getState().bottomIconsActivity.isActiveWhiteboard&&i(he(!1)),g||i(le(!1))):d("primaryColor dark:text-darkText")}),[c,i]),(0,s.useEffect)((()=>{u&&i(pe(!!p))}),[p]),(0,s.useEffect)((()=>{var e,t,r;if(!f||g)return;const a=br.getState().session.currentRoom;if(!h&&(null===(e=a.metadata)||void 0===e?void 0:e.room_features.shared_note_pad_features.visible))return void x(!0);h||x(!0);const o=async e=>{await co("changeVisibility",e.toBinary(),!1,"application/protobuf")};if(c&&!(null===(t=a.metadata)||void 0===t?void 0:t.room_features.shared_note_pad_features.visible)){const e=new Xa({roomId:a.room_id,visibleWhiteBoard:!1,visibleNotepad:!0});setTimeout((()=>{o(e)}),500)}else if(!c&&(null===(r=a.metadata)||void 0===r?void 0:r.room_features.shared_note_pad_features.visible)){const e=new Xa({roomId:a.room_id,visibleNotepad:!1});o(e)}}),[c]);return(0,o.jsx)(o.Fragment,{children:u?(0,o.jsxs)("div",{className:"shared-notepad h-[35px] lg:h-[40px] w-[35px] lg:w-[40px] relative rounded-full bg-[#F2F2F2] dark:bg-darkSecondary2 hover:bg-[#ECF4FF] mr-3 lg:mr-6 flex items-center justify-center cursor-pointer "+(n?"has-tooltip":""),onClick:()=>(async()=>{br.getState().bottomIconsActivity.isActiveScreenshare||i(pe(!c))})(),children:[(0,o.jsx)("span",{className:"tooltip",children:a(c?"footer.icons.hide-shared-notepad":"footer.icons.show-shared-notepad")}),(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("i",{className:`pnm-notepad ${l} text-[14px] lg:text-[16px]`})})]}):null})},ri=(0,wr.P1)((e=>e.bottomIconsActivity.isActiveWhiteboard),(e=>e)),ai=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_features.whiteboard_features.visible}),(e=>e)),oi=()=>{var e,t,r,a;const{t:i}=(0,m.$G)(),n=yr(),l="desktop"===br.getState().session.userDeviceType,[d,c]=(0,s.useState)("primaryColor"),[u,p]=(0,s.useState)(!1),h=kr(ri),x=kr(ai),f=null===(e=br.getState().session.currentRoom.metadata)||void 0===e?void 0:e.room_features.whiteboard_features.allowed_whiteboard,g=null===(r=null===(t=br.getState().session.currentUser)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.is_admin,v=null===(a=br.getState().session.currentUser)||void 0===a?void 0:a.isRecorder;(0,s.useEffect)((()=>{h?(c("secondaryColor"),br.getState().bottomIconsActivity.isActiveSharedNotePad&&n(pe(!1)),v||n(le(!1))):c("primaryColor dark:text-darkText")}),[n,h]),(0,s.useEffect)((()=>{f&&(x?n(he(!0)):x||n(he(!1)))}),[x]),(0,s.useEffect)((()=>{var e,t,r;if(!g||v)return;const a=br.getState().session.currentRoom;if(!u&&(null===(e=a.metadata)||void 0===e?void 0:e.room_features.whiteboard_features.visible))return void p(!0);u||p(!0);const o=async e=>{await co("changeVisibility",e.toBinary(),!1,"application/protobuf")};if(h&&!(null===(t=a.metadata)||void 0===t?void 0:t.room_features.whiteboard_features.visible)){const e=new Xa({roomId:a.room_id,visibleWhiteBoard:!0,visibleNotepad:!1});setTimeout((()=>{o(e)}),500)}else if(!h&&(null===(r=a.metadata)||void 0===r?void 0:r.room_features.whiteboard_features.visible)){const e=new Xa({roomId:a.room_id,visibleWhiteBoard:!1});o(e)}}),[h]);return(0,o.jsx)(o.Fragment,{children:f?(0,o.jsxs)("div",{className:"whiteboard h-[35px] lg:h-[40px] w-[35px] lg:w-[40px] relative rounded-full bg-[#F2F2F2] dark:bg-darkSecondary2 hover:bg-[#ECF4FF] mr-3 lg:mr-6 flex items-center justify-center cursor-pointer "+(l?"has-tooltip":""),onClick:()=>(async()=>{br.getState().bottomIconsActivity.isActiveScreenshare||n(he(!h))})(),children:[(0,o.jsx)("span",{className:"tooltip",children:i(h?"footer.icons.hide-whiteboard":"footer.icons.show-whiteboard")}),(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("i",{className:`pnm-whiteboard ${d} text-[14px] lg:text-[16px]`})})]}):null})};var si=r(8206);const ii=(0,wr.P1)((e=>e.breakoutRoom.receivedInvitationFor),(e=>e)),ni=s.memo((({currentRoom:e})=>{const{t}=(0,m.$G)(),r=yr(),a=kr(ii),[i,{isLoading:n,data:d}]=hr(),[c,u]=(0,s.useState)(""),[p,h]=(0,s.useState)(t("breakout-room.copy").toString()),[x,f]=(0,s.useState)(""),g=(0,s.useCallback)((()=>{e.localParticipant.tracks.forEach((async t=>{t.track&&(t.track.source===Be.fQ.Source.Camera?(e.localParticipant.unpublishTrack(t.track,!0),r(ne(!1)),r(He("")),r(Ne({type:"none"}))):t.track.source===Be.fQ.Source.Microphone&&(t.isMuted||(await t.track.unmute(),r(ie(!0)))))}))}),[e.localParticipant,r]);(0,s.useEffect)((()=>{var e;if(!n&&d){if(!d.status)return void(0,l.Am)(t(d.msg),{type:"error"});f(null!==(e=d.token)&&void 0!==e?e:"")}}),[n,d]),(0,s.useEffect)((()=>{if(""!==x){const e=new URLSearchParams(window.location.search);e.set("access_token",x);const t=location.protocol+"//"+location.host+window.location.pathname+"?"+e.toString(),a=window.open(t,"_blank");if(u(t),!a)return void u(t);r(er("")),g()}}),[x]);const v=()=>{i(new nr({breakoutRoomId:a,userId:e.localParticipant.identity}))},b=()=>{(0,si.Z)(c),h(t("breakout-room.copied").toString())};return""!==a?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(Sr.u,{appear:!0,show:""!==a,as:s.Fragment,children:(0,o.jsx)(_r.V,{as:"div",className:"fixed inset-0 z-[9999] overflow-y-auto",onClose:()=>!1,static:!1,children:(0,o.jsxs)("div",{className:"min-h-screen px-4 text-center flex items-end justify-end",children:[(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,o.jsx)(_r.V.Overlay,{className:"fixed inset-0 bg-black opacity-30"})}),(0,o.jsx)("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"\u200b"}),(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,o.jsxs)("div",{className:"inline-block w-max h-full p-6 my-4 overflow-hidden text-left align-middle transition-all transform bg-white dark:bg-darkPrimary shadow-xl rounded-lg",children:[(0,o.jsxs)("button",{className:"close-btn absolute top-8 right-6 w-[25px] h-[25px] outline-none",type:"button",onClick:()=>(r(er("")),void g()),children:[(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 rotate-45"}),(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 -rotate-45"})]}),(0,o.jsx)(_r.V.Title,{as:"h3",className:"text-base font-medium leading-6 text-gray-900 dark:text-darkText text-left mb-2",children:t("breakout-room.invitation-title")}),(0,o.jsx)("hr",{}),(0,o.jsxs)("div",{className:"mt-2",children:[(0,o.jsx)("span",{className:"text-black dark:text-darkText text-sm",children:t("breakout-room.invitation-msg")}),""!==c?(0,o.jsxs)("div",{className:"invite-link",children:[(0,o.jsx)("label",{className:"text-black dark:text-darkText text-sm",children:t("breakout-room.join-text-label")}),(0,o.jsx)("input",{type:"text",readOnly:!0,value:c,className:"inline-block outline-none border border-solid rounded p-1 h-7 text-sm mx-1 bg-transparent dark:text-darkText dark:border-darkText"}),(0,o.jsx)("button",{onClick:b,className:"text-center py-1 px-3 text-xs transition ease-in bg-primaryColor hover:bg-secondaryColor text-white font-semibold rounded-lg",children:p})]}):null,(0,o.jsx)("div",{className:"button-section flex items-center justify-start",children:(0,o.jsx)("button",{className:"text-center py-1 px-3 mt-1 text-xs transition ease-in bg-primaryColor hover:bg-secondaryColor text-white font-semibold rounded-lg",onClick:v,children:t("breakout-room.join")})})]})]})})]})})})}):null})),li=(0,wr.P1)((e=>e.roomSettings.visibleFooter),(e=>e)),di=({currentRoom:e,isRecorder:t})=>{var r,a;const i=null===(a=null===(r=br.getState().session.currentUser)||void 0===r?void 0:r.metadata)||void 0===a?void 0:a.is_admin,n=kr(li),l=yr(),{t:d}=(0,m.$G)();return(0,s.useMemo)((()=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(Sr.u,{show:n,unmount:!1,enter:"transform duration-200 transition ease-in",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transform duration-200 transition ease-in",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,o.jsx)("footer",{id:"main-footer",className:"px-2 md:px-4 shadow-footer flex items-center justify-between dark:bg-darkPrimary h-[55px] lg:h-[60px]",style:{display:t?"none":""},children:(0,o.jsxs)("div",{className:"footer-inner flex items-center justify-between w-full",children:[(0,o.jsxs)("div",{className:"footer-left w-52 flex items-center",children:[(0,o.jsx)(fa,{currentRoom:e}),(0,o.jsx)(Ca,{currentRoom:e})]}),(0,o.jsxs)("div",{className:"footer-middle flex items-center",children:[(0,o.jsx)(Fa,{}),(0,o.jsx)(Ia,{}),(0,o.jsx)(go,{currentRoom:e}),(0,o.jsx)(po,{currentRoom:e}),(0,o.jsx)(oi,{}),(0,o.jsx)(ti,{}),(0,o.jsx)(ts,{currentRoom:e}),i?(0,o.jsx)(Xs,{}):null]}),(0,o.jsx)("div",{className:"footer-right w-52 hidden sm:flex items-center"}),(0,o.jsx)(ni,{currentRoom:e})]})})}),t?null:(0,o.jsxs)("div",{className:"footer-collapse-arrow group fixed right-0 flex items-end justify-center h-5 w-[50px] cursor-pointer z-[1] bg-white dark:bg-darkPrimary rounded-tl-lg "+(n?"bottom-[60px] pb-[3px]":"bottom-0 pb-[6px]"),onClick:()=>l(ct()),children:[(0,o.jsx)("i",{className:" text-[10px] sm:text-[12px] dark:text-secondaryColor pnm-arrow-below "+(n?"":"rotate-180")}),(0,o.jsx)("span",{className:"absolute right-0 bottom-7 w-max text-darkPrimary dark:text-white bg-white dark:bg-darkPrimary text-[12px] py-1 px-[10px] rounded opacity-0 invisible transition-all group-hover:opacity-100 group-hover:visible",children:d(n?"footer.hide-footer":"footer.show-footer")})]})]})),[e,n])},ci=s.memo((({onOpenAlert:e})=>{var t,r;const a=null===(r=null===(t=br.getState().session.currentUser)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.is_admin,s=yr(),{t:i}=(0,m.$G)();return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(ia.v.Items,{static:!0,className:"origin-top-right z-10 absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white dark:bg-darkPrimary ring-1 ring-black dark:ring-secondaryColor ring-opacity-5 divide-y divide-gray-100 focus:outline-none",children:[(0,o.jsx)("div",{className:"py-1",role:"none",children:(0,o.jsx)(ia.v.Item,{children:(0,o.jsxs)("button",{className:"text-gray-700 dark:text-darkText rounded group flex items-center py-2 px-4 text-sm text-left w-full transition ease-in hover:text-secondaryColor",onClick:()=>{s($e(!0))},children:[(0,o.jsx)("i",{className:"pnm-settings text-primaryColor dark:text-secondaryColor mr-2 transition ease-in group-hover:text-secondaryColor dark:group-hover:text-white"}),i("header.menus.settings")]})})}),(0,o.jsx)("div",{className:"py-1",role:"none",children:(0,o.jsx)(ia.v.Item,{children:(0,o.jsxs)("button",{className:"text-gray-700 dark:text-darkText rounded group flex items-center py-2 px-4 text-sm text-left w-full transition ease-in hover:text-secondaryColor",onClick:()=>{s(Xe(!0))},children:[(0,o.jsx)("i",{className:"pnm-keyboard text-primaryColor dark:text-secondaryColor mr-2 transition ease-in group-hover:text-secondaryColor dark:group-hover:text-white"}),i("header.menus.keyboard-shortcuts")]})})}),(0,o.jsx)("div",{className:"py-1",role:"none",children:(0,o.jsx)(ia.v.Item,{children:(0,o.jsxs)("button",{className:"text-gray-700 dark:text-darkText rounded group flex items-center py-2 px-4 text-sm text-left w-full transition ease-in hover:text-secondaryColor",onClick:()=>{e("logout")},children:[(0,o.jsx)("i",{className:"pnm-logout text-primaryColor dark:text-secondaryColor mr-2 transition ease-in group-hover:text-secondaryColor dark:group-hover:text-white"}),i("header.menus.logout")]})})}),a?(0,o.jsx)("div",{className:"py-1",role:"none",children:(0,o.jsx)(ia.v.Item,{children:(0,o.jsxs)("button",{className:"text-red-900 dark:text-brandRed rounded group flex items-center py-2 px-4 text-sm text-left w-full transition ease-in",onClick:()=>{e("end Room")},children:[(0,o.jsx)("i",{className:"pnm-call text-red-900 dark:text-brandRed mr-2 transition ease-in "}),i("header.menus.end")]})})}):null]})})})),ui=(0,wr.P1)((e=>e.roomSettings.activateWebcamsView),(e=>e)),mi=(0,wr.P1)((e=>e.roomSettings.activeScreenSharingView),(e=>e)),pi=()=>{const e=yr(),{t}=(0,m.$G)(),[r,a]=(0,s.useState)(br.getState().roomSettings.roomVideoQuality);(0,s.useEffect)((()=>{e(Ze(r))}),[e,r]);const i=kr(ui),n=kr(mi),l=()=>{e(ze(!i))},d=()=>{e(Qe(!n))};return(0,o.jsx)("div",{className:"mt-2",children:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,o.jsx)("label",{htmlFor:"quality",className:"pr-4 w-full dark:text-darkText",children:t("header.room-settings.video-quality")}),(0,o.jsxs)("select",{id:"quality",name:"quality",className:"mt-1 block py-2 px-3 border border-gray-300 dark:border-darkText dark:text-darkText bg-transparent rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",value:r,onChange:e=>a(Number(e.target.value)),children:[(0,o.jsx)("option",{value:Be.SF.LOW,children:t("header.room-settings.low")}),(0,o.jsx)("option",{value:Be.SF.MEDIUM,children:t("header.room-settings.medium")}),(0,o.jsx)("option",{value:Be.SF.HIGH,children:t("header.room-settings.high")})]})]}),(0,o.jsxs)(rs.r.Group,{children:[(0,o.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,o.jsx)(rs.r.Label,{className:"pr-4 w-full dark:text-darkText",children:t("header.room-settings.show-webcams")}),(0,o.jsx)(rs.r,{checked:i,onChange:l,className:(i?"bg-primaryColor dark:bg-darkSecondary2":"bg-gray-200 dark:bg-secondaryColor")+" relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2",children:(0,o.jsx)("span",{className:(i?"translate-x-6":"translate-x-1")+" inline-block w-4 h-4 transform bg-white rounded-full transition-transform"})})]}),(0,o.jsxs)("div",{className:"flex items-center justify-between",children:[(0,o.jsx)(rs.r.Label,{className:"pr-4 w-full dark:text-darkText",children:t("header.room-settings.show-screen-share")}),(0,o.jsx)(rs.r,{checked:n,onChange:d,className:(n?"bg-primaryColor dark:bg-darkSecondary2":"bg-gray-200 dark:bg-secondaryColor")+" relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2",children:(0,o.jsx)("span",{className:(n?"translate-x-6":"translate-x-1")+" inline-block w-4 h-4 transform bg-white rounded-full transition-transform"})})]})]})]})})},hi=(0,wr.P1)((e=>e.roomSettings.allowPlayAudioNotification),(e=>e)),xi=()=>{const e=yr(),{t}=(0,m.$G)(),r=kr(hi),a=()=>{e(Ye(!r))};return(0,o.jsx)("div",{className:"mt-2",children:(0,o.jsx)(rs.r.Group,{children:(0,o.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,o.jsx)(rs.r.Label,{className:"pr-4 w-full dark:text-darkText",children:t("header.room-settings.allow-audio-notification")}),(0,o.jsx)(rs.r,{checked:r,onChange:a,className:(r?"bg-primaryColor dark:bg-darkSecondary2":"bg-gray-200 dark:bg-secondaryColor")+" relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2",children:(0,o.jsx)("span",{className:(r?"translate-x-6":"translate-x-1")+" inline-block w-4 h-4 transform bg-white rounded-full transition-transform"})})]})})})},fi=[{code:"en",text:"English"},{code:"de-DE",text:"Deutsch"},{code:"nl-NL",text:"Dutch"},{code:"es-ES",text:"Espa\xf1ol"},{code:"fr-FR",text:"Fran\xe7ais"},{code:"pt-PT",text:"Portugu\xeas"},{code:"it-IT",text:"Italiano"},{code:"tr-TR",text:"T\xfcrk\xe7e"},{code:"ar-SA",text:"\u0627\u0644\u0644\u063a\u0629 \u0627\u0644\u0639\u0631\u0628\u064a\u0629"},{code:"bn-BD",text:"\u09ac\u09be\u0982\u09b2\u09be"},{code:"ja-JP",text:"\u65e5\u672c\u8a9e"},{code:"ru-RU",text:"\u0420\u0443\u0441\u0441\u043a\u0438\u0439"},{code:"uk-UA",text:"\u0423\u043a\u0440\u0430\u0457\u043d\u0441\u044c\u043a\u0430"},{code:"zh-CN",text:"\u7b80\u4f53\u4e2d\u6587"},{code:"zh-HK",text:"\u7e41\u9ad4\u4e2d\u6587"}],gi=(0,wr.P1)((e=>e.roomSettings.theme),(e=>e)),vi=(0,wr.P1)((e=>e.roomSettings.videoObjectFit),(e=>e)),bi=(0,wr.P1)((e=>e.roomSettings.columnCameraWidth),(e=>e)),yi=(0,wr.P1)((e=>e.roomSettings.columnCameraPosition),(e=>e)),ki=()=>{const{t:e,i18n:t}=(0,m.$G)(),r=yr(),a=kr(gi),s=kr(vi),i=kr(bi),n=kr(yi),l=()=>{r(et("light"===a?"dark":"light"))};return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"s",children:[(0,o.jsx)("div",{className:"grid",children:(0,o.jsxs)("div",{className:"flex items-center justify-start",children:[(0,o.jsx)("label",{htmlFor:"language",className:"pr-4 w-full dark:text-darkText",children:e("header.room-settings.language")}),(0,o.jsx)("select",{id:"language",name:"language",value:t.languages[0],onChange:e=>t.changeLanguage(e.target.value),className:"mt-1 block w-3/5 py-2 px-3 border border-gray-300 dark:border-darkText dark:text-darkText bg-transparent rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:fi.map((({code:e,text:t})=>(0,o.jsx)("option",{value:e,children:t},e)))})]})}),(0,o.jsx)(rs.r.Group,{children:(0,o.jsxs)("div",{className:"flex items-center justify-between my-4",children:[(0,o.jsx)(rs.r.Label,{className:"pr-4 w-full dark:text-darkText",children:e("header.room-settings.enable-dark-theme")}),(0,o.jsx)(rs.r,{checked:"dark"===a,onChange:l,className:("dark"===a?"bg-primaryColor dark:bg-darkSecondary2":"bg-gray-200 dark:bg-secondaryColor")+" relative inline-flex items-center h-6 rounded-full w-11 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2",children:(0,o.jsx)("span",{className:("dark"===a?"translate-x-6":"translate-x-1")+" inline-block w-4 h-4 transform bg-white rounded-full transition-transform"})})]})}),(0,o.jsx)("div",{className:"grid",children:(0,o.jsxs)("div",{className:"flex items-center justify-start",children:[(0,o.jsx)("label",{htmlFor:"video-object-fit",className:"pr-4 w-full dark:text-darkText",children:e("header.room-settings.video-object-fit")}),(0,o.jsxs)("select",{id:"video-object-fit",name:"video-object-fit",value:s,onChange:e=>r(tt(e.target.value)),className:"mt-1 block w-3/5 py-2 px-3 border border-gray-300 dark:border-darkText dark:text-darkText bg-transparent rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,o.jsx)("option",{value:Oe.COVER,children:e("header.room-settings.video-object-fit-cover")},Oe.COVER),(0,o.jsx)("option",{value:Oe.CONTAIN,children:e("header.room-settings.video-object-fit-contain")},Oe.CONTAIN)]})]})}),(0,o.jsx)("div",{className:"grid py-2",children:(0,o.jsxs)("div",{className:"flex items-center justify-start",children:[(0,o.jsx)("label",{htmlFor:"column-camera-width",className:"pr-4 w-full dark:text-darkText",children:e("header.room-settings.column-camera-width")}),(0,o.jsxs)("select",{id:"column-camera-width",name:"column-camera-width",value:i,onChange:e=>r(nt(e.target.value)),className:"mt-1 block w-3/5 py-2 px-3 border border-gray-300 dark:border-darkText dark:text-darkText bg-transparent rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,o.jsx)("option",{value:De.FULL_WIDTH,children:e("header.room-settings.column-camera-width-default")},De.FULL_WIDTH),(0,o.jsx)("option",{value:De.MEDIUM_WIDTH,children:e("header.room-settings.column-camera-width-medium")},De.MEDIUM_WIDTH),(0,o.jsx)("option",{value:De.SMALL_WIDTH,children:e("header.room-settings.column-camera-width-small")},De.SMALL_WIDTH)]})]})}),(0,o.jsx)("div",{className:"grid",children:(0,o.jsxs)("div",{className:"flex items-center justify-start",children:[(0,o.jsx)("label",{htmlFor:"column-camera-position",className:"pr-4 w-full dark:text-darkText",children:e("header.room-settings.column-camera-position")}),(0,o.jsxs)("select",{id:"column-camera-position",name:"column-camera-position",value:n,onChange:e=>r(lt(e.target.value)),className:"mt-1 block w-3/5 py-2 px-3 border border-gray-300 dark:border-darkText dark:text-darkText bg-transparent rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",children:[(0,o.jsx)("option",{value:Le.LEFT,children:e("header.room-settings.column-camera-position-left")},Le.LEFT),(0,o.jsx)("option",{value:Le.TOP,children:e("header.room-settings.column-camera-position-top")},Le.TOP),(0,o.jsx)("option",{value:Le.BOTTOM,children:e("header.room-settings.column-camera-position-bottom")},Le.BOTTOM)]})]})})]})})};var wi;!function(e){e[e.RTMP_INPUT=0]="RTMP_INPUT"}(wi||(wi={})),It.w.util.setEnumType(wi,"plugnmeet.IngressInput",[{no:0,name:"RTMP_INPUT"}]);class Ti extends Rt.v{constructor(e){super(),this.inputType=wi.RTMP_INPUT,this.participantName="",this.roomId="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new Ti).fromBinary(e,t)}static fromJson(e,t){return(new Ti).fromJson(e,t)}static fromJsonString(e,t){return(new Ti).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(Ti,e,t)}}Ti.runtime=It.w,Ti.typeName="plugnmeet.CreateIngressReq",Ti.fields=It.w.util.newFieldList((()=>[{no:1,name:"input_type",kind:"enum",T:It.w.getEnumType(wi)},{no:2,name:"participant_name",kind:"scalar",T:9},{no:3,name:"room_id",kind:"scalar",T:9}]));class ji extends Rt.v{constructor(e){super(),this.status=!1,this.msg="",this.url="",this.streamKey="",It.w.util.initPartial(e,this)}static fromBinary(e,t){return(new ji).fromBinary(e,t)}static fromJson(e,t){return(new ji).fromJson(e,t)}static fromJsonString(e,t){return(new ji).fromJsonString(e,t)}static equals(e,t){return It.w.util.equals(ji,e,t)}}ji.runtime=It.w,ji.typeName="plugnmeet.CreateIngressRes",ji.fields=It.w.util.newFieldList((()=>[{no:1,name:"status",kind:"scalar",T:8},{no:2,name:"msg",kind:"scalar",T:9},{no:3,name:"url",kind:"scalar",T:9},{no:4,name:"stream_key",kind:"scalar",T:9}]));const Si=(0,wr.P1)((e=>{var t,r;return null===(r=null===(t=e.session.currentRoom)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.room_features.ingress_features}),(e=>e)),_i=()=>{const{t:e}=(0,m.$G)(),[t,r]=(0,s.useState)("broadcaster"),[a,i]=(0,s.useState)(null),n=br.getState().session,d=kr(Si);return(0,o.jsx)("div",{className:"mt-2",children:(0,ds.isEmpty)(null===d||void 0===d?void 0:d.url)&&(0,ds.isEmpty)(null===d||void 0===d?void 0:d.stream_key)?(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("form",{method:"POST",onSubmit:r=>(async r=>{if(r.preventDefault(),i(null),!(null===d||void 0===d?void 0:d.is_allow))return void i(e("ingress-features.feature-not-allow"));let a=t;(0,ds.isEmpty)(a)&&(a="broadcaster");const o=new Ti({inputType:wi.RTMP_INPUT,participantName:a,roomId:n.currentRoom.room_id}),s=await co("ingress/create",o.toBinary(),!1,"application/protobuf","arraybuffer"),c=ji.fromBinary(new Uint8Array(s));c.status||(0,l.Am)(e(c.msg),{type:"error",isLoading:!1,autoClose:1e3})})(r),children:[(0,o.jsxs)("div",{className:"",children:[(0,o.jsx)("label",{htmlFor:"stream-key",className:"block text-sm font-medium text-gray-700 dark:text-darkText",children:e("ingress-features.join-as-name")}),(0,o.jsx)("input",{type:"text",name:"name",id:"name",value:t,onChange:e=>r(e.currentTarget.value),className:"mt-1 px-4 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm rounded-md h-10 border border-solid border-black/50 dark:border-darkText bg-transparent dark:text-darkText"}),a?(0,o.jsx)("div",{className:"error-msg text-xs text-red-600 py-2",children:a}):null]}),(0,o.jsx)("div",{className:"pb-3 pt-4 bg-gray-50 dark:bg-transparent text-right mt-4",children:(0,o.jsx)("button",{type:"submit",className:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primaryColor hover:bg-secondaryColor focus:outline-none focus:ring-2 focus:ring-offset-2 focus:bg-secondaryColor",children:e("ingress-features.gen-link")})})]})}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"grid",children:(0,o.jsxs)("div",{className:"flex items-center justify-start",children:[(0,o.jsx)("label",{htmlFor:"language",className:"pr-4 w-full dark:text-darkText",children:e("ingress-features.rtmp-url")}),(0,o.jsx)("input",{type:"text",readOnly:!0,name:"url",id:"url",value:null===d||void 0===d?void 0:d.url,className:"mt-1 px-4 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm rounded-md h-10 border border-solid border-black/50 dark:border-darkText bg-transparent dark:text-darkText"})]})}),(0,o.jsx)("div",{className:"grid",children:(0,o.jsxs)("div",{className:"flex items-center justify-start",children:[(0,o.jsx)("label",{htmlFor:"language",className:"pr-4 w-full dark:text-darkText",children:e("ingress-features.rtmp-key")}),(0,o.jsx)("input",{type:"text",readOnly:!0,name:"stream_key",id:"stream_key",value:null===d||void 0===d?void 0:d.stream_key,className:"mt-1 px-4 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm rounded-md h-10 border border-solid border-black/50 dark:border-darkText bg-transparent dark:text-darkText"})]})})]})})},Ni=(0,wr.P1)((e=>e.roomSettings.isShowRoomSettingsModal),(e=>e)),Ci=()=>{var e,t,r,a;const i=yr(),{t:n}=(0,m.$G)(),l=br.getState(),d=l.session.serverVersion,c=null===(t=null===(e=l.session.currentRoom)||void 0===e?void 0:e.metadata)||void 0===t?void 0:t.copyright_conf,u=null===(a=null===(r=l.session.currentRoom)||void 0===r?void 0:r.metadata)||void 0===a?void 0:a.room_features.ingress_features,p=kr(Ni),[h,x]=(0,s.useState)({"header.room-settings.application":[{id:1,elm:(0,o.jsx)(ki,{})}],"header.room-settings.data-savings":[{id:2,elm:(0,o.jsx)(pi,{})}],"header.room-settings.notifications":[{id:3,elm:(0,o.jsx)(xi,{})}]});(0,s.useEffect)((()=>{var e,t,r;(null===(r=null===(t=null===(e=l.session)||void 0===e?void 0:e.currentUser)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.is_admin)&&(null===u||void 0===u?void 0:u.is_allow)&&(h["header.room-settings.ingress"]=[{id:4,elm:(0,o.jsx)(_i,{})}]),x(h)}),[]);const f=()=>{let e=(null===c||void 0===c?void 0:c.display)?`${null===c||void 0===c?void 0:c.text}&nbsp;`:"";return e+=n("plugnmeet-server-client-version",{server:d,client:"1.3.7"}),(0,o.jsx)("div",{className:"absolute inset-x-0 bottom-0 text-center text-xs dark:text-darkText",dangerouslySetInnerHTML:{__html:e}})},g=()=>(0,o.jsx)("div",{className:"max-w-full",children:(0,o.jsxs)(ls.O.Group,{vertical:!0,children:[(0,o.jsx)(ls.O.List,{className:"flex p-1 space-x-1 bg-primaryColor rounded-xl",children:Object.keys(h).map((e=>(0,o.jsx)(ls.O,{className:({selected:e})=>((...e)=>e.filter(Boolean).join(" "))("w-full py-1 text-xs sm:text-sm leading-5 font-medium text-secondaryColor rounded-lg outline-none","ring-white ring-opacity-60",e?"bg-white dark:bg-secondaryColor shadow text-primaryColor dark:text-white":"hover:bg-white/[0.12] hover:text-white"),children:n(e)},e)))}),(0,o.jsx)(ls.O.Panels,{className:"mt-2",children:Object.values(h).map(((e,t)=>(0,o.jsx)(ls.O.Panel,{className:"bg-transparent rounded-xl p-3",children:(0,o.jsx)("ul",{children:e.map((e=>(0,o.jsx)("li",{children:e.elm},e.id)))})},t)))})]})});return(0,o.jsx)(o.Fragment,{children:p?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(Sr.u,{appear:!0,show:p,as:s.Fragment,children:(0,o.jsx)(_r.V,{as:"div",className:"fixed inset-0 z-[9999] overflow-y-auto",onClose:()=>!1,children:(0,o.jsxs)("div",{className:"min-h-screen px-4 text-center",children:[(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,o.jsx)(_r.V.Overlay,{className:"fixed inset-0 bg-black opacity-30"})}),(0,o.jsx)("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"\u200b"}),(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,o.jsxs)("div",{className:"inline-block w-full h-[25rem] max-w-2xl py-6 px-4 lg:px-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white dark:bg-darkPrimary shadow-xl rounded-2xl",children:[(0,o.jsxs)("button",{className:"close-btn absolute top-8 right-6 w-[25px] h-[25px] outline-none",type:"button",onClick:()=>{i($e(!1))},children:[(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 rotate-45"}),(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 -rotate-45"})]}),(0,o.jsx)(_r.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-white mb-2",children:n("header.room-settings.title")}),(0,o.jsx)("hr",{}),(0,o.jsx)("div",{className:"mt-2",children:g()}),f()]})})]})})})}):null})},Ei=(0,wr.P1)((e=>e.roomSettings.isShowKeyboardShortcuts),(e=>e)),Ri=()=>{const e=yr(),{t}=(0,m.$G)(),r=kr(Ei);return(0,o.jsx)(o.Fragment,{children:r?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(Sr.u,{appear:!0,show:r,as:s.Fragment,children:(0,o.jsx)(_r.V,{as:"div",className:"fixed inset-0 z-[9999] overflow-y-auto",onClose:()=>!1,children:(0,o.jsxs)("div",{className:"min-h-screen px-4 text-center",children:[(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,o.jsx)(_r.V.Overlay,{className:"fixed inset-0 bg-black opacity-30"})}),(0,o.jsx)("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"\u200b"}),(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,o.jsxs)("div",{className:"inline-block w-full max-w-xl py-6 px-4 lg:px-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white dark:bg-darkPrimary shadow-xl rounded-2xl",children:[(0,o.jsxs)("button",{className:"close-btn absolute top-8 right-6 w-[25px] h-[25px] outline-none",type:"button",onClick:()=>{e(Xe(!1))},children:[(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 rotate-45"}),(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 -rotate-45"})]}),(0,o.jsx)(_r.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-white mb-2",children:t("header.keyboard-shortcuts.title")}),(0,o.jsx)("hr",{}),(0,o.jsx)("div",{className:"mt-2",children:(0,o.jsxs)("table",{className:"border-collapse border border-slate-500 dark:border-darkText w-full",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{className:"pl-2 border-b border-r border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:(0,o.jsx)("strong",{children:t("header.keyboard-shortcuts.key-comb")})}),(0,o.jsx)("th",{className:"pl-2 border-b border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:(0,o.jsx)("strong",{children:t("header.keyboard-shortcuts.actions")})})]})}),(0,o.jsxs)("tbody",{children:[(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"pl-2 border-b border-r border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:"ctrl + alt/option + m"}),(0,o.jsx)("td",{className:"pl-2 border-b border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base ",children:t("header.keyboard-shortcuts.mute-unmute")})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"pl-2 border-b border-r border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:"ctrl + alt/option + a"}),(0,o.jsx)("td",{className:"pl-2 border-b border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:t("header.keyboard-shortcuts.start-audio")})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"pl-2 border-b border-r border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:"ctrl + alt/option + o"}),(0,o.jsx)("td",{className:"pl-2 border-b border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:t("header.keyboard-shortcuts.leave-audio")})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"pl-2 border-b border-r border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:"ctrl + alt/option + v"}),(0,o.jsx)("td",{className:"pl-2 border-b border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:t("header.keyboard-shortcuts.start-webcam")})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"pl-2 border-b border-r border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:"ctrl + alt/option + x"}),(0,o.jsx)("td",{className:"pl-2 border-b border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:t("header.keyboard-shortcuts.leave-webcam")})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"pl-2 border-b border-r border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:"ctrl + alt/option + u"}),(0,o.jsx)("td",{className:"pl-2 border-b border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:t("header.keyboard-shortcuts.show-hide-user-list")})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"pl-2 border-b border-r border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:"ctrl + alt/option + c"}),(0,o.jsx)("td",{className:"pl-2 border-b border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:t("header.keyboard-shortcuts.show-hide-chat")})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"pl-2 border-b border-r border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:"ctrl + alt/option + l"}),(0,o.jsx)("td",{className:"pl-2 border-b border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:t("header.keyboard-shortcuts.show-hide-lock-settings")})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"pl-2 border-b border-r border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:"ctrl + alt/option + s"}),(0,o.jsx)("td",{className:"pl-2 border-b border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:t("header.keyboard-shortcuts.show-hide-settings")})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"pl-2 border-b border-r border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:"ctrl + alt/option + w"}),(0,o.jsx)("td",{className:"pl-2 border-b border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:t("header.keyboard-shortcuts.show-hide-whiteboard")})]}),(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{className:"pl-2 border-r border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:"ctrl + alt/option + r"}),(0,o.jsx)("td",{className:"pl-2 border-slate-700 dark:border-darkText dark:text-darkText text-xs sm:text-sm md:text-base",children:t("header.keyboard-shortcuts.show-hide-hand")})]})]})]})})]})})]})})})}):null})},Ii=()=>{const e=yr(),[t,r]=(0,s.useState)(br.getState().roomSettings.roomAudioVolume),a=ks(t);(0,s.useEffect)((()=>{if(a&&t!==a){e(Ke(t));br.getState().participants.ids.forEach((r=>{e(P({id:r,changes:{audioVolume:t}}))}))}}),[t,a]);return(0,o.jsx)(ia.v,{children:({open:e})=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ia.v.Button,{className:"relative flex-shrink-0 p-2",children:(0,o.jsx)("div",{className:"h-4 w-4 -mt-[2px]",children:t>0?(0,o.jsx)("i",{className:"pnm-speaker primaryColor dark:text-secondaryColor"}):(0,o.jsx)("i",{className:"pnm-speaker-muted primaryColor dark:text-secondaryColor"})})}),(0,o.jsx)(Sr.u,{show:e,enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:(0,o.jsx)(ia.v.Items,{static:!0,className:"volume-popup-wrapper origin-top-right z-10 absolute right-0 top-4 mt-2 w-64 py-5 px-2 rounded-md shadow-lg bg-white dark:bg-darkPrimary/90 ring-1 ring-black dark:ring-secondaryColor ring-opacity-5 divide-y divide-gray-100 focus:outline-none",children:(0,o.jsxs)("section",{className:"flex items-center",children:[(0,o.jsx)("input",{type:"range",min:0,max:1,step:.05,value:t,onChange:e=>{r(e.target.valueAsNumber)},className:"range flex-1"}),(0,o.jsx)("p",{className:"w-10 text-center text-sm dark:text-white",children:Math.round(100*t)}),(0,o.jsx)("button",{className:"w-5 h-5",children:t>0?(0,o.jsx)("i",{className:"pnm-speaker primaryColor dark:text-secondaryColor"}):(0,o.jsx)("i",{className:"pnm-speaker-muted primaryColor dark:text-secondaryColor"})})]})})})]})})},Ai=({duration:e})=>{var t;const{t:r}=(0,m.$G)(),a=null===(t=br.getState().session.currentUser)||void 0===t?void 0:t.isRecorder,[i,n]=(0,s.useState)("00:00"),[d,c]=(0,s.useState)(!1);return(0,s.useEffect)((()=>{var t;const r=null===(t=br.getState().session.currentRoom.metadata)||void 0===t?void 0:t.started_at,a=r?1e3*r:Date.now();let o,s,i;n("00:00");const l=setInterval((()=>{o=60*e-((Date.now()-a)/1e3|0),s=o/60|0,i=o%60|0,s=s<10?"0"+s:s,i=i<10?"0"+i:i,n(s+":"+i),s<60&&c(!0),o<=0&&n("00:00")}),1e3);return()=>{l&&clearInterval(l)}}),[e]),(0,s.useEffect)((()=>{if(!a)switch(i){case"60:00":case"30:00":case"10:00":case"5:00":(0,l.Am)(r("notifications.room-will-end-in",{minutes:i}),{type:"warning"})}}),[a,i,r]),(0,o.jsx)(o.Fragment,{children:d?(0,o.jsx)("div",{className:"timer text-xs md:text-sm border border-solid border-primaryColor dark:border-darkText/80 dark:text-darkText/80 sm:py-[2px] px-3 rounded-lg mt-[2px] mr-[6px]",children:i}):null})},Pi=(0,wr.P1)((e=>e.roomSettings.theme),(e=>e)),Fi=()=>{const e=kr(Pi),t=yr();return(0,o.jsx)("div",{className:"dark-mode mt-1",children:(0,o.jsx)("button",{onClick:()=>{t(et("light"===e?"dark":"light"))},children:(0,o.jsx)(o.Fragment,{children:"dark"===e?(0,o.jsx)("div",{className:"moon w-8 h-8 rounded-full flex items-center justify-center",children:(0,o.jsx)("i",{className:"pnm-moon w-4 h-4 text-primaryColor dark:text-secondaryColor"})}):(0,o.jsx)("div",{className:"sun w-8 h-8 rounded-full flex items-center justify-center",children:(0,o.jsx)("i",{className:"pnm-sun w-4 h-4 text-primaryColor dark:text-secondaryColor"})})})})})},Mi=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_title}),(e=>e)),Oi=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_features.room_duration}),(e=>e)),Di=(0,wr.P1)((e=>e.roomSettings.visibleHeader),(e=>e)),Li=s.memo((({currentRoom:e})=>{var t,r;const a=kr(Mi),i=kr(Oi),n=kr(Di),d=yr(),{t:c}=(0,m.$G)(),[u,p]=(0,s.useState)(""),[h,x]=(0,s.useState)(!1),[f,g]=(0,s.useState)(""),[v,b]=(0,s.useState)(""),y=null!==(t=window.STATIC_ASSETS_PATH)&&void 0!==t?t:"./assets",k=null!==(r=window.CUSTOM_LOGO)&&void 0!==r?r:`${y}/imgs/main-logo.png`;(0,s.useEffect)((()=>{a&&p(a)}),[a]);const w=async(t=!1)=>{if(x(!1),t)if("logout"===v)e.disconnect();else if("end Room"===v){const e=br.getState().session,t=new Ya({roomId:e.currentRoom.room_id}),r=await co("endRoom",t.toBinary(),!1,"application/protobuf","arraybuffer"),a=Va.fromBinary(new Uint8Array(r));a.status||(0,l.Am)(a.msg,{type:"error"})}};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(Sr.u,{show:n,unmount:!1,enter:"transform duration-200 transition ease-in",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"transform duration-200 transition ease-in",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,o.jsxs)("header",{id:"main-header",className:"relative z-[99999] px-4 h-[50px] shadow-header flex items-center justify-between bg-white dark:bg-darkPrimary transition-transform "+(n?"ac":""),children:[(0,o.jsx)("div",{className:"header-before-start absolute top-0 left-[-35px] w-[300px] pointer-events-none bg-cover bg-center h-full",style:{backgroundImage:`url("${y}/imgs/header-before2.png")`}}),(0,o.jsx)("div",{className:"logo w-28 relative z-20",children:(0,o.jsx)("div",{className:(window.CUSTOM_LOGO,"h-[45px]")+" header-logo  bg-contain bg-no-repeat",style:{backgroundImage:`url("${k}")`}})}),(0,o.jsx)("div",{className:"middle flex-auto relative z-20",children:(0,o.jsx)("h2",{className:"header-title text-base text-black dark:text-white leading-[1] text-center",children:u})}),(0,o.jsxs)("div",{className:"dark-area w-28 flex items-center justify-end relative z-20 -right-3",children:[i&&i>0?(0,o.jsx)(Ai,{duration:i}):null,(0,o.jsx)(Fi,{}),(0,o.jsx)(Ii,{}),(0,o.jsx)(ia.v,{children:({open:e})=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ia.v.Button,{className:"relative flex-shrink-0 p-2",children:(0,o.jsx)("div",{className:"h-5 w-5 rotate-90 ",children:(0,o.jsx)("i",{className:"pnm-menu-small dark:text-secondaryColor"})})}),(0,o.jsx)(Sr.u,{show:e,enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:(0,o.jsx)(ci,{onOpenAlert:e=>(e=>{b(e),"logout"===e?g(c("header.menus.alert.logout").toString()):"end Room"===e&&g(c("header.menus.alert.end").toString()),x(!0)})(e)})})]})})]}),(0,o.jsx)("div",{className:"header-before-end absolute top-0 right-[-100px] w-[350px] lg:w-[380px] rotate-[156deg] pointer-events-none bg-cover bg-center h-full",style:{backgroundImage:`url("${y}/imgs/header-before2.png")`}}),h?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(Sr.u,{appear:!0,show:h,as:s.Fragment,children:(0,o.jsx)(_r.V,{as:"div",className:"fixed inset-0 z-[9999] overflow-y-auto",onClose:()=>!1,children:(0,o.jsxs)("div",{className:"min-h-screen px-4 text-center",children:[(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,o.jsx)(_r.V.Overlay,{className:"fixed inset-0 bg-black opacity-30"})}),(0,o.jsx)("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"\u200b"}),(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,o.jsxs)("div",{className:"inline-block w-full max-w-md p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white dark:bg-darkPrimary shadow-xl rounded-2xl",children:[(0,o.jsxs)("button",{className:"close-btn absolute top-8 right-6 w-[25px] h-[25px] outline-none",type:"button",onClick:()=>w(),children:[(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 rotate-45"}),(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 -rotate-45"})]}),(0,o.jsx)(_r.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-white",children:c("header.menus.alert.confirm")}),(0,o.jsx)("div",{className:"mt-2",children:(0,o.jsx)("p",{className:"text-sm text-gray-500 dark:text-darkText",children:f})}),(0,o.jsxs)("div",{className:"mt-4",children:[(0,o.jsx)("button",{className:"inline-flex justify-center px-4 py-2 text-sm font-medium text-white bg-red-600 mr-4 border border-transparent rounded-md hover:bg-red-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500",onClick:()=>w(!0),children:c("ok")}),(0,o.jsx)("button",{type:"button",className:"inline-flex justify-center px-4 py-2 text-sm font-medium bg-primaryColor hover:bg-secondaryColor text-white border border-transparent rounded-md focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500",onClick:()=>w(!1),children:c("close")})]})]})})]})})})}):null]})}),(0,o.jsxs)("div",{className:"header-collapse-arrow group fixed right-0 flex items-start justify-center h-5 w-[50px] cursor-pointer z-[2] bg-white dark:bg-darkPrimary rounded-bl-lg "+(n?"top-[50px] pt-[3px]":"top-0 pt-[6px]"),onClick:()=>d(dt()),children:[(0,o.jsx)("i",{className:"text-[10px] sm:text-[12px] dark:text-secondaryColor pnm-arrow-below "+(n?"rotate-180":"")}),(0,o.jsx)("span",{className:"absolute right-0 top-7 w-max bg-white text-darkPrimary dark:text-white dark:bg-darkPrimary text-[10px] py-1 px-[12px] rounded opacity-0 invisible transition-all group-hover:opacity-100 group-hover:visible",children:c(n?"header.hide-header":"header.show-header")})]}),(0,o.jsx)(Ci,{}),(0,o.jsx)(Ri,{})]})}));var Bi=r(2810);const Ui=({participant:e})=>(0,o.jsx)("div",{className:"thumb h-[22px] xl:h-[30px] w-[22px] xl:w-[30px] mr-2 rounded-full overflow-hidden bg-primaryColor flex items-center justify-center text-white text-xs xl:text-sm",children:e.metadata.profile_pic?(0,o.jsx)("img",{src:e.metadata.profile_pic,alt:e.name}):(0,o.jsx)(o.Fragment,{children:e.name.slice(0,2).toUpperCase()})}),Wi=({name:e,isCurrentUser:t})=>(0,o.jsxs)("p",{className:"text-[11px] xl:text-[13px] primaryColor dark:text-darkText",children:[e," ",t?" (me)":null]}),Gi=({userId:e})=>{const t=kr((t=>E.selectById(t,e))),r=(0,s.useMemo)((()=>(null===t||void 0===t?void 0:t.metadata.raised_hand)?(0,o.jsx)("div",{className:"hand mr-2 cursor-pointer",children:(0,o.jsx)("i",{className:"pnm-raise-hand text-[#ffbd40] text-[10px]"})}):null),[null===t||void 0===t?void 0:t.metadata.raised_hand]);return(0,o.jsx)(o.Fragment,{children:r})},Ji=({userId:e,isRemoteParticipant:t})=>{var r;const a=kr((t=>E.selectById(t,e))),[i,n]=(0,s.useState)(null!==(r=null===a||void 0===a?void 0:a.audioVolume)&&void 0!==r?r:1),l=ks(i),d=yr();(0,s.useEffect)((()=>{"undefined"!==typeof(null===a||void 0===a?void 0:a.audioVolume)&&n(null===a||void 0===a?void 0:a.audioVolume)}),[null===a||void 0===a?void 0:a.audioVolume]),(0,s.useEffect)((()=>{l&&i!==l&&d(P({id:e,changes:{audioVolume:i}}))}),[i,l]);const c=(0,s.useCallback)((()=>(0,o.jsx)("div",{className:"mic mr-2 cursor-pointer",children:(0,o.jsx)(ia.v,{children:({open:e})=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ia.v.Button,{children:(0,o.jsx)("i",{className:"pnm-mic-unmute secondaryColor text-[10px]"})}),(0,o.jsx)(Sr.u,{show:e,enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100 relative z-10",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:(0,o.jsx)(ia.v.Items,{static:!0,className:"volume-popup-wrapper origin-top-right z-10 absolute -right-6 -top-2 mt-2 w-48 xl:w-60 py-5 px-2 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 divide-y divide-gray-100 focus:outline-none",children:(0,o.jsxs)("section",{className:"flex items-center",children:[(0,o.jsx)("input",{type:"range",min:0,max:1,step:.05,value:i,onChange:e=>{n(e.target.valueAsNumber)},className:"range flex-1"}),(0,o.jsx)("p",{className:"w-10 text-center text-sm",children:Math.round(100*i)}),(0,o.jsx)("button",{className:"w-5 h-5",children:(0,o.jsx)("i",{className:"pnm-speaker primaryColor"})})]})})})]})})})),[i]),u=(0,s.useMemo)((()=>(null===a||void 0===a?void 0:a.audioTracks)?a.isMuted?(0,o.jsx)("div",{className:"mic muted mr-2 cursor-pointer",children:(0,o.jsx)("i",{className:"pnm-mic-mute secondaryColor text-[10px]"})}):t?c():(0,o.jsx)("div",{className:"mic mr-2 cursor-pointer",children:(0,o.jsx)("i",{className:"pnm-mic-unmute secondaryColor text-[10px]"})}):null),[t,c,null===a||void 0===a?void 0:a.audioTracks,null===a||void 0===a?void 0:a.isMuted]);return(0,o.jsx)(o.Fragment,{children:u})},Vi=({userId:e})=>{const t=kr((t=>E.selectById(t,e))),r=(0,s.useMemo)((()=>(null===t||void 0===t?void 0:t.videoTracks)?(0,o.jsx)("div",{className:"mic mr-2 cursor-pointer",children:(0,o.jsx)("i",{className:"pnm-webcam secondaryColor text-[10px]"})}):null),[null===t||void 0===t?void 0:t.videoTracks]);return(0,o.jsx)(o.Fragment,{children:r})},Hi=({userId:e})=>{const t=kr((t=>E.selectById(t,e))),r=(0,s.useMemo)((()=>(null===t||void 0===t?void 0:t.screenShareTrack)?(0,o.jsx)("div",{className:"screen-share mr-2 cursor-pointer",children:(0,o.jsx)("i",{className:"pnm-screen-share secondaryColor text-[10px]"})}):null),[null===t||void 0===t?void 0:t.screenShareTrack]);return(0,o.jsx)(o.Fragment,{children:r})},qi=({userId:e})=>{var t;const r=kr((t=>E.selectById(t,e))),a=br.getState().session,[i,n]=(0,s.useState)("Ask to share Microphone"),[d,c]=(0,s.useState)(""),{t:u}=(0,m.$G)();(0,s.useEffect)((()=>{0===(null===r||void 0===r?void 0:r.audioTracks)?(n(u("left-panel.menus.items.ask-to-share-microphone").toString()),c("left-panel.menus.items.share-microphone")):(null===r||void 0===r?void 0:r.isMuted)?(n(u("left-panel.menus.items.ask-to-unmute-mic").toString()),c("left-panel.menus.items.unmute-mic")):(null===r||void 0===r?void 0:r.audioTracks)&&(n(u("left-panel.menus.items.mute-mic").toString()),c("mute"))}),[u,null===r||void 0===r?void 0:r.isMuted,null===r||void 0===r?void 0:r.audioTracks]);const p=async()=>{const e=br.getState().session,t=new $a({sid:e.currentRoom.sid,roomId:e.currentRoom.room_id,userId:null===r||void 0===r?void 0:r.userId,muted:!0}),a=await co("muteUnmuteTrack",t.toBinary(),!1,"application/protobuf","arraybuffer"),o=Va.fromBinary(new Uint8Array(a));o.status?(0,l.Am)(u("left-panel.menus.notice.you-have-muted-to",{name:null===r||void 0===r?void 0:r.name}),{toastId:"asked-status",type:"info"}):(0,l.Am)(u(o.msg),{toastId:"asked-status",type:"error"})};return(0,o.jsx)(o.Fragment,{children:(null===(t=a.currentUser)||void 0===t?void 0:t.userId)!==(null===r||void 0===r?void 0:r.userId)?(0,o.jsx)("div",{className:"",role:"none",children:(0,o.jsx)(ia.v.Item,{children:()=>(0,o.jsx)("button",{className:"text-gray-900 dark:text-darkText group flex rounded-md items-center text-left w-full px-2 py-[0.4rem] text-xs lg:text-sm transition ease-in hover:bg-primaryColor hover:text-white",onClick:()=>(()=>{var t,o,s,i,n;if("mute"===d)return void p();const c=new Wa({type:Ma.SYSTEM,roomSid:a.currentRoom.sid,roomId:a.currentRoom.room_id,to:e,body:{type:Oa.INFO,from:{sid:null!==(o=null===(t=a.currentUser)||void 0===t?void 0:t.sid)&&void 0!==o?o:"",userId:null!==(i=null===(s=a.currentUser)||void 0===s?void 0:s.userId)&&void 0!==i?i:""},msg:u("left-panel.menus.notice.asked-you-to",{name:null===(n=a.currentUser)||void 0===n?void 0:n.name})+u(d)}});Wo(c.toBinary()),(0,l.Am)(u("left-panel.menus.notice.you-have-asked",{name:null===r||void 0===r?void 0:r.name})+u(d),{toastId:"asked-status",type:"info"})})(),children:i})})}):null})},$i=({userId:e})=>{var t,r;const{t:a}=(0,m.$G)(),i=kr((t=>E.selectById(t,e))),n=null===(t=br.getState().session.currentRoom.metadata)||void 0===t?void 0:t.room_features,d=br.getState().session,[c,u]=(0,s.useState)("Ask to share Webcam"),[p,h]=(0,s.useState)("");(0,s.useEffect)((()=>{0===(null===i||void 0===i?void 0:i.videoTracks)?(u(a("left-panel.menus.items.ask-to-share-webcam").toString()),h("left-panel.menus.items.share-webcam")):(u(a("left-panel.menus.items.ask-to-stop-webcam").toString()),h("left-panel.menus.items.stop-webcam"))}),[a,null===i||void 0===i?void 0:i.videoTracks]);return(0,o.jsx)(o.Fragment,{children:(null===(r=d.currentUser)||void 0===r?void 0:r.userId)!==(null===i||void 0===i?void 0:i.userId)&&(null===n||void 0===n?void 0:n.allow_webcams)&&!n.admin_only_webcams?(0,o.jsx)("div",{className:"",role:"none",children:(0,o.jsx)(ia.v.Item,{children:()=>(0,o.jsx)("button",{className:"text-gray-900 dark:text-darkText group flex rounded-md items-center text-left w-full px-2 py-[0.4rem] text-xs lg:text-sm transition ease-in hover:bg-primaryColor hover:text-white",onClick:()=>(()=>{var t,r,o,s,n;const c=new Wa({type:Ma.SYSTEM,roomSid:d.currentRoom.sid,roomId:d.currentRoom.room_id,to:e,body:{type:Oa.INFO,from:{sid:null!==(r=null===(t=d.currentUser)||void 0===t?void 0:t.sid)&&void 0!==r?r:"",userId:null!==(s=null===(o=d.currentUser)||void 0===o?void 0:o.userId)&&void 0!==s?s:""},msg:a("left-panel.menus.notice.asked-you-to",{name:null===(n=d.currentUser)||void 0===n?void 0:n.name})+a(p)}});Wo(c.toBinary()),(0,l.Am)(a("left-panel.menus.notice.you-have-asked",{name:null===i||void 0===i?void 0:i.name})+a(p),{toastId:"asked-status",type:"info"})})(),children:c})})}):null})},zi=({userId:e})=>{const t=kr((t=>E.selectById(t,e))),{t:r}=(0,m.$G)();return(0,o.jsx)("div",{className:"",role:"none",children:(0,o.jsx)(ia.v.Item,{children:()=>(0,o.jsx)("button",{className:"text-gray-900 dark:text-darkText group flex rounded-md items-center text-left w-full px-2 py-[0.4rem] text-xs lg:text-sm transition ease-in hover:bg-primaryColor hover:text-white",onClick:()=>(async()=>{const e=new Ka({userId:null===t||void 0===t?void 0:t.userId,task:(null===t||void 0===t?void 0:t.metadata.is_presenter)?Da.DEMOTE:Da.PROMOTE}),a=await co("switchPresenter",e.toBinary(),!1,"application/protobuf","arraybuffer"),o=Va.fromBinary(new Uint8Array(a));o.status?(0,l.Am)(r("left-panel.menus.notice.presenter-changed"),{toastId:"lock-setting-status",type:"info"}):(0,l.Am)(r(o.msg),{toastId:"lock-setting-status",type:"error"})})(),children:(null===t||void 0===t?void 0:t.metadata.is_presenter)?r("footer.icons.demote-presenter"):r("footer.icons.promote-presenter")})})})},Qi=({userId:e})=>{const t=kr((t=>E.selectById(t,e))),r=yr(),{t:a}=(0,m.$G)();return(0,o.jsx)(o.Fragment,{children:(null===t||void 0===t?void 0:t.metadata.raised_hand)?(0,o.jsx)("div",{className:"",role:"none",children:(0,o.jsx)(ia.v.Item,{children:()=>(0,o.jsx)("button",{className:"text-gray-900 dark:text-darkText group flex rounded-md items-center text-left w-full px-2 py-[0.4rem] text-xs lg:text-sm transition ease-in hover:bg-primaryColor hover:text-white",onClick:()=>(async()=>{const e=br.getState().session,o=new Qa({roomSid:e.currentRoom.sid,roomId:e.currentRoom.room_id,msgBodyType:Oa.OTHER_USER_LOWER_HAND,msg:null===t||void 0===t?void 0:t.userId}),s=await co("dataMessage",o.toBinary(),!1,"application/protobuf","arraybuffer"),i=Va.fromBinary(new Uint8Array(s));i.status?r(ce(!1)):(0,l.Am)(a(i.msg),{type:"error"})})(),children:a("footer.icons.lower-hand")})})}):null})},Yi=({userId:e})=>{var t;const r=null===(t=br.getState().session.currentRoom.metadata)||void 0===t?void 0:t.room_features,{t:a}=(0,m.$G)(),s=kr((t=>E.selectById(t,e))),i=async e=>{const t=s.metadata,r=br.getState().session,o=e;let i="lock";switch(e){case"mic":i=(null===t||void 0===t?void 0:t.lock_settings.lock_microphone)?"unlock":"lock";break;case"webcam":i=(null===t||void 0===t?void 0:t.lock_settings.lock_webcam)?"unlock":"lock";break;case"screenShare":i=(null===t||void 0===t?void 0:t.lock_settings.lock_screen_sharing)?"unlock":"lock";break;case"whiteboard":i=(null===t||void 0===t?void 0:t.lock_settings.lock_whiteboard)?"unlock":"lock";break;case"sharedNotepad":i=(null===t||void 0===t?void 0:t.lock_settings.lock_shared_notepad)?"unlock":"lock";break;case"chat":i=(null===t||void 0===t?void 0:t.lock_settings.lock_chat)?"unlock":"lock";break;case"sendChatMsg":i=(null===t||void 0===t?void 0:t.lock_settings.lock_chat_send_message)?"unlock":"lock";break;case"chatFile":i=(null===t||void 0===t?void 0:t.lock_settings.lock_chat_file_share)?"unlock":"lock"}const n=new io({roomSid:r.currentRoom.sid,roomId:r.currentRoom.room_id,userId:null===s||void 0===s?void 0:s.userId,service:o,direction:i}),d=await co("updateLockSettings",n.toBinary(),!1,"application/protobuf","arraybuffer"),c=Va.fromBinary(new Uint8Array(d));c.status?(0,l.Am)(a("left-panel.menus.notice.applied-new-setting"),{toastId:"lock-setting-status",type:"info"}):(0,l.Am)(a(c.msg),{type:"error"})};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"",role:"none",children:(0,o.jsx)(ia.v.Item,{children:()=>(0,o.jsx)("button",{className:"text-gray-900 dark:text-darkText group flex rounded-md items-center text-left w-full px-2 py-[0.4rem] text-xs lg:text-sm transition ease-in hover:bg-primaryColor hover:text-white",onClick:()=>i("mic"),children:(null===s||void 0===s?void 0:s.metadata.lock_settings.lock_microphone)?a("left-panel.menus.items.unlock-microphone"):a("left-panel.menus.items.lock-microphone")})})}),(null===r||void 0===r?void 0:r.allow_webcams)&&!(null===r||void 0===r?void 0:r.admin_only_webcams)?(0,o.jsx)("div",{className:"",role:"none",children:(0,o.jsx)(ia.v.Item,{children:()=>(0,o.jsx)("button",{className:"text-gray-900 dark:text-darkText group flex rounded-md items-center text-left w-full px-2 py-[0.4rem] text-xs lg:text-sm transition ease-in hover:bg-primaryColor hover:text-white",onClick:()=>i("webcam"),children:(null===s||void 0===s?void 0:s.metadata.lock_settings.lock_webcam)?a("left-panel.menus.items.unlock-webcam"):a("left-panel.menus.items.lock-webcam")})})}):null,(null===r||void 0===r?void 0:r.allow_screen_share)?(0,o.jsx)("div",{className:"",role:"none",children:(0,o.jsx)(ia.v.Item,{children:()=>(0,o.jsx)("button",{className:"text-gray-900 dark:text-darkText group flex rounded-md items-center text-left w-full px-2 py-[0.4rem] text-xs lg:text-sm transition ease-in hover:bg-primaryColor hover:text-white",onClick:()=>i("screenShare"),children:(null===s||void 0===s?void 0:s.metadata.lock_settings.lock_screen_sharing)?a("left-panel.menus.items.unlock-screen-sharing"):a("left-panel.menus.items.lock-screen-sharing")})})}):null,(null===r||void 0===r?void 0:r.whiteboard_features.allowed_whiteboard)?(0,o.jsx)("div",{className:"",role:"none",children:(0,o.jsx)(ia.v.Item,{children:()=>(0,o.jsx)("button",{className:"text-gray-900 dark:text-darkText group flex rounded-md items-center text-left w-full px-2 py-[0.4rem] text-xs lg:text-sm transition ease-in hover:bg-primaryColor hover:text-white",onClick:()=>i("whiteboard"),children:(null===s||void 0===s?void 0:s.metadata.lock_settings.lock_whiteboard)?a("left-panel.menus.items.unlock-whiteboard"):a("left-panel.menus.items.lock-whiteboard")})})}):null,(null===r||void 0===r?void 0:r.shared_note_pad_features.allowed_shared_note_pad)?(0,o.jsx)("div",{className:"",role:"none",children:(0,o.jsx)(ia.v.Item,{children:()=>(0,o.jsx)("button",{className:"text-gray-900 dark:text-darkText group flex rounded-md items-center text-left w-full px-2 py-[0.4rem] text-xs lg:text-sm transition ease-in hover:bg-primaryColor hover:text-white",onClick:()=>i("sharedNotepad"),children:(null===s||void 0===s?void 0:s.metadata.lock_settings.lock_shared_notepad)?a("left-panel.menus.items.unlock-shared-notepad"):a("left-panel.menus.items.lock-shared-notepad")})})}):null,(null===r||void 0===r?void 0:r.chat_features.allow_chat)?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"",role:"none",children:(0,o.jsx)(ia.v.Item,{children:()=>(0,o.jsx)("button",{className:"text-gray-900 dark:text-darkText group flex rounded-md items-center text-left w-full px-2 py-[0.4rem] text-xs lg:text-sm transition ease-in hover:bg-primaryColor hover:text-white",onClick:()=>i("chat"),children:(null===s||void 0===s?void 0:s.metadata.lock_settings.lock_chat)?a("left-panel.menus.items.unlock-chat"):a("left-panel.menus.items.lock-chat")})})}),(0,o.jsx)("div",{className:"",role:"none",children:(0,o.jsx)(ia.v.Item,{children:()=>(0,o.jsx)("button",{className:"text-gray-900 dark:text-darkText group flex rounded-md items-center text-left w-full px-2 py-[0.4rem] text-xs lg:text-sm transition ease-in hover:bg-primaryColor hover:text-white",onClick:()=>i("sendChatMsg"),children:(null===s||void 0===s?void 0:s.metadata.lock_settings.lock_chat_send_message)?a("left-panel.menus.items.unlock-send-chat-message"):a("left-panel.menus.items.lock-send-chat-message")})})}),r.chat_features.allow_file_upload?(0,o.jsx)("div",{className:"",role:"none",children:(0,o.jsx)(ia.v.Item,{children:()=>(0,o.jsx)("button",{className:"text-gray-900 dark:text-darkText group flex rounded-md items-center text-left w-full px-2 py-[0.4rem] text-xs lg:text-sm transition ease-in hover:bg-primaryColor hover:text-white",onClick:()=>i("chatFile"),children:(null===s||void 0===s?void 0:s.metadata.lock_settings.lock_chat_file_share)?a("left-panel.menus.items.unlock-send-file"):a("left-panel.menus.items.lock-send-file")})})}):null]}):null]})},Xi=({userId:e,onOpenAlert:t})=>{const{t:r}=(0,m.$G)();return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("div",{className:"",role:"none",children:(0,o.jsx)(ia.v.Item,{children:()=>(0,o.jsx)("button",{className:"text-red-900 group flex rounded-md items-center text-left w-full px-2 py-[0.4rem] text-xs lg:text-sm transition ease-in hover:bg-red-400 hover:text-white",onClick:()=>{t(e,"remove")},children:r("left-panel.menus.items.remove-participant")})})})})})},Ki=({name:e,userId:t})=>{const r=yr(),{t:a}=(0,m.$G)();return(0,o.jsx)("div",{className:"",role:"none",children:(0,o.jsx)(ia.v.Item,{children:()=>(0,o.jsx)("button",{className:"text-gray-900 dark:text-darkText group flex rounded-md items-center text-left w-full px-2 py-[0.4rem] text-xs lg:text-sm transition ease-in hover:bg-primaryColor hover:text-white",onClick:()=>(r(le(!0)),r(ot({name:e,userId:t})),void r(at(t))),children:a("left-panel.menus.items.private-chat")})})})},Zi=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.default_lock_settings}),(e=>e)),en=({userId:e,name:t,isAdmin:r,openRemoveParticipantAlert:a})=>{const s=kr(Zi),i=br.getState().session.currentUser,n=()=>{var n,l;return(null===(n=null===i||void 0===i?void 0:i.metadata)||void 0===n?void 0:n.is_admin)?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(qi,{userId:e}),(0,o.jsx)($i,{userId:e}),(0,o.jsx)(Ki,{userId:e,name:t}),(0,o.jsx)(zi,{userId:e}),(0,o.jsx)(Qi,{userId:e}),(0,o.jsx)(Yi,{userId:e}),(0,o.jsx)(Xi,{onOpenAlert:a,userId:e})]}):(null===(l=null===i||void 0===i?void 0:i.metadata)||void 0===l?void 0:l.is_admin)||(null===s||void 0===s?void 0:s.lock_chat)||(null===s||void 0===s?void 0:s.lock_private_chat)?!(null===s||void 0===s?void 0:s.lock_chat)&&(null===s||void 0===s?void 0:s.lock_private_chat)&&r?(0,o.jsx)(Ki,{userId:e,name:t}):null:(0,o.jsx)(Ki,{userId:e,name:t})};return(0,o.jsx)(o.Fragment,{children:null!==n()?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(ia.v,{children:({open:e})=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ia.v.Button,{className:"relative flex-shrink-0 mt-2",children:(0,o.jsx)("i",{className:"pnm-menu-small primaryColor dark:text-secondaryColor opacity-50"})}),(0,o.jsx)(Sr.u,{show:e,enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100 z-10",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:(0,o.jsx)(ia.v.Items,{static:!0,className:"origin-top-right z-10 absolute right-0 mt-2 w-44 rounded-md shadow-lg bg-white dark:bg-darkPrimary ring-1 ring-black dark:ring-secondaryColor ring-opacity-5 divide-y divide-gray-100 dark:divide-secondaryColor focus:outline-none",children:n()})})]})})}):null})},tn=({userId:e})=>{const t=kr((t=>E.selectById(t,e))),r=(0,s.useMemo)((()=>"hidden"===(null===t||void 0===t?void 0:t.visibility)?(0,o.jsx)("div",{className:"visibility mr-2 cursor-pointer mt-[2px]",children:(0,o.jsx)("i",{className:"pnm-eye-slash secondaryColor text-xs"})}):null),[null===t||void 0===t?void 0:t.visibility]);return(0,o.jsx)(o.Fragment,{children:r})},rn=({userId:e})=>{const t=kr((t=>E.selectById(t,e))),r=(0,s.useMemo)((()=>(null===t||void 0===t?void 0:t.metadata.is_presenter)?(0,o.jsx)("div",{className:"presenter mr-2 cursor-pointer",children:(0,o.jsx)("i",{className:"pnm-presenter secondaryColor text-[10px]"})}):null),[null===t||void 0===t?void 0:t.metadata.is_presenter]);return(0,o.jsx)(o.Fragment,{children:r})},an=({userId:e,name:t,openRemoveParticipantAlert:r})=>{const a=kr((t=>E.selectById(t,e))),{t:i}=(0,m.$G)(),n=async()=>{const r=new oo({userId:e}),a=await co("waitingRoom/approveUsers",r.toBinary(),!1,"application/protobuf","arraybuffer"),o=Va.fromBinary(new Uint8Array(a));o.status?(0,l.Am)(i("left-panel.menus.notice.user-approved",{name:t}),{type:"info"}):(0,l.Am)(i(o.msg),{type:"error"})},d=()=>{r(e,"reject")},c=(0,s.useMemo)((()=>(null===a||void 0===a?void 0:a.metadata.wait_for_approval)?(0,o.jsxs)("div",{className:"approve-btn-wrap",children:[(0,o.jsx)("button",{className:"text-xs text-white py-[1px] px-2 rounded-lg transition ease-in bg-primaryColor hover:bg-secondaryColor",onClick:n,children:i("left-panel.approve")}),(0,o.jsx)("button",{className:"text-xs text-white py-[1px] px-2 rounded-lg transition ease-in bg-red-600 hover:bg-red-800 ml-2",onClick:d,children:i("left-panel.reject")})]}):null),[null===a||void 0===a?void 0:a.metadata.wait_for_approval]);return(0,o.jsx)(o.Fragment,{children:c})},on=({participant:e,isRemoteParticipant:t,openRemoveParticipantAlert:r})=>{var a;const s=br.getState().session.currentUser,i=(t,a)=>{t===e.userId&&r(e.name,t,a)};return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"flex items-center justify-between relative",children:[(0,o.jsxs)("div",{className:"left flex items-center ",children:[(0,o.jsx)(Ui,{participant:e}),(0,o.jsx)(Wi,{name:e.name,isCurrentUser:(null===s||void 0===s?void 0:s.userId)===e.userId})]}),(0,o.jsxs)("div",{className:"right ml-2 flex-auto flex items-center justify-end",children:[(0,o.jsx)(Gi,{userId:e.userId}),(0,o.jsx)(tn,{userId:e.userId}),(0,o.jsx)(rn,{userId:e.userId}),(0,o.jsx)(Vi,{userId:e.userId}),(0,o.jsx)(Hi,{userId:e.userId}),(0,o.jsx)(Ji,{userId:e.userId,isRemoteParticipant:t}),(null===s||void 0===s?void 0:s.userId)!==e.userId?(0,o.jsx)(en,{userId:e.userId,name:e.name,isAdmin:e.metadata.is_admin,openRemoveParticipantAlert:i}):null]}),(null===(a=null===s||void 0===s?void 0:s.metadata)||void 0===a?void 0:a.is_admin)?(0,o.jsx)("div",{className:"approve-wrap absolute right-0 top-5",children:(0,o.jsx)(an,{userId:e.userId,name:e.name,openRemoveParticipantAlert:i})}):null]})})},sn=({name:e,userId:t,removeType:r,closeAlertModal:a})=>{const{t:i}=(0,m.$G)(),[n,d]=(0,s.useState)(0),c=async(e=!1)=>{if(!e)return void a();const o=br.getState().session,s=new za({sid:o.currentRoom.sid,roomId:o.currentRoom.room_id,userId:t,msg:"remove"===r?i("notifications.you-have-removed").toString():i("notifications.you-have-reject").toString(),blockUser:1===n}),d=await co("removeParticipant",s.toBinary(),!1,"application/protobuf","arraybuffer"),c=Va.fromBinary(new Uint8Array(d));c.status?(0,l.Am)(i("left-panel.menus.notice.participant-removed"),{toastId:"user-remove-status",type:"info"}):(0,l.Am)(i(c.msg),{type:"error"}),a()};return(0,o.jsx)(Sr.u,{show:!0,enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:(0,o.jsx)(_r.V,{open:!0,onClose:()=>c(),className:"remove-participants-popup fixed z-[99999] inset-0 overflow-y-auto",children:(0,o.jsxs)("div",{className:"flex items-center justify-center min-h-screen",children:[(0,o.jsx)(_r.V.Overlay,{className:"fixed inset-0 bg-black opacity-30"}),(0,o.jsxs)("div",{className:"popup-inner bg-white dark:bg-darkPrimary w-full max-w-sm rounded-3xl shadow-header relative px-4 lg:px-6 py-12 lg:py-14",children:[(0,o.jsxs)("button",{className:"close-btn absolute top-8 right-6 w-[25px] h-[25px] outline-none",type:"button",onClick:()=>c(),children:[(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 rotate-45"}),(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 -rotate-45"})]}),(0,o.jsx)(_r.V.Title,{className:"mb-4 md:mb-6 text-sm",children:(0,o.jsx)("legend",{className:"text-base font-medium text-gray-900 dark:text-white",children:i("left-panel.menus.notice.confirm",{name:e})})}),(0,o.jsxs)("div",{className:"mb-10 pl-3",children:[(0,o.jsx)("p",{className:"text-sm text-gray-500 dark:text-darkText",children:i("left-panel.menus.notice.want-to-block")}),(0,o.jsxs)("div",{className:"mt-4 pl-2 space-y-4",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("input",{type:"radio",value:"1",name:"block",id:"yes",checked:1===n,onChange:e=>d(Number(e.currentTarget.value))}),(0,o.jsx)("label",{htmlFor:"yes",className:"ml-3 block text-sm font-medium text-gray-700 dark:text-darkText",children:i("yes")})]}),(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("input",{type:"radio",value:"0",name:"block",id:"no",checked:0===n,onChange:e=>d(Number(e.currentTarget.value))}),(0,o.jsx)("label",{htmlFor:"no",className:"ml-3 block text-sm font-medium text-gray-700 dark:text-darkText",children:i("no")})]})]})]}),(0,o.jsx)("button",{className:"inline-flex justify-center px-4 py-2 text-xs md:text-sm font-medium text-white bg-red-600 mr-4 border border-transparent rounded-md hover:bg-red-700 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500",onClick:()=>c(!0),children:i("left-panel.menus.notice.remove")}),(0,o.jsx)("button",{className:"inline-flex justify-center px-4 py-2 text-xs md:text-sm font-medium bg-primaryColor hover:bg-secondaryColor text-white border border-transparent rounded-md focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-blue-500",onClick:()=>c(!1),children:i("cancel")})]})]})})})},nn=(0,wr.P1)((e=>e.bottomIconsActivity.screenHeight),(e=>e)),ln=()=>{var e,t,r,a,i,n,l;const{t:d}=(0,m.$G)(),c=kr(E.selectAll),u=kr(nn),[p,h]=(0,s.useState)([]),{outerRef:x,innerRef:f,items:g}=(0,Bi.Z)({itemCount:p.length}),[v,b]=(0,s.useState)(),y=br.getState().session,k=null===(e=y.currentUser)||void 0===e?void 0:e.userId,w=null!==(a=null===(r=null===(t=y.currentRoom.metadata)||void 0===t?void 0:t.room_features)||void 0===r?void 0:r.allow_view_other_users_list)&&void 0!==a&&a,T=null!==(l=null===(n=null===(i=y.currentUser)||void 0===i?void 0:i.metadata)||void 0===n?void 0:n.is_admin)&&void 0!==l&&l;(0,s.useEffect)((()=>{c&&h(c.filter((e=>""!==e.name&&"RECORDER_BOT"!==e.userId&&"RTMP_BOT"!==e.userId)))}),[c]);const j=(e,t,r)=>{b({name:e,userId:t,removeType:r})},S=e=>{if(!p.length||"undefined"===typeof p[e])return null;const t=p[e],r=k!==t.userId;return T||w||t.metadata.is_admin||k===t.userId?(0,o.jsx)(on,{participant:t,isRemoteParticipant:r,openRemoveParticipantAlert:j},t.sid):null};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"inner-wrapper relative z-20",children:[(0,o.jsx)("div",{className:"top flex items-center justify-between font-medium mb-3 xl:mb-5",children:(0,o.jsx)("p",{className:"text-sm text-black dark:text-white",children:d("left-panel.participants",{total:p.length})})}),(0,o.jsx)("div",{ref:x,style:{height:u-215,overflow:"auto"},className:"-mx-2 xl:-mx-4 scrollBar",children:(0,o.jsx)("div",{className:"all-participants-wrap px-2 xl:px-4",ref:f,children:g.map((({index:e,measureRef:t})=>(0,o.jsx)("li",{ref:t,className:"mb-3 w-full list-none",children:S(e)},e)))})})]}),v?(0,o.jsx)(sn,{name:v.name,userId:v.userId,removeType:v.removeType,closeAlertModal:()=>{b(void 0)}}):null]})},dn=()=>{const{t:e}=(0,m.$G)(),[t,r]=(0,s.useState)(!1),[a,i]=(0,s.useState)(""),[n,{isLoading:d,data:c}]=$t(),[u,p]=(0,s.useState)([{id:1,text:""},{id:2,text:""}]);(0,s.useEffect)((()=>{!d&&c&&(c.status?(0,l.Am)(e("polls.created-successfully"),{type:"info"}):(0,l.Am)(e(c.msg),{type:"error"}),h())}),[d,c]);const h=()=>{r(!1),i(""),p([{id:1,text:""},{id:2,text:""}])},x=e=>{e.preventDefault();const t=new Pt({question:a,options:u});n(t)},f=()=>(0,o.jsxs)("form",{onSubmit:x,children:[(0,o.jsx)("label",{className:"text-base text-black dark:text-darkText block mb-1",children:e("polls.enter-question")}),(0,o.jsx)("input",{type:"text",name:"question",value:a,required:!0,onChange:e=>i(e.currentTarget.value),placeholder:"Ask a question",className:"text-black placeholder:text-black/50 py-2 px-4 text-base w-full border border-solid border-primaryColor outline-none rounded-lg mb-4 bg-transparent dark:border-darkText dark:text-darkText placeholder:text-darkText"}),(0,o.jsxs)("div",{className:"flex items-start justify-between pb-2 pt-4 border-t border-solid border-primaryColor/20 dark:border-darkText/30",children:[(0,o.jsx)("p",{className:"text-lg text-black dark:text-darkText block leading-4",children:e("polls.options")}),(0,o.jsx)("button",{className:"h-7 px-3 leading-[28px] text-center transition ease-in bg-primaryColor hover:bg-secondaryColor text-white text-sm font-semibold rounded-lg",type:"button",onClick:()=>(()=>{const e=[...u],t={id:e[e.length-1].id+1,text:""};e.push(t),p([...e])})(),children:e("polls.add-new-option")})]}),(0,o.jsx)("div",{className:"option-field-wrapper overflow-auto h-full max-h-[345px] scrollBar scrollBar2",children:(0,o.jsxs)("div",{className:"option-field-inner",children:[u.map(((t,r)=>(0,o.jsx)("div",{className:"form-inline mb-4",children:(0,o.jsxs)("div",{className:"input-wrapper w-full flex items-center",children:[(0,o.jsx)("input",{type:"text",required:!0,name:`opt_${t.id}`,value:t.text,onChange:e=>((e,t)=>{const r=[...u];r[e].text=t.currentTarget.value,p([...r])})(r,e),placeholder:e("polls.option",{count:r+1}).toString(),className:"text-black placeholder:text-black/50 py-2 px-4 text-base w-[calc(100%-36px)] border border-solid border-primaryColor outline-none rounded-lg bg-transparent dark:text-darkText dark:border-darkText placeholder:text-darkText"}),r?(0,o.jsx)("button",{type:"button",className:"ml-2 p-1",onClick:()=>(e=>{const t=[...u];t.splice(e,1),p([...t])})(r),children:(0,o.jsx)("i",{className:"pnm-delete w-5 h-5 dark:text-secondaryColor"})}):null]})},t.id))),d?(0,o.jsx)("div",{className:"loading absolute text-center top-1/2 -translate-y-1/2 z-[999] left-0 right-0 m-auto",children:(0,o.jsxs)("div",{className:"lds-ripple",children:[(0,o.jsx)("div",{className:"border-secondaryColor"}),(0,o.jsx)("div",{className:"border-secondaryColor"})]})}):null]})}),(0,o.jsx)("div",{className:"button-section flex items-center justify-end",children:(0,o.jsx)("button",{className:"h-8 px-6 leading-[32px] text-center transition ease-in bg-primaryColor hover:bg-secondaryColor text-white text-base font-semibold rounded-lg",type:"submit",children:e("polls.create-poll")})})]});return(0,o.jsxs)(o.Fragment,{children:[t?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(Sr.u,{appear:!0,show:t,as:s.Fragment,children:(0,o.jsx)(_r.V,{as:"div",className:"fixed inset-0 z-[9999] overflow-y-auto",onClose:()=>!1,children:(0,o.jsxs)("div",{className:"min-h-screen px-4 text-center",children:[(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,o.jsx)(_r.V.Overlay,{className:"fixed inset-0 bg-black opacity-30"})}),(0,o.jsx)("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"\u200b"}),(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,o.jsxs)("div",{className:"inline-block w-full max-w-lg p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white dark:bg-darkPrimary shadow-xl rounded-2xl",children:[(0,o.jsxs)("button",{className:"close-btn absolute top-8 right-6 w-[25px] h-[25px] outline-none",type:"button",onClick:()=>h(),children:[(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 rotate-45"}),(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 -rotate-45"})]}),(0,o.jsx)(_r.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-white text-left mb-2",children:e("polls.create")}),(0,o.jsx)("hr",{}),(0,o.jsx)("div",{className:"mt-6",children:f()})]})})]})})})}):null,(0,o.jsx)("button",{onClick:()=>r(!0),className:"w-[calc(100%-20px)] ml-[10px] h-10 leading-[40px] text-center transition ease-in bg-primaryColor hover:bg-secondaryColor text-white text-base font-semibold rounded-lg mb-2",children:e("polls.create")})]})},cn=({pollId:e})=>{const{data:t,isLoading:r}=Vt(e),[a,i]=(0,s.useState)(0),{t:n}=(0,m.$G)();return(0,s.useEffect)((()=>{var e;!r&&t&&t.status&&i(null!==(e=Number(t.totalResponses))&&void 0!==e?e:0)}),[t,r]),(0,o.jsxs)("div",{className:"total-vote rounded-bl-lg bg-secondaryColor absolute top-0 right-0 text-white text-[10px] py-1 px-3 uppercase",children:[(0,o.jsxs)("strong",{children:[n("polls.total"),": "]})," ",a]})},un=({onCloseForm:e,pollId:t})=>{const{t:r}=(0,m.$G)(),[a,i]=(0,s.useState)(!0),[n,d]=(0,s.useState)(0),[c,{isLoading:u,data:p}]=zt(),{post:h}=Jt(void 0,{selectFromResult:({data:e})=>({post:null===e||void 0===e?void 0:e.polls.find((e=>e.id===t))})});(0,s.useEffect)((()=>{!u&&p&&(p.status?(0,l.Am)(r("polls.response-added"),{type:"info"}):(0,l.Am)(r(p.msg),{type:"error"}),x())}),[u,p]);const x=()=>{i(!1),e()},f=e=>{var r,a,o,s;e.preventDefault(),0!==n&&c(new Ot({pollId:t,userId:null!==(a=null===(r=br.getState().session.currentUser)||void 0===r?void 0:r.userId)&&void 0!==a?a:"",name:null!==(s=null===(o=br.getState().session.currentUser)||void 0===o?void 0:o.name)&&void 0!==s?s:"",selectedOption:BigInt(n)}))};return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(Sr.u,{appear:!0,show:a,as:s.Fragment,children:(0,o.jsx)(_r.V,{as:"div",className:"fixed inset-0 z-[9999] overflow-y-auto",onClose:()=>!1,children:(0,o.jsxs)("div",{className:"min-h-screen px-4 text-center",children:[(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,o.jsx)(_r.V.Overlay,{className:"fixed inset-0 bg-black opacity-30"})}),(0,o.jsx)("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"\u200b"}),(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,o.jsxs)("div",{className:"inline-block w-full max-w-lg p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white dark:bg-darkPrimary shadow-xl rounded-2xl",children:[(0,o.jsxs)("button",{className:"close-btn absolute top-8 right-6 w-[25px] h-[25px] outline-none",type:"button",onClick:()=>x(),children:[(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 rotate-45"}),(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 -rotate-45"})]}),(0,o.jsx)(_r.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-white text-left mb-2",children:r("polls.submit-vote-form-title")}),(0,o.jsx)("hr",{}),(0,o.jsx)("div",{className:"mt-2",children:(0,o.jsxs)("form",{onSubmit:f,children:[(0,o.jsxs)("label",{className:"text-base text-black dark:text-darkText block mb-2 pb-1 border-b border-solid border-primaryColor/20 dark:border-darkText/20",children:[(0,o.jsx)("span",{className:"text-primaryColor dark:text-secondaryColor",children:"Q:"}),null===h||void 0===h?void 0:h.question]}),(0,o.jsxs)("div",{className:"",children:[(0,o.jsx)("p",{className:"text-base text-black dark:text-white block mb-2 pb-1 border-b border-solid border-primaryColor/20 dark:border-darkText/20",children:r("polls.select-option")}),(0,o.jsxs)("div",{className:"mb-2 relative min-h-[75px]",children:[null===h||void 0===h?void 0:h.options.map((e=>(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("input",{type:"radio",id:`option-${e.id}`,value:e.id,name:`option-${e.id}`,checked:n===e.id,onChange:e=>d(Number(e.currentTarget.value))}),(0,o.jsx)("label",{className:"ml-2 dark:text-darkText",htmlFor:`option-${e.id}`,children:e.text})]},e.id))),u?(0,o.jsx)("div",{className:"loading absolute text-center top-1/2 -translate-y-1/2 z-[999] left-0 right-0 m-auto",children:(0,o.jsxs)("div",{className:"lds-ripple",children:[(0,o.jsx)("div",{className:"border-secondaryColor"}),(0,o.jsx)("div",{className:"border-secondaryColor"})]})}):null]})]}),(0,o.jsx)("div",{className:"button-section flex items-center justify-end",children:(0,o.jsx)("button",{className:"h-7 px-6 leading-[28px] text-center transition ease-in bg-primaryColor hover:bg-secondaryColor text-white text-base font-semibold rounded-lg",type:"submit",children:r("polls.submit")})})]})})]})})]})})})})},mn=({pollId:e})=>{var t;const{t:r}=(0,m.$G)(),{data:a,isLoading:i}=Ht({pollId:e,userId:(null===(t=br.getState().session.currentUser)||void 0===t?void 0:t.userId)||""}),[n,l]=(0,s.useState)(!1),[d,c]=(0,s.useState)(!1);(0,s.useEffect)((()=>{!i&&a&&a.status&&l(!!(a.voted&&a.voted>0))}),[a,i]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"has-voted",children:n?(0,o.jsx)("p",{className:"absolute left-2 bottom-2 text-xs dark:text-white",children:r("polls.you-voted")}):(0,o.jsx)("button",{className:"absolute left-0 bottom-0 transition ease-in bg-primaryColor hover:bg-secondaryColor text-[10px] text-white pt-1 pb-[2px] px-3 uppercase rounded-tr-lg",onClick:()=>{c(!0)},children:r("polls.vote")})}),d?(0,o.jsx)(un,{onCloseForm:()=>{c(!1)},pollId:e}):null]})};var pn=r(7762);const hn=({pollId:e,onCloseViewDetails:t})=>{const[r,a]=(0,s.useState)(!0),{t:i}=(0,m.$G)(),{post:n}=Jt(void 0,{selectFromResult:({data:t})=>({post:null===t||void 0===t?void 0:t.polls.find((t=>t.id===e))})}),{data:d}=qt(e),[c,{isLoading:u,data:p}]=Qt(),h=(0,s.useMemo)((()=>{const e={};if((null===d||void 0===d?void 0:d.responses.all_respondents)&&""!==(null===d||void 0===d?void 0:d.responses.all_respondents)){JSON.parse(null===d||void 0===d?void 0:d.responses.all_respondents).forEach((t=>{const r=t.split(":");"undefined"===typeof e[r[1]]&&(e[r[1]]=[]),e[r[1]].push(r[2])}))}return e}),[d]);(0,s.useEffect)((()=>{!u&&p&&(p.status?(0,l.Am)(i("polls.end-poll-success"),{type:"info"}):(0,l.Am)(i(p.msg),{type:"error"}))}),[u,p]);const x=()=>{a(!1),t()},f=()=>{c(new Dt({pollId:e}))},g=e=>"undefined"!==typeof(null===d||void 0===d?void 0:d.responses[e+"_count"])?null===d||void 0===d?void 0:d.responses[e+"_count"]:0;return(0,o.jsx)(o.Fragment,{children:r?(()=>{var e;return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(Sr.u,{appear:!0,show:r,as:s.Fragment,children:(0,o.jsx)(_r.V,{as:"div",className:"fixed inset-0 z-[9999] overflow-y-auto",onClose:()=>!1,children:(0,o.jsxs)("div",{className:"min-h-screen px-4 text-center",children:[(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,o.jsx)(_r.V.Overlay,{className:"fixed inset-0 bg-black opacity-30"})}),(0,o.jsx)("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"\u200b"}),(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,o.jsxs)("div",{className:"inline-block w-full max-w-lg p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white dark:bg-darkPrimary shadow-xl rounded-2xl",children:[(0,o.jsxs)("button",{className:"close-btn absolute top-8 right-6 w-[25px] h-[25px] outline-none",type:"button",onClick:()=>x(),children:[(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 rotate-45"}),(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 -rotate-45"})]}),(0,o.jsx)(_r.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-white text-left mb-2",children:i("polls.view-details-title")}),(0,o.jsx)("hr",{}),(0,o.jsxs)("div",{className:"mt-2",children:[(0,o.jsxs)("div",{className:"headline flex flex-wrap pb-5",children:[(0,o.jsxs)("p",{className:"w-full text-lg font-bold text-black dark:text-darkText capitalize mb-2 pb-1 border-b border-solid border-primaryColor/20 dark:border-darkText/20",children:[(0,o.jsxs)("span",{className:"text-primaryColor dark:text-secondaryColor",children:["Q:"," "]}),null===n||void 0===n?void 0:n.question]}),(0,o.jsx)("p",{className:"w-full text-base dark:text-darkText",children:i("polls.total-responses",{count:null!==(e=null===d||void 0===d?void 0:d.responses.total_resp)&&void 0!==e?e:0})})]}),(0,o.jsxs)("div",{className:"",children:[(0,o.jsx)("p",{className:"text-base text-black dark:text-darkText block mb-2 pb-1 border-b border-solid border-primaryColor/20 dark:border-darkText/20",children:i("polls.options")}),(0,o.jsxs)("div",{className:"relative min-h-[75px]",children:[null===n||void 0===n?void 0:n.options.map((e=>(0,o.jsx)("div",{className:"mb-1",children:(0,o.jsx)(Rs.p,{children:({open:t})=>{return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(Rs.p.Button,{className:"flex w-full justify-between rounded-lg transition ease-in bg-secondaryColor px-4 py-2 text-left text-sm font-medium text-white hover:bg-primaryColor outline-none",children:[(0,o.jsxs)("span",{children:[e.text," (",g(e.id),")"]}),(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:(t?"rotate-180 transform":"")+" h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 9l-7 7-7-7"})})]}),(0,o.jsx)(Rs.p.Panel,{className:"px-4 py-2 text-sm text-gray-500 dark:text-darkText",children:(r=e.id,"undefined"!==typeof h[r]?h[r].map(((e,t)=>(0,o.jsx)("p",{className:"inline-block pr-2 mr-2 border-r border-solid border-black leading-4 last:border-none last:mr-0 last:pr-0",children:e},t))):null)})]});var r}})},e.id))),u?(0,o.jsx)("div",{className:"loading absolute text-center top-1/2 -translate-y-1/2 z-[999] left-0 right-0 m-auto",children:(0,o.jsxs)("div",{className:"lds-ripple",children:[(0,o.jsx)("div",{className:"border-secondaryColor"}),(0,o.jsx)("div",{className:"border-secondaryColor"})]})}):null]})]}),(0,o.jsx)("div",{className:"pt-10 text-right",children:(null===n||void 0===n?void 0:n.isRunning)?(0,o.jsx)("button",{className:"inline-flex justify-center px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none",onClick:f,children:i("polls.end-poll")}):(0,o.jsx)("button",{className:"inline-flex justify-center px-3 py-1 text-sm font-medium text-white bg-primaryColor rounded-md hover:bg-secondaryColor focus:outline-none",onClick:()=>(()=>{var e,t,r,a,s,l;if(u)return;const c=null!==(e=null===d||void 0===d?void 0:d.responses.total_resp)&&void 0!==e?e:"0",m=br.getState().session,p=pn.renderToString((0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("p",{children:null===n||void 0===n?void 0:n.question}),(0,o.jsx)("p",{children:i("polls.total-responses",{count:c})}),null===n||void 0===n?void 0:n.options.map((e=>(0,o.jsx)("p",{children:`${e.text} (${g(e.id)})`},e.id)))]})),h=new Wa({type:Ma.USER,roomSid:m.currentRoom.sid,roomId:m.currentRoom.room_id,body:{type:Oa.CHAT,from:{sid:null!==(r=null===(t=m.currentUser)||void 0===t?void 0:t.sid)&&void 0!==r?r:"",userId:null!==(s=null===(a=m.currentUser)||void 0===a?void 0:a.userId)&&void 0!==s?s:"",name:null===(l=m.currentUser)||void 0===l?void 0:l.name},msg:p}});Wo(h.toBinary()),x()})(),children:i("polls.publish-result")})})]})]})})]})})})})})():null})},xn=({pollId:e,onCloseViewResult:t})=>{const[r,a]=(0,s.useState)(!0),{t:i}=(0,m.$G)(),{data:n,isLoading:l}=Yt(e);return(0,o.jsx)(o.Fragment,{children:r?(()=>{var e,d,c,u;return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(Sr.u,{appear:!0,show:r,as:s.Fragment,children:(0,o.jsx)(_r.V,{as:"div",className:"fixed inset-0 z-[9999] overflow-y-auto",onClose:()=>!1,children:(0,o.jsxs)("div",{className:"min-h-screen px-4 text-center",children:[(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,o.jsx)(_r.V.Overlay,{className:"fixed inset-0 bg-black opacity-30"})}),(0,o.jsx)("span",{className:"inline-block h-screen align-middle","aria-hidden":"true",children:"\u200b"}),(0,o.jsx)(Sr.u.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,o.jsxs)("div",{className:"inline-block w-full max-w-lg p-6 my-8 overflow-hidden text-left align-middle transition-all transform bg-white dark:bg-darkPrimary shadow-xl rounded-2xl",children:[(0,o.jsxs)("button",{className:"close-btn absolute top-8 right-6 w-[25px] h-[25px] outline-none",type:"button",onClick:()=>(a(!1),void t()),children:[(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 rotate-45"}),(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 -rotate-45"})]}),(0,o.jsx)(_r.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 dark:text-white text-left mb-2",children:i("polls.view-result-title")}),(0,o.jsx)("hr",{}),(0,o.jsxs)("div",{className:"mt-2",children:[(0,o.jsxs)("p",{className:"w-full text-lg font-bold text-black dark:text-darkText capitalize mb-2 pb-1 border-b border-solid border-primaryColor/20 dark:dark:border-darkText/20",children:[(0,o.jsxs)("span",{className:"text-primaryColor dark:text-secondaryColor",children:["Q:"," "]}),null===(e=null===n||void 0===n?void 0:n.pollResponsesResult)||void 0===e?void 0:e.question]}),(0,o.jsx)("p",{className:"w-full text-base dark:text-darkText",children:i("polls.total-responses",{count:Number(null===(d=null===n||void 0===n?void 0:n.pollResponsesResult)||void 0===d?void 0:d.totalResponses)})}),(0,o.jsxs)("div",{className:"pt-5",children:[(0,o.jsx)("p",{className:"text-base text-black dark:text-white block mb-2 pb-2 border-b border-solid border-primaryColor/20 dark:dark:border-darkText/20",children:i("polls.options")}),(0,o.jsxs)("div",{className:"relative min-h-[75px]",children:[null===(u=null===(c=null===n||void 0===n?void 0:n.pollResponsesResult)||void 0===c?void 0:c.options)||void 0===u?void 0:u.map((e=>(0,o.jsxs)("p",{className:"relative w-full flex items-center justify-between dark:text-darkText",children:[(0,o.jsx)("span",{className:"bg-white dark:bg-darkPrimary inline-block py-1 pr-2",children:e.text}),(0,o.jsxs)("span",{className:"bg-white dark:bg-darkPrimary inline-block py-1 pl-2",children:["(",Number(e.voteCount),")"]})]},Number(e.id)))),l?(0,o.jsx)("div",{className:"loading absolute text-center top-1/2 -translate-y-1/2 z-[999] left-0 right-0 m-auto",children:(0,o.jsxs)("div",{className:"lds-ripple",children:[(0,o.jsx)("div",{className:"border-secondaryColor"}),(0,o.jsx)("div",{className:"border-secondaryColor"})]})}):null]})]})]})]})})]})})})})})():null})},fn=({item:e})=>{var t,r;const{t:a}=(0,m.$G)(),i=null===(r=null===(t=br.getState().session.currentUser)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.is_admin,[n,l]=(0,s.useState)(!1),[d,c]=(0,s.useState)(!1);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"poll-title text-md text-primaryColor dark:text-darkText",children:e.question}),(0,o.jsx)(cn,{pollId:e.id}),(0,o.jsx)("div",{className:"status absolute top-0 left-0 bg-secondaryColor text-[10px] text-white py-1 px-3 uppercase rounded-br-lg",children:e.isRunning?a("polls.poll-running"):a("polls.poll-closed")}),(0,o.jsxs)("div",{className:"btn",children:[e.isRunning?(0,o.jsx)(mn,{pollId:e.id}):null,i?(0,o.jsx)("button",{onClick:()=>l(!0),className:"absolute right-0 bottom-0 transition ease-in bg-primaryColor hover:bg-secondaryColor text-[10px] text-white pt-1 pb-[2px] px-3 uppercase rounded-tl-lg",children:a("polls.view-details")}):null,i||e.isRunning?null:(0,o.jsx)("button",{onClick:()=>c(!0),className:"absolute right-0 bottom-0 transition ease-in bg-primaryColor hover:bg-secondaryColor text-[10px] text-white pt-1 pb-[2px] px-3 uppercase rounded-tl-lg",children:a("polls.view-result")})]}),(0,o.jsxs)(o.Fragment,{children:[i&&n?(0,o.jsx)(hn,{onCloseViewDetails:()=>l(!1),pollId:e.id}):null,i||e.isRunning||!d?null:(0,o.jsx)(xn,{onCloseViewResult:()=>c(!1),pollId:e.id})]})]})},gn=(0,wr.P1)((e=>e.bottomIconsActivity.screenHeight),(e=>e)),vn=()=>{var e,t;const r=kr(gn),{data:a,isLoading:i}=Jt(),n=null===(t=null===(e=br.getState().session.currentUser)||void 0===e?void 0:e.metadata)||void 0===t?void 0:t.is_admin,[l,d]=(0,s.useState)([]),{outerRef:c,innerRef:u,items:m}=(0,Bi.Z)({itemCount:l.length});(0,s.useEffect)((()=>{if(a&&a.polls){const e=a.polls.slice();e.sort(((e,t)=>Number(t.created)-Number(e.created))),d(e)}}),[a]);const p=e=>{if(!l.length||"undefined"===typeof l[e])return null;const t=l[e];return(0,o.jsx)(fn,{item:t},t.id)};return(0,o.jsx)("div",{className:"polls-list-wrapper relative overflow-auto scrollBar px-2 pt-2 xl:pt-3",style:{height:n?r-200:r-150},ref:c,children:(0,o.jsxs)("div",{className:"polls-list-wrap-inner",ref:u,children:[m.map((({index:e,measureRef:t})=>(0,o.jsx)("div",{ref:t,className:"poll-item relative overflow-hidden border border-solid border-primaryColor/70 px-2 py-8 rounded-lg mb-4 transition ease-in hover:shadow-md",children:p(e)},e))),i?(0,o.jsx)("div",{className:"loading absolute text-center top-1/2 -translate-y-1/2 z-[999] left-0 right-0 m-auto",children:(0,o.jsxs)("div",{className:"lds-ripple",children:[(0,o.jsx)("div",{className:"border-secondaryColor"}),(0,o.jsx)("div",{className:"border-secondaryColor"})]})}):null]})})},bn=()=>{var e,t;const r=null===(t=null===(e=br.getState().session.currentUser)||void 0===e?void 0:e.metadata)||void 0===t?void 0:t.is_admin;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(vn,{}),r?(0,o.jsx)(dn,{}):null]})},yn=()=>{var e,t;const{t:r}=(0,m.$G)(),{data:a,isLoading:i}=vr(void 0,{pollingInterval:1e4}),[n,{isLoading:d,data:c}]=hr(),[u,p]=(0,s.useState)(""),h=null!==(t=null===(e=br.getState().session.currentUser)||void 0===e?void 0:e.userId)&&void 0!==t?t:"";(0,s.useEffect)((()=>{var e;if(!d&&c){if(!c.status)return void(0,l.Am)(r(c.msg),{type:"error"});p(null!==(e=c.token)&&void 0!==e?e:"")}}),[d,c]),(0,s.useEffect)((()=>{if(""!==u){const e=new URLSearchParams(window.location.search);e.set("access_token",u);const t=location.protocol+"//"+location.host+window.location.pathname+"?"+e.toString();window.open(t,"_blank")}}),[u]);const x=()=>{var e,t,r,o;n(new nr({breakoutRoomId:null!==(t=null===(e=null===a||void 0===a?void 0:a.room)||void 0===e?void 0:e.id)&&void 0!==t?t:"",userId:null!==(o=null===(r=br.getState().session.currentUser)||void 0===r?void 0:r.userId)&&void 0!==o?o:""}))};return(0,o.jsx)("div",{className:"polls-list-wrapper relative overflow-auto scrollBar px-2 pt-2 xl:pt-3 h-full",children:(0,o.jsxs)("div",{className:"polls-list-wrap-inner",children:[(()=>{var e,t,s,i,n,l,c,u;return a?(0,o.jsxs)("div",{className:"poll-item relative overflow-hidden border border-solid border-primaryColor/70 dark:border-darkText/70 px-2 py-8 rounded-lg mb-4 transition ease-in hover:shadow-md",children:[(0,o.jsx)("div",{className:"poll-title text-md text-primaryColor dark:text-darkText",children:null===(e=a.room)||void 0===e?void 0:e.title}),(0,o.jsxs)("div",{className:"total-vote rounded-bl-lg bg-secondaryColor absolute top-0 right-0 text-white text-[10px] py-1 px-3 uppercase",children:[(0,o.jsxs)("strong",{children:[r("polls.total"),": "]})," ",null===(t=a.room)||void 0===t?void 0:t.users.length]}),(null===(s=a.room)||void 0===s?void 0:s.started)?(0,o.jsx)("div",{className:"status absolute top-0 left-0 text-[10px] text-white",children:(0,o.jsx)(Ps,{duration:null!==(n=null===(i=a.room)||void 0===i?void 0:i.duration)&&void 0!==n?n:5,created:null!==(c=null===(l=a.room)||void 0===l?void 0:l.created)&&void 0!==c?c:Date.now()})}):(0,o.jsx)("div",{className:"status absolute top-0 left-0 bg-secondaryColor text-[10px] text-white py-1 px-3 uppercase rounded-br-lg",children:r("breakout-room.not-started")}),(0,o.jsxs)("div",{className:"btn",children:[(0,o.jsx)("p",{className:"absolute left-2 bottom-2 text-xs dark:text-secondaryColor",children:(null===(u=a.room)||void 0===u?void 0:u.users.filter((e=>!0===e.joined&&e.id===h)).length)?r("breakout-room.user-joined"):r("breakout-room.not-joined")}),(0,o.jsx)("button",{onClick:x,className:"absolute right-0 bottom-0 transition ease-in bg-primaryColor hover:bg-secondaryColor text-[10px] text-white pt-1 pb-[2px] px-3 uppercase rounded-tl-lg",disabled:!!d,children:r("breakout-room.join")})]})]}):null})(),i?(0,o.jsx)("div",{className:"loading absolute text-center top-1/2 -translate-y-1/2 z-[999] left-0 right-0 m-auto",children:(0,o.jsxs)("div",{className:"lds-ripple",children:[(0,o.jsx)("div",{className:"border-secondaryColor"}),(0,o.jsx)("div",{className:"border-secondaryColor"})]})}):null]})})},kn=(0,wr.P1)((e=>e.roomSettings.selectedTabLeftPanel),(e=>e)),wn=s.memo((()=>{var e;const{data:t}=Xt(),{data:r}=vr(),{t:a}=(0,m.$G)(),i=yr(),n=null===(e=br.getState().session.currentRoom.metadata)||void 0===e?void 0:e.room_features.allow_polls,l=kr(kn),d=(0,s.useMemo)((()=>{var e,s;const i=null!==(s=Number(null===(e=null===t||void 0===t?void 0:t.stats)||void 0===e?void 0:e.totalRunning))&&void 0!==s?s:0,l=[{id:1,title:(0,o.jsx)(o.Fragment,{children:a("left-panel.participants-tab")}),elm:(0,o.jsx)(ln,{})}];return n&&l.push({id:2,title:(0,o.jsxs)(o.Fragment,{children:[a("left-panel.polls-tab"),i>0?(0,o.jsx)("span",{className:"absolute -right-[20px] -top-[7px] w-5 h-5 bg-primaryColor rounded-full text-white text-[10px]",children:null!==i&&void 0!==i?i:0}):null]}),elm:(0,o.jsx)(bn,{})}),(null===r||void 0===r?void 0:r.status)&&l.push({id:3,title:(0,o.jsx)(o.Fragment,{children:a("left-panel.breakout-room-tab")}),elm:(0,o.jsx)(yn,{})}),l}),[t,r]);return(0,o.jsxs)("div",{id:"main-left-panel",className:"participants-wrapper relative z-10 left-0 top-0 h-full w-[330px] multi-gradient",children:[(0,o.jsxs)("div",{className:"hidden md:inline-block close absolute z-10 -right-[14px] top-1 w-6 h-6 rounded-full border border-solid border-primaryColor dark:border-darkText bg-white dark:bg-darkPrimary cursor-pointer",onClick:()=>{i(de(!1))},children:[(0,o.jsx)("span",{className:"inline-block w-[18px] h-[1px] bg-primaryColor dark:bg-darkText absolute rotate-45 top-[11px] left-[2px]"}),(0,o.jsx)("span",{className:"inline-block w-[18px] h-[1px] bg-primaryColor dark:bg-darkText absolute -rotate-45 top-[11px] right-[2px]"})]}),(0,o.jsxs)(ls.O.Group,{vertical:!0,selectedIndex:l,onChange:e=>{i(rt(e))},children:[(0,o.jsx)(ls.O.List,{className:"flex",children:d.map((e=>(0,o.jsx)(ls.O,{className:({selected:e})=>((...e)=>e.filter(Boolean).join(" "))("w-full py-2 text-xs text-black dark:text-white font-bold leading-5 border-b-4 border-solid transition ease-in",e?"border-[#004d90]":"border-[#004d90]/20"),children:(0,o.jsx)("div",{className:"name relative inline-block",children:e.title})},e.id)))}),(0,o.jsx)(ls.O.Panels,{className:"relative h-[calc(100%-45px)]",children:d.map((e=>(0,o.jsx)(ls.O.Panel,{className:""+(2===e.id||3===e.id?"polls h-full":"px-2 xl:px-4 pt-2 xl:pt-5 h-full"),children:(0,o.jsx)(o.Fragment,{children:e.elm})},e.id)))})]})]})}));var Tn=r(3048),jn=r(1036),Sn=r.n(jn);const _n=(0,wr.P1)((e=>e.roomSettings.selectedChatOption),(e=>e)),Nn=({isChatServiceReady:e,lockSendFile:t,currentRoom:r})=>{var a,i,n,d;const c=(0,s.useRef)(null),{t:u}=(0,m.$G)(),[p,h]=(0,s.useState)(),x=kr(_n),f=null===(a=br.getState().session.currentRoom.metadata)||void 0===a?void 0:a.room_features.chat_features,g=null!==(n=null===(i=null===f||void 0===f?void 0:f.allowed_file_types)||void 0===i?void 0:i.map((e=>"."+e)).join(","))&&void 0!==n?n:"*",v=(null===f||void 0===f?void 0:f.max_file_size)?null===f||void 0===f?void 0:f.max_file_size:void 0,{isUploading:b,result:y}=ta({allowedFileTypes:null!==(d=null===f||void 0===f?void 0:f.allowed_file_types)&&void 0!==d?d:[],maxFileSize:v,files:p});(0,s.useEffect)((()=>{y&&y.filePath&&y.fileName&&(k(y.filePath,y.fileName),(0,l.Am)(u("right-panel.file-upload-success"),{type:l.Am.TYPE.SUCCESS}))}),[y]);const k=(e,t)=>{if(!Uo())return;const a=`<span class="download"> <i class="pnm-download"></i> <a href="${window.PLUG_N_MEET_SERVER_URL+"/download/uploadedFile/"+e}" target="_blank">${t}</a></span>`,o=new Wa({type:Ma.USER,roomSid:r.sid,roomId:r.name,to:"public"!==x?x:"",body:{type:Oa.CHAT,isPrivate:"public"!==x?1:0,from:{sid:r.localParticipant.sid,userId:r.localParticipant.identity,name:r.localParticipant.name},msg:a}});Wo(o.toBinary())};return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("input",{type:"file",id:"chat-file",ref:c,accept:g,style:{display:"none"},onChange:e=>(e=>{const t=e.target.files;t.length&&h([...t])})(e)}),(0,o.jsx)("button",{disabled:!e||t||b,onClick:()=>(()=>{var e;b||null===(e=c.current)||void 0===e||e.click()})(),className:"w-4 h-6 px-2",children:(0,o.jsx)("i",{className:"pnm-attachment primaryColor text-[20px] opacity-50 dark:text-secondaryColor"})})]})})},Cn=(0,wr.P1)((e=>e.session.isChatServiceReady),(e=>e)),En=(0,wr.P1)((e=>{var t,r;return null===(r=null===(t=e.session.currentUser)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.lock_settings.lock_chat_send_message}),(e=>e)),Rn=(0,wr.P1)((e=>{var t,r;return null===(r=null===(t=e.session.currentUser)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.lock_settings.lock_chat_file_share}),(e=>e)),In=(0,wr.P1)((e=>e.roomSettings.selectedChatOption),(e=>e)),An=({currentRoom:e,chosenEmoji:t,onAfterSendMessage:r})=>{const a=kr(Cn),i=kr(En),n=kr(Rn),l=kr(In),{t:d}=(0,m.$G)(),[c,u]=(0,s.useState)(!1),[p,h]=(0,s.useState)(!1),[x,f]=(0,s.useState)(!0),[g,v]=(0,s.useState)("");(0,s.useEffect)((()=>{br.getState().session.currentRoom.metadata.room_features.chat_features.allow_file_upload||f(!1)}),[]),(0,s.useEffect)((()=>{u(!!i),h(!!n)}),[i,n]),(0,s.useEffect)((()=>{var e,t,r,a,o,s;const n=null===(t=null===(e=br.getState().session.currentRoom.metadata)||void 0===e?void 0:e.default_lock_settings)||void 0===t?void 0:t.lock_chat_send_message,l=null===(a=null===(r=br.getState().session.currentRoom.metadata)||void 0===r?void 0:r.default_lock_settings)||void 0===a?void 0:a.lock_chat_file_share,d=null===(s=null===(o=br.getState().session.currentUser)||void 0===o?void 0:o.metadata)||void 0===s?void 0:s.is_admin;n&&!d&&!1!==i&&u(!0),l&&!d&&!1!==i&&h(!0)}),[]);const b=(0,s.useCallback)((e=>{v(g+e)}),[g]);(0,s.useEffect)((()=>{t&&b(t)}),[t]);const y=async()=>{const t=(a=g,Sn()(a,{allowedTags:["b","i","strong","br"],allowedSchemes:["mailto","tel"]}));var a;if((0,ss.isEmpty)(t))return;const o=new Wa({type:Ma.USER,roomSid:e.sid,roomId:e.name,to:"public"!==l?l:"",body:{type:Oa.CHAT,isPrivate:"public"!==l?1:0,from:{sid:e.localParticipant.sid,userId:e.localParticipant.identity,name:e.localParticipant.name},msg:t.replace(/\r?\n/g,"<br />")}});Uo()&&(Wo(o.toBinary()),v("")),r()};return(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("div",{className:"flex items-start justify-between h-[4.5rem] p-2 pl-10 md:pl-0",children:[(0,o.jsx)("textarea",{name:"message-textarea",id:"message-textarea",className:"w-full bg-white dark:bg-darkSecondary2 h-14 max-h-14 mt-1 leading-[1.2] rounded-xl py-2 px-4 outline-none text-xs lg:text-sm primaryColor dark:text-white placeholder:text-primaryColor/70 dark:placeholder:text-white/70",value:g,onChange:e=>v(e.currentTarget.value),disabled:!a||c,placeholder:d("right-panel.chat-box-placeholder").toString(),onKeyDown:e=>(e=>{13==e.keyCode&&0==e.shiftKey&&(e.preventDefault(),y())})(e)}),(0,o.jsxs)("div",{className:"btns",children:[(0,o.jsx)("button",{disabled:!a||c,onClick:()=>y(),className:"w-4 h-6 p-2",children:(0,o.jsx)("i",{className:"pnm-send primaryColor text-[20px] dark:text-secondaryColor"})}),x?(0,o.jsx)(Nn,{isChatServiceReady:a,lockSendFile:p,currentRoom:e}):null]})]})})};var Pn=r(4730);const Fn=({participant:e,from:t})=>(0,o.jsx)("div",{className:"avatar flex items-center justify-center text-white h-8 w-8 overflow-hidden rounded-full shadow-header bg-primaryColor",children:(()=>{var r;if(null===(r=null===e||void 0===e?void 0:e.metadata)||void 0===r?void 0:r.profile_pic)return(0,o.jsx)("img",{src:null===e||void 0===e?void 0:e.metadata.profile_pic,alt:e.name});{let r=t.name;return(null===e||void 0===e?void 0:e.name)&&(r=null===e||void 0===e?void 0:e.name),(0,o.jsx)(o.Fragment,{children:null===r||void 0===r?void 0:r.slice(0,2).toUpperCase()})}})()}),Mn=({body:e,currentUser:t})=>{const r=kr((t=>E.selectById(t,e.from.userId))),{t:a}=(0,m.$G)();return(0,o.jsx)("div",{className:"wrapper flex ",children:"system"===e.from.userId?(0,o.jsx)("div",{className:"content w-[calc(100%)] pt-2 system mb-2",children:(0,o.jsx)("p",{className:"message-content max-w-fit shadow-footer text-xs bg-primaryColor text-white",dangerouslySetInnerHTML:{__html:e.msg}})}):(null===t||void 0===t?void 0:t.userId)===e.from.userId?(0,o.jsxs)("div",{className:"content me w-[calc(100%-2rem)] pt-2",children:[(0,o.jsx)("p",{className:"name pl-2 text-sm pb-1 primaryColor dark:text-darkText",children:a("right-panel.you")}),(0,o.jsx)("p",{className:"message-content max-w-fit shadow-footer text-xs bg-secondaryColor text-white",dangerouslySetInnerHTML:{__html:e.msg}})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(Fn,{participant:r,from:e.from}),(0,o.jsxs)("div",{className:"content w-[calc(100%-2rem)] pt-2",children:[(0,o.jsxs)("p",{className:"name pl-2 text-sm pb-1 dark:text-darkText",children:[e.from.name?e.from.name:null===r||void 0===r?void 0:r.name,(0,o.jsx)("span",{style:{fontSize:"10px"},children:r?null:" (offline)"})]}),(0,o.jsx)("p",{className:"message-content max-w-fit bg-white shadow-footer text-xs",dangerouslySetInnerHTML:{__html:e.msg}})]})]})})},On=(0,wr.P1)((e=>e.bottomIconsActivity.isActiveChatPanel),(e=>e)),Dn=({userId:e})=>{const t=kr(Re.selectAll),r=kr(On),a=(0,s.useRef)(null),i=br.getState().session.currentUser,[n,l]=(0,s.useState)([]),[d,c]=(0,s.useState)(!0),{outerRef:u,innerRef:m,items:p,scrollToItem:h}=(0,Bi.Z)({itemCount:n.length,onScroll:e=>{e.visibleStopIndex===n.length-1?c(!0):c(!1)}});(0,s.useEffect)((()=>{let r=[];r="public"===e?t.filter((e=>!e.isPrivate)):t.filter((t=>t.isPrivate&&(t.from.userId===e||t.to===e))),l(r)}),[t,e]);const x=()=>{n.length&&d&&a.current&&h({index:n.length-1,smooth:!0},(()=>{a.current&&a.current.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})}))};(0,s.useEffect)((()=>{const e=setTimeout((()=>{x()}),500);return()=>{clearTimeout(e)}}),[n.length]),(0,s.useEffect)((()=>{r&&setTimeout((()=>{x()}),500)}),[r]);const f=e=>{if(!n.length||"undefined"===typeof n[e])return null;const t=n[e];return(0,o.jsx)(Mn,{body:t,currentUser:i},t.message_id)};return(0,o.jsx)("div",{className:"relative h-full px-2 xl:px-4 pt-2 xl:pt-4 overflow-auto scrollBar scrollBar4 messages-item-wrap",ref:u,children:(0,o.jsxs)("div",{ref:m,className:"inner",children:[p.map((({index:e,measureRef:t})=>(0,o.jsx)("div",{ref:t,className:"message-item mb-2 xl:mb-3",children:f(e)},e))),(0,o.jsx)("div",{ref:a})]})})},Ln=(0,wr.P1)((e=>e.roomSettings.selectedChatOption),(e=>e)),Bn=(0,wr.P1)((e=>e.roomSettings.initiatePrivateChat),(e=>e)),Un=(0,wr.P1)((e=>e.roomSettings.unreadMsgFrom),(e=>e)),Wn=s.memo((()=>{const{t:e}=(0,m.$G)(),t=yr(),r=kr(Bn),a=kr(Re.selectAll),[i,n]=(0,s.useState)(new Map),l=br.getState().session.currentUser,d=kr(Un),c=kr(Ln),[u,p]=(0,s.useState)([{id:"public",title:e("left-panel.public-chat")}]),[h,x]=(0,s.useState)(e("left-panel.public-chat").toString());(0,s.useEffect)((()=>{""!==r.userId&&(i.set(r.userId,r.name),n(new Map(i))),a.forEach((e=>{var t;if(e.isPrivate)if(e.from.userId!==(null===l||void 0===l?void 0:l.userId))i.has(e.from.userId)||(i.set(e.from.userId,null!==(t=e.from.name)&&void 0!==t?t:""),n(new Map(i)));else if(e.from.userId===(null===l||void 0===l?void 0:l.userId)&&e.to&&e.to!==(null===l||void 0===l?void 0:l.userId)&&!i.has(e.to)){const t=E.selectById(br.getState(),e.to);t&&(i.set(t.userId,t.name),n(new Map(i)))}}))}),[r,a]),(0,s.useEffect)((()=>{const t=[{id:"public",title:e("left-panel.public-chat")}];i.forEach(((e,r)=>{t.push({id:r,title:e})})),p(t)}),[i,e]),(0,s.useEffect)((()=>{const e=u.filter((e=>e.id===c));e.length&&x(e[0].title)}),[c,u]);return(0,o.jsxs)("div",{className:"h-full",children:[(0,o.jsx)(Pn.R,{value:c,onChange:e=>{t(at(e)),t(st({task:"DEL",id:e}))},children:(0,o.jsxs)("div",{className:"relative h-10 z-10",children:[(0,o.jsxs)(Pn.R.Button,{className:"flex items-center justify-between py-2 text-sm text-black dark:text-darkText font-bold leading-5 border-b-4 border-solid transition ease-in shrink-0 border-primaryColor w-full",children:[(0,o.jsx)("span",{className:"block truncate pl-4 md:pl-6",children:h}),(0,o.jsxs)("span",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-2",children:[d.length?(0,o.jsx)("span",{className:"shake pr-1 -mb-1",children:(0,o.jsx)("i",{className:"pnm-chat shake"})}):null,(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,o.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})})]})]}),(0,o.jsx)(Sr.u,{as:s.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100 z-90",leaveTo:"opacity-0",children:(0,o.jsx)(Pn.R.Options,{className:"absolute max-h-60 w-full overflow-auto rounded-md bg-white dark:bg-darkPrimary py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm",children:u.map((e=>(0,o.jsx)(Pn.R.Option,{className:({active:e})=>"relative cursor-pointer select-none py-2 pl-10 pr-4 "+(e?"bg-primaryColor text-white":"text-gray-900 dark:text-darkText"),value:e.id,children:({selected:t})=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("span",{className:"flex truncate items-center justify-between "+(t?"font-medium":"font-normal"),children:[e.title,d.filter((t=>t===e.id)).length?(0,o.jsx)("span",{className:"shake pr-1",children:(0,o.jsx)("i",{className:"pnm-chat shake"})}):null]}),t?(0,o.jsx)("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3 text-secondaryColor",children:(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})}):null]})},e.id)))})})]})}),(0,o.jsx)("div",{className:"h-[calc(100%-40px)]",children:(0,o.jsx)(Dn,{userId:c})})]})})),Gn=(0,wr.P1)((e=>{var t,r;return null===(r=null===(t=e.session.currentUser)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.lock_settings.lock_chat}),(e=>e)),Jn=(0,wr.P1)((e=>e.roomSettings.theme),(e=>e)),Vn=({currentRoom:e,isRecorder:t})=>{const r=kr(Gn),a=kr(Jn),[i,n]=(0,s.useState)(!1),[l,d]=(0,s.useState)(null),[c,u]=(0,s.useState)(!1);(0,s.useEffect)((()=>{var e,t,a,o;const s=null===(t=null===(e=br.getState().session.currentRoom.metadata)||void 0===e?void 0:e.default_lock_settings)||void 0===t?void 0:t.lock_chat,i=null===(o=null===(a=br.getState().session.currentUser)||void 0===a?void 0:a.metadata)||void 0===o?void 0:o.is_admin;s&&!i&&!1!==r&&n(!1)}),[]),(0,s.useEffect)((()=>{t&&n(!1)}),[t]),(0,s.useEffect)((()=>{t||n(!r)}),[r,t]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"h-[calc(100%)] messageModule-wrapper relative z-10 right-0 top-0 w-[250px] xl:w-[320px] multi-gradient",children:(0,o.jsx)("div",{className:"all-MessageModule-wrap h-full",children:(0,o.jsx)(Wn,{})})}),t?(0,o.jsx)("div",{className:"w-[100%] h-[1px] hiddenAnimation absolute z-50 bottom-0 bg-gradient-to-r from-primaryColor to-secondaryColor"}):null,i?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"emoji-selection-wrap w-[250px] xl:w-[300px] fixed z-[99] bottom-[120px] lg:bottom-[65px] right-0 left-10 md:left-auto transition ease-in "+(c?"emoji-active opacity-100 visible pointer-events-auto":"opacity-0 invisible pointer-events-none"),children:c?(0,o.jsx)(Tn.ZP,{onEmojiClick:e=>{d(`${e.emoji}`)},lazyLoadEmojis:!0,theme:"dark"===a?Tn.Q2.DARK:Tn.Q2.LIGHT}):null}),(0,o.jsxs)("div",{className:"message-form fixed z-[99] xl:z-0 bottom-1 w-[250px] xl:w-[320px] bg-white",children:[(0,o.jsx)(An,{currentRoom:e,chosenEmoji:l,onAfterSendMessage:()=>{c&&u(!1)}}),(0,o.jsx)("div",{className:"emoji-picker absolute left-2 md:-left-6 bottom-5 w-5 h-5 cursor-pointer text-secondaryColor dark:text-darkText "+(c?"emoji-active":""),onClick:()=>u(!c),children:c?(0,o.jsx)("i",{className:"pnm-cross"}):(0,o.jsx)("i",{className:"pnm-emoji"})})]})]}):null]})},Hn=s.memo((({currentRoom:e,isRecorder:t})=>{const r=yr();return(0,o.jsxs)("div",{id:"main-right-panel",className:"h-[calc(100%)]",children:[t?null:(0,o.jsxs)("div",{className:"hidden md:inline-block close absolute -left-[14px] z-20 top-1 w-6 h-6 rounded-full border border-solid border-primaryColor dark:border-darkText bg-white dark:bg-darkSecondary cursor-pointer",onClick:()=>{r(le(!1))},children:[(0,o.jsx)("span",{className:"inline-block w-[18px] h-[1px] bg-primaryColor dark:bg-darkText absolute rotate-45 top-[11px] left-[2px]"}),(0,o.jsx)("span",{className:"inline-block w-[18px] h-[1px] bg-primaryColor dark:bg-darkText absolute -rotate-45 top-[11px] right-[2px]"})]}),(0,o.jsx)(Vn,{currentRoom:e,isRecorder:t})]})})),qn=({speaker:e})=>(0,o.jsxs)("div",{className:"m-1 px-3 py-1 primaryColor text-[12px] rounded-2xl inline-flex items-center bg-white border border-solid border-white",children:[(0,o.jsx)("i",{className:"pnm-mic-unmute text-[10px] secondaryColor mr-2"}),e.name]}),$n=()=>{const e=kr(y.selectAll),t=kr(E.selectIds),r=(0,s.useMemo)((()=>e.length?e.map((e=>{if(t.find((t=>t===String(e.userId))))return(0,o.jsx)(qn,{speaker:e},e.userId)})):null),[e,t]);return r?(0,o.jsx)("div",{className:"active-speakers-wrap flex w-full items-center justify-center absolute top-0 right-8 z-[9999]",children:r}):null},zn=({track:e})=>{const t=(0,s.useRef)(null),[r,a]=(0,s.useState)(!1),[i,n]=(0,s.useState)(!1);(0,s.useEffect)((()=>{var r;e instanceof Be.Zr&&n(!0);const a=t.current;return a&&(null===(r=e.videoTrack)||void 0===r||r.attach(a)),()=>{var t;a&&(null===(t=e.videoTrack)||void 0===t||t.detach(a))}}),[e]);return(0,o.jsxs)("div",{className:"screen-share-video relative",children:[r?null:(0,o.jsx)("div",{className:"loading flex justify-center",children:(0,o.jsxs)("div",{className:"lds-ripple",children:[(0,o.jsx)("div",{className:"border-secondaryColor"}),(0,o.jsx)("div",{className:"border-secondaryColor"})]})}),(0,o.jsx)("button",{className:"absolute z-[99] bottom-0 right-0 p-1 bg-black/50",onClick:()=>{var e;document.fullscreenElement?document.exitFullscreen():null===(e=t.current)||void 0===e||e.requestFullscreen().catch((e=>{alert(`Error attempting to enable full-screen mode: ${e.message} (${e.name})`)}))},children:(0,o.jsx)("i",{className:"icon pnm-fullscreen text[20px] text-white"})}),(0,o.jsx)("video",{onLoadedData:()=>{a(!0)},ref:t,className:"video-player absolute "+(i?"self-screen-share":"remote-screen-share")})]})},Qn=({track:e})=>{const t=(0,s.useRef)(null);return(0,s.useEffect)((()=>{var r;const a=t.current;return a&&(null===(r=e.audioTrack)||void 0===r||r.attach(a)),()=>{var t;a&&(null===(t=e.audioTrack)||void 0===t||t.detach(a))}}),[e]),(0,o.jsx)("div",{style:{display:"none"},children:(0,o.jsx)("audio",{autoPlay:!0,ref:t})})};var Yn;!function(e){e.ScreenShareStatus="screenShareStatus",e.VideoStatus="videoStatus",e.AudioSubscribers="audioSubscribers",e.VideoSubscribers="videoSubscribers",e.ScreenShareTracks="screenShareTracks"}(Yn||(Yn={}));const Xn=({currentConnection:e})=>{const[t,r]=(0,s.useState)();(0,s.useEffect)((()=>(e.screenShareTracksMap.size&&r(e.screenShareTracksMap),e.on(Yn.ScreenShareTracks,r),()=>{e.off(Yn.ScreenShareTracks,r)})),[e]);const a=(0,s.useMemo)((()=>{if(t){const e=Array();return t.forEach((t=>{t.source===Be.fQ.Source.ScreenShare?e.push((0,o.jsx)(zn,{track:t},t.trackSid)):t.source===Be.fQ.Source.ScreenShareAudio&&e.push((0,o.jsx)(Qn,{track:t},t.trackSid))})),e}return null}),[t]);return(0,o.jsx)(o.Fragment,{children:null!==a&&void 0!==a?a:null})},Kn=s.memo((({track:e,userId:t})=>{const r=(0,s.useRef)(null),a=kr((e=>E.selectById(e,t)));return(0,s.useEffect)((()=>{var t;const a=r.current;return a&&(null===(t=e.audioTrack)||void 0===t||t.attach(a)),()=>{var t;a&&(null===(t=e.audioTrack)||void 0===t||t.detach(a))}}),[e]),(0,s.useEffect)((()=>{const e=r.current;e&&"undefined"!==typeof(null===a||void 0===a?void 0:a.audioVolume)&&(e.volume=a.audioVolume)}),[r,null===a||void 0===a?void 0:a.audioVolume]),(0,o.jsx)("div",{style:{display:"none"},children:(0,o.jsx)("audio",{autoPlay:!0,ref:r})})})),Zn=({currentConnection:e})=>{const[t,r]=(0,s.useState)();(0,s.useEffect)((()=>(e.audioSubscribersMap.size&&r(e.audioSubscribersMap),e.on(Yn.AudioSubscribers,r),()=>{e.off(Yn.AudioSubscribers,r)})),[e]);const a=(0,s.useMemo)((()=>{if(!t)return null;const e=[];return t.forEach((t=>{t.tracks.forEach((r=>{e.push((0,o.jsx)(Kn,{userId:t.identity,track:r},r.trackSid))}))})),e}),[t]);return(0,o.jsx)(o.Fragment,{children:a})},el=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_features.shared_note_pad_features}),(e=>e)),tl=(0,wr.P1)((e=>{var t,r,a;return null===(a=null===(r=null===(t=e.session.currentUser)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.lock_settings)||void 0===a?void 0:a.lock_shared_notepad}),(e=>e)),rl=(0,wr.P1)((e=>e.roomSettings.theme),(e=>e)),al=()=>{const e=kr(el),t=kr(tl),r=br.getState().session.currentUser,[a,i]=(0,s.useState)(),[n,l]=(0,s.useState)(),d=kr(rl);(0,s.useEffect)((()=>{if((null===e||void 0===e?void 0:e.is_active)&&e.host){let a=e.host;if(e.host.match("host.docker.internal")&&(a="http://localhost:9001"),null===r||void 0===r?void 0:r.isRecorder)return void l(`${a}/p/${e.read_only_pad_id}?userName=${null===r||void 0===r?void 0:r.name}`);a=t?`${a}/p/${e.read_only_pad_id}?userName=${null===r||void 0===r?void 0:r.name}`:`${a}/p/${e.note_pad_id}?userName=${null===r||void 0===r?void 0:r.name}`,a+="dark"===d?"&theme=monokai":"&theme=normal",l(a)}else l(null)}),[e,t,d]);const c=()=>{i(!0)};return(0,o.jsx)(o.Fragment,{children:n?(0,o.jsxs)("div",{className:"notepad-wrapper m-auto h-[calc(100%-50px)] w-full max-w-[1100px] flex-1 sm:px-5 mt-9",children:[a?null:(0,o.jsx)("div",{className:"loading absolute left-[50%] top-[40%] flex justify-center",children:(0,o.jsxs)("div",{className:"lds-ripple",children:[(0,o.jsx)("div",{className:"border-secondaryColor"}),(0,o.jsx)("div",{className:"border-secondaryColor"})]})}),(0,o.jsx)("iframe",{height:"100%",width:"100%",src:n,onLoad:c})]}):null})};var ol=r(3493),sl=r.n(ol),il=r(4474);const nl="__precedingElement__",ll=(e,t,r)=>{var a,o,s;return!(!t||!(t.id===(null===(a=e.editingElement)||void 0===a?void 0:a.id)||t.id===(null===(o=e.resizingElement)||void 0===o?void 0:o.id)||t.id===(null===(s=e.draggingElement)||void 0===s?void 0:s.id)||t.version>r.version||t.version===r.version&&t.versionNonce<r.versionNonce))};let dl,cl,ul,ml,pl,hl="",xl="",fl="",gl=!1;const vl=async(e,t,r,a,o,s)=>new Promise((async(i,n)=>{const l=await fetch(e),d=await l.blob();d||n(null),hl=t,ul=r,ml=o,pl=s,gl=a,ul<0&&(ul=1);const c=new FileReader;c.readAsDataURL(d),c.onload=()=>{if(fl=c.result,xl=fl.substring(5,fl.indexOf(";base64")),"image/png"===xl||"image/jpeg"===xl||"image/jpg"===xl){const e=new Image;e.src=fl,e.onload=async function(){await yl(e.height,e.width);const t=bl();i(t)},e.onerror=async function(){console.error("can not open image file"),n(null)}}else if("image/svg+xml"==xl){dl=.8*ml,cl=.7*pl;const e=bl();i(e)}else console.error("unsupported file"),n(null)}})),bl=()=>{const e={id:hl,dataURL:fl,mimeType:xl,created:Date.now()};let t=.4;Math.round(100*cl/pl)<50&&(t=.7);return{image:e,elm:{id:hl,type:"image",x:ml*t,y:.06*pl,width:cl,height:dl,angle:0,strokeColor:"transparent",backgroundColor:"transparent",fillStyle:"hachure",strokeWidth:1,strokeStyle:"solid",roughness:1,opacity:100,groupIds:[],roundness:null,seed:Rr(),version:ul+1,versionNonce:Rr(),isDeleted:!1,boundElements:null,updated:Date.now(),link:null,status:"pending",fileId:hl,scale:[1,1],locked:gl}}},yl=async(e,t)=>{dl=Number(`${e}`),cl=Number(`${t}`);const r=pl-150;for(;cl>r;)dl-=.01*dl,cl-=.01*cl},kl=new Map;let wl=0,Tl=0;const jl=(e,t,r)=>{const a=e.reduce(((e,r,a,o)=>{var s;return(t||!kl.has(r.id)||r.version>kl.get(r.id))&&(e=>e.isDeleted?e.updated>Date.now()-108e5:!(0,il.isInvisiblySmallElement)(e))(r)&&e.push({...r,[nl]:0===a?"^":null===(s=o[a-1])||void 0===s?void 0:s.id}),e}),[]);for(const o of a)kl.set(o.id,o.version);Sl(a,r)},Sl=(e,t)=>{var r,a,o,s;const i=br.getState().session,n=new Wa({type:Ma.WHITEBOARD,roomSid:i.currentRoom.sid,roomId:i.currentRoom.room_id,body:{type:Oa.SCENE_UPDATE,from:{sid:null!==(a=null===(r=i.currentUser)||void 0===r?void 0:r.sid)&&void 0!==a?a:"",userId:null!==(s=null===(o=i.currentUser)||void 0===o?void 0:o.userId)&&void 0!==s?s:""},msg:JSON.stringify(e)}});t&&""!==t&&(n.to=t),Wo(n.toBinary())},_l=(e,t)=>{var r,a,o,s;const i=br.getState().session,n=new Wa({type:Ma.WHITEBOARD,roomSid:i.currentRoom.sid,roomId:i.currentRoom.room_id,body:{type:Oa.ADD_WHITEBOARD_OFFICE_FILE,from:{sid:null!==(a=null===(r=i.currentUser)||void 0===r?void 0:r.sid)&&void 0!==a?a:"",userId:null!==(s=null===(o=i.currentUser)||void 0===o?void 0:o.userId)&&void 0!==s?s:""},msg:JSON.stringify(e)}});""!==t&&(n.to=t),Wo(n.toBinary())},Nl=e=>{const t=(0,s.useRef)();return(0,s.useEffect)((()=>{t.current=e})),t.current},Cl=e=>{const t=(0,s.useRef)();return(0,s.useEffect)((()=>{t.current=e})),t.current},El=["https://libraries.excalidraw.com/libraries/BjoernKW/UML-ER-library.excalidrawlib","https://libraries.excalidraw.com/libraries/aretecode/decision-flow-control.excalidrawlib","https://libraries.excalidraw.com/libraries/dbssticky/data-viz.excalidrawlib","https://libraries.excalidraw.com/libraries/pgilfernandez/basic-shapes.excalidrawlib","https://libraries.excalidraw.com/libraries/ocapraro/bubbles.excalidrawlib"],Rl=e=>`${br.getState().whiteboard.currentWhiteboardOfficeFileId}_${e}`,Il=(e,t)=>{const r=e.getSceneElementsIncludingDeleted();r.length&&sessionStorage.setItem(Rl(t),JSON.stringify(r))},Al=(e,t,r)=>{const a=sessionStorage.getItem(Rl(r));if(a&&e){const r=JSON.parse(a);Array.isArray(r)&&r.length&&(e.updateScene({elements:r}),t&&jl(r,!0))}},Pl=(0,wr.P1)((e=>e.whiteboard.totalPages),(e=>e)),Fl=(0,wr.P1)((e=>e.whiteboard.currentPage),(e=>e)),Ml=(0,wr.P1)((e=>e.whiteboard.currentWhiteboardOfficeFileId),(e=>e)),Ol=s.memo((({excalidrawAPI:e,isPresenter:t})=>{var r;const a=kr(Pl),i=kr(Fl),n=kr(Ml),d=Cl(n),[c,u]=(0,s.useState)(),[p,h]=(0,s.useState)(!0),[x,f]=(0,s.useState)(!1),g=Nl(i),v=yr(),{t:b}=(0,m.$G)(),y=br.getState().session.currentUser,k=null===(r=null===y||void 0===y?void 0:y.metadata)||void 0===r?void 0:r.is_admin,w=null===y||void 0===y?void 0:y.isRecorder;(0,s.useEffect)((()=>{g&&i!==g&&e&&T()}),[i,g,e]),(0,s.useEffect)((()=>{i>1&&h(!1),1===i&&h(!0),x?i!==a&&f(!1):i===a&&f(!0)}),[i,x,a]),(0,s.useEffect)((()=>{const e=[];for(let t=0;t<a;t++)e.push((0,o.jsx)("option",{value:t+1,children:b("whiteboard.page",{count:t+1})},t));u(e)}),[a]),(0,s.useEffect)((()=>{n!==d&&t&&setTimeout((()=>{e&&Al(e,t,i)}),500)}),[n,d,i]);const T=()=>{e&&t&&(g&&Il(e,g),j(),Al(e,t,i))},j=()=>{null===e||void 0===e||e.updateScene({elements:[]})},S=e=>{((e,t)=>{var r,a,o,s;const i=br.getState().session,n=new Wa({type:Ma.WHITEBOARD,roomSid:i.currentRoom.sid,roomId:i.currentRoom.room_id,body:{type:Oa.PAGE_CHANGE,from:{sid:null!==(a=null===(r=i.currentUser)||void 0===r?void 0:r.sid)&&void 0!==a?a:"",userId:null!==(s=null===(o=i.currentUser)||void 0===o?void 0:o.userId)&&void 0!==s?s:""},msg:`${e}`}});""!==t&&(n.to=t),Wo(n.toBinary())})(e),setTimeout((()=>{v(vt(e))}),500)},_=()=>{S(i-1)},N=()=>{S(i+1)},C=async()=>{const e=new Ka({userId:null===y||void 0===y?void 0:y.userId,task:Da.PROMOTE}),t=await co("switchPresenter",e.toBinary(),!1,"application/protobuf","arraybuffer"),r=Va.fromBinary(new Uint8Array(t));r.status?(0,l.Am)(b("left-panel.menus.notice.presenter-changed"),{toastId:"lock-setting-status",type:"info"}):(0,l.Am)(b(r.msg),{toastId:"lock-setting-status",type:"error"})};return(0,o.jsx)(o.Fragment,{children:t?(0,o.jsxs)("div",{className:"flex wb-page-navigation ml-2",children:[(0,o.jsx)("button",{className:"pre w-8 h-8 flex items-center justify-center",onClick:_,disabled:p,children:(0,o.jsx)("i",{className:"pnm-arrow-left-short text-black dark:text-white text-xl opacity-50"})}),(0,o.jsx)("select",{id:"pages",name:"pages",className:"pagesOpts block h-8 py-1 px-3 border border-gray-300 bg-white dark:bg-darkSecondary rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",onChange:e=>S(Number(e.currentTarget.value)),value:i,children:c}),(0,o.jsx)("button",{className:"next w-8 h-8 flex items-center justify-center",onClick:N,disabled:x,children:(0,o.jsx)("i",{className:"pnm-arrow-right-short text-black dark:text-white text-xl opacity-50"})})]}):(0,o.jsxs)("div",{className:"flex text-sm items-center justify-center relative pl-3",children:[k&&!w?(0,o.jsx)("button",{className:"w-10 h-8 flex items-center justify-center absolute left-0 top-[3px]",onClick:C,children:(0,o.jsx)("i",{className:"pnm-presenter primaryColor text-[14px] opacity-50"})}):null,b("whiteboard.page",{count:i})]})})})),Dl=({refreshFileBrowser:e,allowedFileTypes:t,currentPage:r,excalidrawAPI:a})=>{const i=(0,s.useRef)(null),[n,d]=(0,s.useState)(),{t:c}=(0,m.$G)(),u=yr(),p=br.getState().session,h=ks(e),{isUploading:x,result:f}=ta({allowedFileTypes:t,maxFileSize:30,files:n});(0,s.useEffect)((()=>{f&&f.filePath&&g(f.filePath,f.fileName,f.fileExtension)}),[f]),(0,s.useEffect)((()=>{var t;!x&&e>0&&h!==e&&(null===(t=i.current)||void 0===t||t.click())}),[e,x,h]);const g=(e,t,r)=>{switch(r){case"jpg":case"jpeg":case"png":case"svg":(0,l.Am)(c("right-panel.file-upload-success"),{type:l.Am.TYPE.SUCCESS}),b(e,t);break;default:v(p,e)}},v=async(e,t)=>{var r;const o=l.Am.loading(c("whiteboard.converting"),{type:"info"}),s={sid:e.currentRoom.sid,roomId:e.currentRoom.room_id,userId:null===(r=e.currentUser)||void 0===r?void 0:r.userId,file_path:t},i=await co("convertWhiteboardFile",s);if(!i.status)return void l.Am.update(o,{render:c(i.msg),type:"error",isLoading:!1,closeButton:!0});const n=[];for(let l=0;l<i.total_pages;l++){const e="page_"+(l+1)+".png",t={id:Er(),currentPage:l+1,filePath:i.file_path+"/"+e,fileName:e,uploaderWhiteboardHeight:a.getAppState().height,uploaderWhiteboardWidth:a.getAppState().width,isOfficeFile:!0};n.push(t)}const d={fileId:i.file_id,fileName:i.file_name,filePath:i.file_path,totalPages:i.total_pages,pageFiles:JSON.stringify(n)};await y(),br.dispatch(kt(d)),await Ir(500),_l(d),l.Am.update(o,{render:c("whiteboard.file-ready"),type:"success",isLoading:!1,autoClose:1e3})},b=(e,t)=>{var o,s,i,n;const l={id:Er(),currentPage:r,filePath:e,fileName:t,uploaderWhiteboardHeight:a.getAppState().height,uploaderWhiteboardWidth:a.getAppState().width,isOfficeFile:!1};u(ft(l));const d=br.getState().whiteboard.whiteboardOfficeFilePagesAndOtherImages,c=br.getState().session,m=new Wa({type:Ma.WHITEBOARD,roomSid:c.currentRoom.sid,roomId:c.currentRoom.room_id,body:{type:Oa.ADD_WHITEBOARD_FILE,from:{sid:null!==(s=null===(o=c.currentUser)||void 0===o?void 0:o.sid)&&void 0!==s?s:"",userId:null!==(n=null===(i=c.currentUser)||void 0===i?void 0:i.userId)&&void 0!==n?n:""},msg:d}});Wo(m.toBinary())},y=async()=>{if(!a)return;const e=a.getSceneElementsIncludingDeleted();if(e.length){const t=br.getState().whiteboard.currentPage;sessionStorage.setItem(Rl(t),JSON.stringify(e))}};return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("input",{type:"file",id:"chat-file",ref:i,style:{display:"none"},onChange:e=>(e=>{const t=e.target.files;t.length&&d([...t])})(e),accept:t.map((e=>"."+e)).join(",")})})},Ll=(0,wr.P1)((e=>e.whiteboard.currentPage),(e=>e)),Bl=(0,wr.P1)((e=>e.whiteboard.whiteboardUploadedOfficeFiles),(e=>e)),Ul=({excalidrawAPI:e})=>{const{t}=(0,m.$G)(),r=yr(),a=kr(Ll),i=kr(Bl),[n,l]=(0,s.useState)(0),[d,c]=(0,s.useState)([]),[u,p]=(0,s.useState)([]);(0,s.useEffect)((()=>{const e=i.map((e=>(0,o.jsx)("div",{role:"none",className:"border-b border-solid border-primaryColor/10 last:border-none",children:(0,o.jsx)(ia.v.Item,{children:(0,o.jsx)("button",{className:"!rounded !w-full flex items-center !px-3 !py-[0.4rem] !text-[10px] lg:!text-xs transition ease-in !bg-transparent hover:!bg-primaryColor hover:text-white text-gray-700 dark:text-darkText",onClick:()=>x(e),children:e.fileName})})},e.fileId)));c(e)}),[i]);const h=e=>{let t=["jpg","jpeg","png","svg"];"office"===e&&(t=["pdf","docx","doc","odt","txt","rtf","xml","xlsx","xls","ods","csv","pptx","ppt","odp","vsd","odg","html"]),l(n+1),p([...t])},x=async e=>{await f(),r(yt(e.fileId)),await Ir(500),_l(e)},f=async()=>{if(!e)return;const t=e.getSceneElementsIncludingDeleted();if(t.length){const e=br.getState().whiteboard.currentPage;sessionStorage.setItem(Rl(e),JSON.stringify(t))}};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("button",{className:"h-[30px] lg:h-[32px] max-w text-xs !px-2 rounded-md bg-[#F2F2F2] dark:bg-[#363636] hover:bg-[#ECF4FF] flex items-center justify-center cursor-pointer",onClick:()=>h("image"),children:[(0,o.jsx)("i",{className:"pnm-blank-img primaryColor dark:text-secondaryColor hover:secondaryColor text-[14px] opacity-50 mr-1"}),t("whiteboard.upload-image")]}),(0,o.jsx)("div",{className:"menu relative z-10",children:(0,o.jsx)(ia.v,{children:({open:e})=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(ia.v.Button,{className:"manage-icon h-[30px] lg:h-[32px] max-w text-xs !px-2 rounded-md bg-[#F2F2F2] dark:bg-[#363636] hover:bg-[#ECF4FF] flex items-center justify-center cursor-pointer",children:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("i",{className:"pnm-attachment primaryColor dark:text-secondaryColor hover:secondaryColor text-[14px] opacity-50 mr-1"}),t("whiteboard.manage-files")]})}),(0,o.jsx)(Sr.u,{show:e,enter:"transition duration-100 ease-out",enterFrom:"transform scale-95 opacity-0",enterTo:"transform scale-100 opacity-100",leave:"transition duration-75 ease-out",leaveFrom:"transform scale-100 opacity-100",leaveTo:"transform scale-95 opacity-0",children:(0,o.jsxs)(ia.v.Items,{static:!0,className:"origin-top-right z-10 absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white dark:bg-darkPrimary ring-1 ring-black dark:ring-secondaryColor ring-opacity-5 divide-y divide-gray-100 dark:divide-secondaryColor focus:outline-none",children:[(0,o.jsx)("div",{className:"item-wrapper-uploaded-file overflow-x-hidden overflow-y-auto max-h-[170px] scrollBar scrollBar2",children:d}),(0,o.jsx)("div",{className:"py-3 !border-t-2 border-solid !border-primaryColor !mt-2",children:(0,o.jsx)(ia.v.Item,{children:(0,o.jsxs)("button",{onClick:()=>h("office"),className:"w-[100px] !m-auto text-xs h-7 flex items-center justify-center !bg-primaryColor hover:!bg-secondaryColor text-white",children:[(0,o.jsx)("i",{className:"pnm-attachment text-white text-[14px] opacity-50 mr-1"}),t("whiteboard.upload-file")]})})})]})})]})})}),(0,o.jsx)(Dl,{refreshFileBrowser:n,allowedFileTypes:u,currentPage:a,excalidrawAPI:e})]})},Wl=(0,wr.P1)((e=>e.whiteboard),(e=>e)),Gl=(0,wr.P1)((e=>{var t,r,a;return null===(a=null===(r=null===(t=e.session.currentUser)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.lock_settings)||void 0===a?void 0:a.lock_whiteboard}),(e=>e)),Jl=(0,wr.P1)((e=>{var t,r;return null===(r=null===(t=e.session.currentUser)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.is_presenter}),(e=>e)),Vl=(0,wr.P1)((e=>e.roomSettings.theme),(e=>e)),Hl=(0,wr.P1)((e=>e.bottomIconsActivity.screenWidth),(e=>e)),ql=()=>{const e=br.getState().session.currentUser,t=br.getState().session.currentRoom,r=new Map,{i18n:a}=(0,m.$G)(),[i,n]=(()=>{const[e,t]=(0,s.useState)(null);return[e,(0,s.useCallback)((e=>t(e)),[])]})(),[l,d]=(0,s.useState)(!0),c=kr(Vl),[u,p]=(0,s.useState)(-1),h=kr(Wl),x=Cl(h.currentWhiteboardOfficeFileId),f=Nl(h.currentPage),g=kr(E.selectAll),v=kr(Gl),b=kr(Jl),[y,k]=(0,s.useState)(!1),[w,T]=(0,s.useState)(0),j=kr(Hl);(0,s.useEffect)((()=>{var r,a,o,s;const n=br.getState(),l=null===(a=null===(r=n.session.currentUser)||void 0===r?void 0:r.metadata)||void 0===a?void 0:a.is_presenter;return i?l&&setTimeout((()=>{const e=n.whiteboard.currentPage;Al(i,l,e)}),100):(null===e||void 0===e?void 0:e.isRecorder)||(null===(s=null===(o=t.metadata)||void 0===o?void 0:o.default_lock_settings)||void 0===s?void 0:s.lock_whiteboard)||d(!1),()=>{if(i&&l){const e=n.whiteboard.currentPage;Il(i,e)}}}),[i]),(0,s.useEffect)((()=>{!y&&i&&((()=>{const e=br.getState().session,t=E.selectAll(br.getState()).filter((t=>{var r;return t.sid!==(null===(r=e.currentUser)||void 0===r?void 0:r.sid)}));if(!t.length)return;t.sort(((e,t)=>e.joinedAt-t.joinedAt));let r=t;r.length>2&&(r=t.slice(0,2)),r.forEach((t=>{var r,a,o,s;const i=new Wa({type:Ma.SYSTEM,roomSid:e.currentRoom.sid,roomId:e.currentRoom.room_id,to:t.sid,body:{type:Oa.INIT_WHITEBOARD,from:{sid:null!==(a=null===(r=e.currentUser)||void 0===r?void 0:r.sid)&&void 0!==a?a:"",userId:null!==(s=null===(o=e.currentUser)||void 0===o?void 0:o.userId)&&void 0!==s?s:""},msg:""}});Wo(i.toBinary())}))})(),k(!0)),h.requestedWhiteboardData.requested&&i&&((e,t)=>{const r=br.getState().whiteboard,a=r.whiteboardUploadedOfficeFiles.filter((e=>e.fileId===r.currentWhiteboardOfficeFileId));if(!a.length)return;const o={fileId:a[0].fileId,fileName:a[0].fileName,filePath:a[0].filePath,totalPages:a[0].totalPages,currentPage:r.currentPage,pageFiles:r.whiteboardOfficeFilePagesAndOtherImages};_l(o,t);const s=e.getSceneElementsIncludingDeleted();s.length&&jl(s,!0,t),br.dispatch(gt({requested:!1,sendTo:""}))})(i,h.requestedWhiteboardData.sendTo)}),[i,h.requestedWhiteboardData,y]),(0,s.useEffect)((()=>{i&&h.currentWhiteboardOfficeFileId!==x&&(p(-1),i.updateScene({elements:[]}),i.addFiles([]),i.history.clear())}),[i,h.currentWhiteboardOfficeFileId,x]),(0,s.useEffect)((()=>{i&&(g.forEach((e=>{e.metadata.is_admin&&(r.has(e.userId)||r.set(e.userId,{}))})),r.forEach(((e,t)=>{g.find((e=>e.userId===t))||r.delete(t)})),i.updateScene({collaborators:r}))}),[i,g]),(0,s.useEffect)((()=>{"undefined"!==typeof v&&((null===e||void 0===e?void 0:e.isRecorder)||d(v))}),[v]),(0,s.useEffect)((()=>{var t,r;i&&(b?(d(!1),(e=>{let t=El;"undefined"!==typeof window.WHITEBOARD_PRELOADED_LIBRARY_ITEMS&&Array.isArray(window.WHITEBOARD_PRELOADED_LIBRARY_ITEMS)&&(t=window.WHITEBOARD_PRELOADED_LIBRARY_ITEMS),t.forEach((async t=>{try{const r=await fetch(t),a=await r.blob();await e.updateLibrary({libraryItems:a,merge:!0,defaultStatus:"published"})}catch(r){console.error(r)}}))})(i)):(null===e||void 0===e?void 0:e.isRecorder)||d(null===(r=null===(t=null===e||void 0===e?void 0:e.metadata)||void 0===t?void 0:t.lock_settings.lock_whiteboard)||void 0===r||r))}),[i,b]),(0,s.useEffect)((()=>{f&&h.currentPage!==f&&p(-1),!b&&f&&h.currentPage!==f&&(null===i||void 0===i||i.updateScene({elements:[]}),null===i||void 0===i||i.addFiles([]))}),[i,h.currentPage,f,b]);(0,s.useEffect)((()=>{if(h.excalidrawElements&&i&&y){const e=JSON.parse(h.excalidrawElements),t=((e,t,r)=>{var a;const o=e.reduce(((e,t,r)=>(e[t.id]=[t,r],e)),{}),s=e.slice(),i=new WeakMap;let n=0,l=0,d=-1;for(const c of t){d++;const e=o[c.id];if(ll(r,null===e||void 0===e?void 0:e[0],c)){c[nl]&&delete c[nl];continue}if(e){if(e[0]===c)continue;i.set(e[0],!0)}const u=c[nl]||(null===(a=t[d-1])||void 0===a?void 0:a.id)||null;if(null!=u)if(delete c[nl],"^"===u)l++,0===n?(s.unshift(c),o[c.id]=[c,n-l]):(s.splice(n+1,0,c),o[c.id]=[c,n+1-l],n++);else{let e=o[u]?o[u][1]:null;null!=e&&(e+=l),null!=e&&e>=n?(s.splice(e+1,0,c),l++,o[c.id]=[c,e+1-l],n=e+1):null!=e?(s.splice(n+1,0,c),l++,o[c.id]=[c,n+1-l],n++):(s.push(c),o[c.id]=[c,s.length-1-l])}else e?(s[e[1]]=c,o[c.id]=[c,e[1]]):(s.push(c),o[c.id]=[c,s.length-1-l])}return s.filter((e=>!i.has(e)))})(i.getSceneElementsIncludingDeleted(),e,i.getAppState());((e,{init:t=!1}={})=>{e.length&&(null===i||void 0===i||i.updateScene({elements:e,commitToHistory:t}),p((0,il.getSceneVersion)(e)),null===i||void 0===i||i.history.clear())})(t)}}),[i,h.excalidrawElements,y]),(0,s.useEffect)((()=>{var e;if(h.mousePointerLocation){const{pointer:t,button:a,name:o,userId:s,selectedElementIds:n}=JSON.parse(h.mousePointerLocation),l=new Map(r),d=null!==(e=l.get(s))&&void 0!==e?e:{};d.pointer=t,d.button=a,d.selectedElementIds=n,d.username=o,d.id=s,l.set(s,d),null===i||void 0===i||i.updateScene({collaborators:l})}}),[h.mousePointerLocation]),(0,s.useEffect)((()=>{if(i&&h.whiteboardAppState){const e={theme:h.whiteboardAppState.theme,viewBackgroundColor:h.whiteboardAppState.viewBackgroundColor,zenModeEnabled:h.whiteboardAppState.zenModeEnabled,gridSize:h.whiteboardAppState.gridSize};w>=h.whiteboardAppState.width&&(e.scrollX=h.whiteboardAppState.scrollX,e.scrollY=h.whiteboardAppState.scrollY,e.zoom={value:h.whiteboardAppState.zoomValue}),i.updateScene({appState:e})}}),[i,h.whiteboardAppState]);const S=(0,s.useCallback)((async e=>{if(!i)return;const t=[],r=[];for(const a of e){const e=window.PLUG_N_MEET_SERVER_URL+"/download/uploadedFile/"+a.filePath,o=i.getFiles(),s=i.getSceneElementsIncludingDeleted();let n=!1;for(const t in o)if(o[t].id===a.id){if(s.filter((e=>e.id===a.id)).length){n=!0;break}}if(!n){const o=await vl(e,a.id,u,a.isOfficeFile,a.uploaderWhiteboardHeight,a.uploaderWhiteboardWidth);o&&i&&(t.push(o.image),r.push(o.elm))}}t.length&&(i.addFiles(t),r.forEach((e=>{const t=i.getSceneElementsIncludingDeleted().slice(0);t.filter((t=>t.id===e.id)).length||t.push(e),i.updateScene({elements:t})})))}),[i,u]);(0,s.useEffect)((()=>{if(h.whiteboardOfficeFilePagesAndOtherImages&&i){const e=JSON.parse(h.whiteboardOfficeFilePagesAndOtherImages);if(e.length){const t=e.filter((e=>e.currentPage===h.currentPage));S(t)}}}),[i,h.whiteboardOfficeFilePagesAndOtherImages,h.currentPage]),(0,s.useEffect)((()=>{const e=sl()((()=>{i&&(i.refresh(),T(i.getAppState().width))}),1e3,{trailing:!1});h.refreshWhiteboard>0&&i&&e()}),[h.refreshWhiteboard]);const _=sl()((t=>{if(!l&&t.pointersMap.size<2&&e){(e=>{var t,r,a,o;const s=br.getState().session,i=new Wa({type:Ma.WHITEBOARD,roomSid:s.currentRoom.sid,roomId:s.currentRoom.room_id,body:{type:Oa.POINTER_UPDATE,from:{sid:null!==(r=null===(t=s.currentUser)||void 0===t?void 0:t.sid)&&void 0!==r?r:"",userId:null!==(o=null===(a=s.currentUser)||void 0===a?void 0:a.userId)&&void 0!==o?o:""},msg:JSON.stringify(e)}});Wo(i.toBinary())})({pointer:t.pointer,button:t.button||"up",selectedElementIds:null===i||void 0===i?void 0:i.getAppState().selectedElementIds,userId:e.userId,name:e.name})}}),33),N=()=>(0,o.jsx)(Ol,{excalidrawAPI:i,isPresenter:null!==b&&void 0!==b&&b});return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("div",{className:"excalidraw-wrapper flex-1 w-full max-w-[1200px] m-auto h-[calc(100%-50px)] sm:px-5 mt-9 z-[0]",children:(0,o.jsxs)(il.Excalidraw,{ref:n,onChange:(t,r)=>{if(i&&e&&t.length){if(l)return;(0,il.getSceneVersion)(t)>u&&(p((0,il.getSceneVersion)(t)),jl(t,!1)),b&&((e,t,r,a,o,s,i,n,l)=>{var d,c,u,m;if(wl===r&&Tl===a)return;wl=r,Tl=a;const p=br.getState().session,h=new Wa({type:Ma.WHITEBOARD,roomSid:p.currentRoom.sid,roomId:p.currentRoom.room_id,body:{type:Oa.WHITEBOARD_APP_STATE_CHANGE,from:{sid:null!==(c=null===(d=p.currentUser)||void 0===d?void 0:d.sid)&&void 0!==c?c:"",userId:null!==(m=null===(u=p.currentUser)||void 0===u?void 0:u.userId)&&void 0!==m?m:""},msg:JSON.stringify({height:e,width:t,scrollX:r,scrollY:a,zoomValue:o,theme:s,viewBackgroundColor:i,zenModeEnabled:n,gridSize:l})}});Wo(h.toBinary())})(r.height,r.width,r.scrollX,r.scrollY,r.zoom.value,r.theme,r.viewBackgroundColor,r.zenModeEnabled,r.gridSize)}},onPointerUpdate:_,viewModeEnabled:l,isCollaborating:!0,theme:c,name:"plugNmeet whiteboard",UIOptions:{canvasActions:{loadScene:!1,export:!1,saveAsImage:!(null===e||void 0===e?void 0:e.isRecorder)}},autoFocus:!0,detectScroll:!0,langCode:a.languages[0],renderTopRightUI:()=>(0,o.jsx)(o.Fragment,{children:b&&i?(0,o.jsx)(Ul,{excalidrawAPI:i}):null}),libraryReturnUrl:"",children:[(0,o.jsxs)(il.MainMenu,{children:[(0,o.jsx)(il.MainMenu.DefaultItems.SaveAsImage,{}),(0,o.jsx)(il.MainMenu.DefaultItems.Help,{}),j<=767?N():null]}),j>767?(0,o.jsx)(il.Footer,{children:N()}):null]})})})};var $l=r(1144);const zl=({options:e,onReady:t})=>{const r=s.useRef(null),[a,i]=(0,s.useState)();return(0,s.useEffect)((()=>{const o=r.current;if(o&&!a){const r=(0,$l.Z)(o,e,(()=>{t&&t(r)}));i(r)}}),[r]),(0,s.useEffect)((()=>()=>{a&&(a.dispose(),i(void 0))}),[a]),(0,o.jsx)("div",{className:"react-js-player-wrap",children:(0,o.jsx)("div",{"data-vjs-player":!0,children:(0,o.jsx)("video",{ref:r,className:"video-js"})})})},Ql=({src:e,action:t,seekTo:r,isPresenter:a})=>{const[i,n]=(0,s.useState)(),l=br.getState().session,[d]=(0,s.useState)({controls:a,responsive:!0,fluid:!0,sources:[{src:e}]});(0,s.useEffect)((()=>{!a&&i&&("play"===t?i.play():"pause"===t&&i.pause())}),[t,a,i]),(0,s.useEffect)((()=>{!a&&i&&r>1&&i.currentTime(r)}),[r,i,a]),(0,s.useEffect)((()=>{const e=e=>{var t,r,a,o;const s=new Wa({type:Ma.SYSTEM,roomSid:l.currentRoom.sid,roomId:l.currentRoom.room_id,body:{type:Oa.EXTERNAL_MEDIA_PLAYER_EVENTS,from:{sid:null!==(r=null===(t=l.currentUser)||void 0===t?void 0:t.sid)&&void 0!==r?r:"",userId:null!==(o=null===(a=l.currentUser)||void 0===a?void 0:a.userId)&&void 0!==o?o:""},msg:e}});Wo(s.toBinary())};i&&(i.on("pause",(()=>{e(JSON.stringify({action:"pause"}))})),i.on("play",(()=>{const t={action:"play",seekTo:i.currentTime()};e(JSON.stringify(t))})),i.on("seeked",(()=>{const t={action:"seeked",seekTo:i.currentTime()};e(JSON.stringify(t))})))}),[i]);return(0,o.jsx)(zl,{options:d,onReady:e=>{n(e)}})},Yl=(0,wr.P1)((e=>e.bottomIconsActivity.screenHeight),(e=>e)),Xl=(0,wr.P1)((e=>e.bottomIconsActivity.screenWidth),(e=>e)),Kl=({src:e,action:t,seekTo:r,isPresenter:a})=>{const[i,n]=(0,s.useState)(!0),[l,d]=(0,s.useState)(!1),[c,u]=(0,s.useState)(!1),m=(0,s.useRef)(),p=br.getState().session,h=kr(Yl),x=kr(Xl);(0,s.useEffect)((()=>{a||("play"===t?u(!0):"pause"===t&&u(!1))}),[t,a]),(0,s.useEffect)((()=>{var e;l&&!a&&r>1&&m&&(null===(e=m.current)||void 0===e||e.seekTo(r))}),[r,m,l,a]),(0,s.useEffect)((()=>{var e;if(!a)return;if(!l||!m)return;const t=e=>{var t,r,a,o;const s=new Wa({type:Ma.SYSTEM,roomSid:p.currentRoom.sid,roomId:p.currentRoom.room_id,body:{type:Oa.EXTERNAL_MEDIA_PLAYER_EVENTS,from:{sid:null!==(r=null===(t=p.currentUser)||void 0===t?void 0:t.sid)&&void 0!==r?r:"",userId:null!==(o=null===(a=p.currentUser)||void 0===a?void 0:a.userId)&&void 0!==o?o:""},msg:e}});Wo(s.toBinary())};if(i){const e={action:"pause"};t(JSON.stringify(e))}else{const r={action:"play",seekTo:null===(e=m.current)||void 0===e?void 0:e.getCurrentTime()};t(JSON.stringify(r))}}),[l,i,m,a]);return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(cs.Z,{ref:e=>{m.current=e},url:e,width:.7*x,height:.7*h,playing:c,controls:a,onReady:()=>{d(!0)},onPause:()=>{n(!0)},onPlay:()=>{n(!1)}})})},Zl=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_features.external_media_player_features.is_active}),(e=>e)),ed=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_features.external_media_player_features.url}),(e=>e)),td=(0,wr.P1)((e=>e.externalMediaPlayer.action),(e=>e)),rd=(0,wr.P1)((e=>e.externalMediaPlayer.seekTo),(e=>e)),ad=(0,wr.P1)((e=>{var t,r;return null===(r=null===(t=e.session.currentUser)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.is_presenter}),(e=>e)),od=()=>{const e=kr(ed),t=kr(Zl),r=kr(td),a=kr(rd),[i,n]=(0,s.useState)(!1),l=kr(ad),d=yr(),c=/\.(m4a|m4b|mp4a|mpga|mp2|mp2a|mp3|m2a|m3a|wav|weba|aac|oga|spx)($|\?)/i,u=/\.(mp4|og[gv]|webm|mov|m4v)(#t=[,\d+]+)?($|\?)/i,m=/\.(m3u8)($|\?)/i,p=/\.(mpd)($|\?)/i;(0,s.useEffect)((()=>{e&&(d(Nt()),n(c.test(e)||u.test(e)||m.test(e)||p.test(e)))}),[d,e]);return(0,o.jsx)(o.Fragment,{children:t&&e?(0,o.jsx)("div",{className:"externalMediaPlayerWrapper m-auto w-full flex items-center justify-center max-w-[1000px] flex-1 p-4",children:(0,o.jsx)("div",{className:"media-player-inner",children:i?(0,o.jsx)(Ql,{src:null!==e&&void 0!==e?e:"",action:r,isPresenter:!!l,seekTo:a}):(0,o.jsx)(Kl,{src:null!==e&&void 0!==e?e:"",action:r,isPresenter:!!l,seekTo:a})})}):null})},sd=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_features.display_external_link_features.is_active}),(e=>e)),id=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_features.display_external_link_features.link}),(e=>e)),nd=()=>{const e=kr(id),t=kr(sd),[r,a]=(0,s.useState)(),i=()=>{a(!0)};return(0,o.jsx)(o.Fragment,{children:t&&e&&""!==e?(0,o.jsxs)("div",{className:"external-display-link-wrapper m-auto h-[calc(100%-50px)] w-full max-w-[1100px] flex-1 sm:px-5 mt-9 p-2",children:[r?null:(0,o.jsx)("div",{className:"loading absolute left-[50%] top-[40%] flex justify-center",children:(0,o.jsxs)("div",{className:"lds-ripple",children:[(0,o.jsx)("div",{className:"border-secondaryColor"}),(0,o.jsx)("div",{className:"border-secondaryColor"})]})}),(0,o.jsx)("iframe",{height:"100%",width:"100%",src:e,onLoad:i})]}):null})},ld=(0,wr.P1)((e=>e.bottomIconsActivity.screenWidth),(e=>e)),dd=(0,wr.P1)((e=>e.bottomIconsActivity.deviceOrientation),(e=>e)),cd=(0,wr.P1)((e=>e.roomSettings.columnCameraPosition),(e=>e)),ud=({allParticipants:e,totalNumWebcams:t,isVertical:r})=>{const a=yr(),{t:i}=(0,m.$G)(),n=kr(ld),l=kr(dd),d=kr(cd),c=br.getState().session.userDeviceType,[u,p]=(0,s.useState)([]),[h,x]=(0,s.useState)(r?3:24),[f,g]=(0,s.useState)(0),[v,b]=(0,s.useState)(!1),[y,k]=(0,s.useState)(!1),[w,T]=(0,s.useState)(!1);(0,s.useEffect)((()=>{if(r){if(c===M.DESKTOP&&n>1024){if(d===Le.TOP||d===Le.BOTTOM)return void x(8)}else if(c===M.TABLET&&"portrait"===l)return void x(5);x(3)}else n&&(n<=640?(x(6),T(!0)):n>640&&n<=1024?(c===M.MOBILE?x(6):x(9),T(!0)):c===M.TABLET?(x(9),T(!0)):(x(24),T(!1)))}),[r,n,d,l]);const j=([...e],t,r)=>{const o=e.slice((t-1)*r,t*r);p(o),a(V(1!==t))};(0,s.useEffect)((()=>{e.length<=h?p(e):(g(1),j(e,1,h))}),[e,h]),(0,s.useEffect)((()=>{t>h?(b(1!==f),k(!(f>=t/h))):(b(!1),k(!1))}),[t,f,h]);const S=(0,s.useMemo)((()=>{if(r)return u;let e;return e=c===M.MOBILE&&"landscape"===l?(e=>{const t=e.length,r=[];t<=3?r.push((0,o.jsx)("div",{className:`camera-row-0 total-items-${t}`,children:e},0)):(0,ds.chunk)(e,Math.ceil(t/2)).forEach(((e,a)=>{r.push((0,o.jsx)("div",{className:`camera-row-${a} total-items-${t} inner-items-${e.length}`,children:e},a))}));return r})(u):c===M.MOBILE||c===M.TABLET||w?(e=>{const t=e.length,r=[];t<=3?r.push((0,o.jsx)("div",{className:`camera-row-0 total-items-${t}`,children:e},0)):t>3&&t<=4?(0,ds.chunk)(e,Math.ceil(t/2)).forEach(((e,a)=>{r.push((0,o.jsx)("div",{className:`camera-row-${a} total-items-${t} inner-items-${e.length}`,children:e},a))})):(0,ds.chunk)(e,Math.ceil(t/3)).forEach(((e,a)=>{r.push((0,o.jsx)("div",{className:`camera-row-${a} total-items-${t} inner-items-${e.length}`,children:e},a))}));return r})(u):(e=>{const t=e.length,r=[];t<4?r.push((0,o.jsx)("div",{className:`camera-row-0 total-items-${t}`,children:e},0)):t>=4&&t<=10?(0,ds.chunk)(e,Math.ceil(t/2)).forEach(((e,a)=>{r.push((0,o.jsx)("div",{className:`camera-row-${a} total-items-${t} inner-items-${e.length}`,children:e},a))})):(0,ds.chunk)(e,Math.ceil(t/3)).forEach(((e,a)=>{r.push((0,o.jsx)("div",{className:`camera-row-${a} total-items-${t} inner-items-${e.length}`,children:e},a))}));return r})(u),e}),[r,u,l]);return(0,o.jsxs)(o.Fragment,{children:[t>0?(0,o.jsx)("div",{className:`all-webcam-wrapper total-cam-${t} selected-cam-${h} page-${f} ${r?"vertical-webcams":""}`,children:(0,o.jsx)("div",{className:"all-webcam-wrapper-inner",children:(0,o.jsxs)(o.Fragment,{children:[v?(0,o.jsx)("button",{type:"button",className:"previous-cam",onClick:()=>(j(e,f-1,h),void g(f-1)),children:(0,o.jsx)("i",{className:"pnm-arrow-up"})}):null,(0,o.jsx)(o.Fragment,{children:S}),y?(0,o.jsx)("button",{type:"button",className:"next-cam",onClick:()=>(j(e,f+1,h),void g(f+1)),children:(0,o.jsx)("i",{className:"pnm-arrow-down"})}):null]})})}):null,c===M.DESKTOP&&t>6&&!r?(0,o.jsxs)("div",{className:"select-camera-number",children:[(0,o.jsxs)("select",{name:"select-camera-num",id:"select-camera-num",defaultValue:"24",onChange:e=>x(Number(e.currentTarget.value)),children:[(0,o.jsx)("option",{value:"6",children:"6"}),(0,o.jsx)("option",{value:"8",children:"8"}),(0,o.jsx)("option",{value:"12",children:"12"}),(0,o.jsx)("option",{value:"15",children:"15"}),(0,o.jsx)("option",{value:"18",children:"18"}),(0,o.jsx)("option",{value:"24",children:"24"})]}),(0,o.jsx)("label",{htmlFor:"select-camera-num",children:i("app.webcams-per-page")})]}):null]})},md=(0,wr.P1)((e=>e.roomSettings.roomVideoQuality),(e=>e)),pd=(0,wr.P1)((e=>e.roomSettings.videoObjectFit),(e=>e)),hd=({track:e})=>{const t=(0,s.useRef)(null),[r,a]=(0,s.useState)(),i=kr(md),n=kr(pd),[l,d]=(0,s.useState)(n);(0,s.useEffect)((()=>{var r;const a=t.current;return a&&(null===(r=e.videoTrack)||void 0===r||r.attach(a)),()=>{var t;a&&(null===(t=e.videoTrack)||void 0===t||t.detach(a))}}),[e]),(0,s.useEffect)((()=>{e instanceof Be.E8&&e.setVideoQuality(i)}),[i,e]),(0,s.useEffect)((()=>{"canvas"===e.trackName?d("contain"):d(n)}),[e,n]);return(0,o.jsxs)("div",{className:"camera-video-player",children:[r?null:(0,o.jsx)("div",{className:"loading absolute text-center top-3 z-[999] left-0 right-0 m-auto",children:(0,o.jsxs)("div",{className:"lds-ripple",children:[(0,o.jsx)("div",{className:"border-secondaryColor"}),(0,o.jsx)("div",{className:"border-secondaryColor"})]})}),(0,o.jsx)("button",{className:"absolute z-[999] top-2 right-2 p-1 bg-black/50 w-6 h-6 flex",onClick:()=>{var e;document.fullscreenElement?document.exitFullscreen():null===(e=t.current)||void 0===e||e.requestFullscreen().catch((e=>{alert(`Error attempting to enable full-screen mode: ${e.message} (${e.name})`)}))},children:(0,o.jsx)("i",{className:"icon pnm-fullscreen text[14px] text-white"})}),document.pictureInPictureEnabled?(0,o.jsx)("button",{className:"absolute z-[999] top-2 right-10 p-1 bg-black/50 w-6 h-6 flex",onClick:async()=>{document.pictureInPictureElement&&(document.exitPictureInPicture(),await Ir(500));const e=t.current;e&&await e.requestPictureInPicture()},children:(0,o.jsx)("i",{className:"icon pnm-pip text[14px] text-white"})}):null,(0,o.jsx)("video",{className:"camera-video",onLoadedData:()=>{a(!0)},ref:t,style:{objectFit:l}})]})},xd=({userId:e})=>{const t=kr((t=>E.selectById(t,e))),[r,a]=(0,s.useState)("#FFFFFF");(0,s.useEffect)((()=>{switch(null===t||void 0===t?void 0:t.connectionQuality){case Be.ZV.Excellent:a("#38f105");break;case Be.ZV.Good:a("#c8f6bd");break;case Be.ZV.Poor:a("#FF0000");break;default:a("#FFFFFF")}}),[null===t||void 0===t?void 0:t.connectionQuality]);return(0,o.jsx)("div",{className:"connection-status",children:(0,o.jsx)("i",{style:{color:r},className:"pnm-network text-[7px]"})})},fd=({userId:e})=>{const t=kr((t=>E.selectById(t,e)));return(0,o.jsx)(o.Fragment,{children:(null===t||void 0===t?void 0:t.audioTracks)?(0,o.jsx)("div",{className:"mic-status",children:(null===t||void 0===t?void 0:t.isMuted)?(0,o.jsx)("p",{className:"mute",children:(0,o.jsx)("i",{className:"pnm-mic-mute text-white text-[9px]"})}):(0,o.jsx)("p",{className:"mute",children:(0,o.jsx)("i",{className:"pnm-mic-unmute text-white text-[9px]"})})}):null})},gd=({userId:e})=>{const t=yr(),r=kr((t=>E.selectById(t,e))),a=()=>{t(P({id:e,changes:{pinWebcam:!(null===r||void 0===r?void 0:r.pinWebcam)}})),t(it())},i=(0,s.useMemo)((()=>(0,o.jsx)("div",{className:"pin-webcam cursor-pointer",onClick:a,children:(null===r||void 0===r?void 0:r.pinWebcam)?(0,o.jsx)("i",{className:"pnm-pin text-white text-[12px]"}):(0,o.jsx)("i",{className:"pnm-pin -rotate-90 text-white text-[12px]"})})),[null===r||void 0===r?void 0:r.pinWebcam]);return(0,o.jsx)(o.Fragment,{children:i})},vd=({userId:e,track:t})=>(0,o.jsx)("div",{className:"camera-modules",children:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"status",children:[(0,o.jsx)(xd,{userId:e}),(0,o.jsx)(fd,{userId:e})]}),(0,o.jsx)("div",{className:"status PinWebcam",children:(0,o.jsx)(gd,{userId:e})}),(0,o.jsx)(hd,{track:t})]})}),bd=({participantType:e,participant:t})=>{const r=kr((e=>y.selectById(e,t.identity))),a=(0,s.useMemo)((()=>{const r=[];return t.tracks.forEach((a=>{if(a.source===Be.fQ.Source.Camera){const s=(0,o.jsxs)("div",{className:"video-camera-item-inner",children:[(0,o.jsxs)("div",{className:"name",children:[t.name," ",e.isLocal?"(me)":null]}),(0,o.jsx)(vd,{userId:t.identity,track:a})]},a.trackSid);r.push(s)}})),r}),[t]);return(0,o.jsx)("div",{className:`video-camera-item relative ${r?"speaking":""} ${e.isAdmin?"admin":"participants"}`,children:a})},yd=(0,wr.P1)((e=>e.roomSettings.refreshWebcams),(e=>e)),kd=({currentConnection:e,isVertical:t})=>{const r=kr(E.selectAll),a=kr(yd),[i,n]=(0,s.useState)(),[l,d]=(0,s.useState)([]),[c,u]=(0,s.useState)(0);return(0,s.useEffect)((()=>(e.videoSubscribersMap.size&&n(e.videoSubscribersMap),e.on(Yn.VideoSubscribers,n),()=>{e.off(Yn.VideoSubscribers,n)})),[e]),(0,s.useEffect)((()=>{if(!i)return;let e=0;const t=[],a=[],s=[],n=[],l=[];i.forEach((i=>{const d=i.getTracks().filter((e=>e.source===Be.fQ.Source.Camera));if(d.length){let c=!1;const u=r.find((e=>e.userId===i.identity&&e.pinWebcam));if(i.metadata&&!(0,ds.isEmpty)(i.metadata)){c=JSON.parse(i.metadata).is_admin}const m={isAdmin:c,isLocal:i instanceof Be.Ix};e+=d.length;const p=(0,o.jsx)(bd,{participantType:m,participant:i},i.sid);c&&u?a.push(p):c?s.push(p):u?n.push(p):i instanceof Be.Ix?t.push(p):l.push(p)}}));const c=(0,ds.concat)(a,s,n,t,l);d(c),u(e)}),[i,a]),(0,o.jsx)(ud,{allParticipants:l,totalNumWebcams:c,isVertical:t})},wd=(0,wr.P1)((e=>e.roomSettings.activeScreenSharingView),(e=>e)),Td=(0,wr.P1)((e=>e.bottomIconsActivity.isActiveSharedNotePad),(e=>e)),jd=(0,wr.P1)((e=>e.bottomIconsActivity.isActiveWhiteboard),(e=>e)),Sd=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_features.external_media_player_features.is_active}),(e=>e)),_d=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_features.display_external_link_features.is_active}),(e=>e)),Nd=(0,wr.P1)((e=>e.roomSettings.activateWebcamsView),(e=>e)),Cd=({currentConnection:e})=>{var t;const r=yr(),a=null===(t=br.getState().session.currentUser)||void 0===t?void 0:t.isRecorder,i=kr(wd),n=kr(Td),l=kr(jd),d=kr(Sd),c=kr(_d),u=kr(Nd),[m,p]=(0,s.useState)(!1),[h,x]=(0,s.useState)(!1),[f,g]=(0,s.useState)(!1),[v,b]=(0,s.useState)(!1);(0,s.useEffect)((()=>(x(e.videoSubscribersMap.size>0),e.on(Yn.VideoStatus,x),b(e.screenShareTracksMap.size>0),e.on(Yn.ScreenShareStatus,b),()=>{e.off(Yn.VideoStatus,x),e.off(Yn.ScreenShareStatus,b)})),[e]),(0,s.useEffect)((()=>{p(!!(v||n||l||d||c))}),[v,n,l,d,c]),(0,s.useEffect)((()=>{g(!!u&&h)}),[u,h]),(0,s.useEffect)((()=>{const e=setTimeout((()=>{l&&r(wt())}),1e3);return()=>{clearTimeout(e)}}),[f,l,r]);const y=(0,s.useMemo)((()=>!v&&l?(0,o.jsx)(ql,{}):null),[v,l]),k=(0,s.useMemo)((()=>{let e="hidden";return i&&v?e="hidden":n&&(r(de(!1)),e="w-full"),(0,o.jsx)("div",{className:e,children:(0,o.jsx)(al,{})})}),[r,i,v,n]),w=(0,s.useMemo)((()=>{let e="hidden";return i&&v||l||n?e="hidden":d&&(a||(r(le(!1)),r(de(!1))),e="Div-external-media-player w-full flex items-center justify-center"),(0,o.jsx)("div",{className:e,children:(0,o.jsx)(od,{})})}),[i,v,n,l,d]),T=(0,s.useMemo)((()=>{let e="hidden";return i&&v||l||n||d?e="hidden":c&&(a||(r(le(!1)),r(de(!1))),e="w-full"),(0,o.jsx)("div",{className:e,children:(0,o.jsx)(nd,{})})}),[i,v,n,l,d,c]),j=(0,s.useMemo)((()=>{const e=[];return i&&v?(e.push("middle-fullscreen-wrapper share-screen-wrapper is-share-screen-running"),f&&m&&e.push("verticalsWebcamsActivated")):f&&!m?e.push("h-full"):f&&m?e.push("middle-fullscreen-wrapper h-full flex verticalsWebcamsActivated"):e.push("middle-fullscreen-wrapper h-full flex"),e.join(" ")}),[i,v,f,m]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:j,children:[u?(0,o.jsx)(kd,{currentConnection:e,isVertical:m}):null,i?(0,o.jsx)(Xn,{currentConnection:e}):null,y,k,w,T]}),(0,o.jsx)(Zn,{currentConnection:e})]})},Ed=(0,wr.P1)((e=>e.roomSettings.columnCameraWidth),(e=>e)),Rd=(0,wr.P1)((e=>e.roomSettings.columnCameraPosition),(e=>e)),Id=(0,wr.P1)((e=>e.bottomIconsActivity.isActiveParticipantsPanel),(e=>e)),Ad=(0,wr.P1)((e=>e.bottomIconsActivity.isActiveChatPanel),(e=>e)),Pd=(0,wr.P1)((e=>e.roomSettings.activeScreenSharingView),(e=>e)),Fd=(0,wr.P1)((e=>e.bottomIconsActivity.isActiveSharedNotePad),(e=>e)),Md=(0,wr.P1)((e=>e.bottomIconsActivity.isActiveWhiteboard),(e=>e)),Od=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_features.external_media_player_features.is_active}),(e=>e)),Dd=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_features.display_external_link_features.is_active}),(e=>e)),Ld=(0,wr.P1)((e=>e.bottomIconsActivity.screenHeight),(e=>e)),Bd=(0,wr.P1)((e=>e.roomSettings.visibleHeader),(e=>e)),Ud=(0,wr.P1)((e=>e.roomSettings.visibleFooter),(e=>e)),Wd=({isRecorder:e,currentConnection:t})=>{var r;const a=kr(Ed),i=kr(Rd),n=kr(Id),l=kr(Pd),d=kr(Fd),c=kr(Md),u=kr(Od),m=kr(Dd),p=kr(Ad),h=kr(Ld),x=kr(Bd),f=kr(Ud),g=yr(),[v,b]=(0,s.useState)(!0),[y,k]=(0,s.useState)(!1),[w,T]=(0,s.useState)(h),j=null!==(r=window.STATIC_ASSETS_PATH)&&void 0!==r?r:"./assets";(0,s.useEffect)((()=>{var e;(null===(e=br.getState().session.currentRoom.metadata.room_features)||void 0===e?void 0:e.chat_features.allow_chat)||(b(!1),g(le(!1)))}),[g]),(0,s.useEffect)((()=>(k(t.screenShareTracksMap.size>0),t.on(Yn.ScreenShareStatus,k),()=>{t.off(Yn.ScreenShareStatus,k)})),[t]);const S=(0,s.useMemo)((()=>{const t=[];return p?t.push("showChatPanel"):t.push("hideChatPanel"),n?t.push("showParticipantsPanel"):t.push("hideParticipantsPanel"),l&&y?t.push("showScreenShare fullWidthMainArea"):t.push("hideScreenShare"),d?t.push("showSharedNotepad fullWidthMainArea"):t.push("hideSharedNotepad"),c?t.push("showWhiteboard fullWidthMainArea"):t.push("hideWhiteboard"),u?t.push("showExternalMediaPlayer fullWidthMainArea"):t.push("hideExternalMediaPlayer"),m?t.push("showDisplayExternalLink fullWidthMainArea"):t.push("hideDisplayExternalLink"),e&&t.push("isRecorder"),t.join(" ")}),[l,y,p,n,d,c,u,m,e]),_=(0,s.useMemo)((()=>(0,o.jsx)(Sr.u,{className:"transition-left-panel",show:n,unmount:!1,enter:"transform transition duration-[400ms]",enterFrom:"opacity-0 translate-x-0",enterTo:"opacity-100",leave:"transform transition duration-[400ms]",leaveFrom:"opacity-100",leaveTo:"opacity-0 -translate-x-full",children:(0,o.jsx)(wn,{})})),[n]),N=(0,s.useMemo)((()=>(0,o.jsx)(Cd,{currentConnection:t})),[t]),C=(0,s.useMemo)((()=>v?(0,o.jsx)(Sr.u,{className:"transition-right-panel",show:p,unmount:!1,enter:"transform transition duration-[400ms]",enterFrom:"opacity-0 translate-x-0",enterTo:"opacity-100",leave:"transform transition duration-[400ms]",leaveFrom:"opacity-100",leaveTo:"opacity-0 translate-x-full",children:(0,o.jsx)(Hn,{currentRoom:t.room,isRecorder:e})}):null),[t,p]);return(0,s.useEffect)((()=>{e?T(h):x&&f?T(h-110):x&&!f?T(h-50):!x&&f?T(h-60):x||f||T(h)}),[h,e,x,f]),(0,o.jsxs)("div",{id:"main-area",className:`plugNmeet-app-main-area overflow-hidden relative flex ${S} column-camera-width-${a} column-camera-position-${i}`,style:{height:`${w}px`},children:[(0,o.jsx)("div",{className:"main-app-bg absolute w-full h-full left-0 top-0 object-cover pointer-events-none bg-cover bg-center bg-no-repeat",style:{backgroundImage:`url("${j}/imgs/app-banner.jpg")`}}),(0,o.jsxs)("div",{className:"inner flex justify-between w-full",children:[_,(0,o.jsxs)("div",{className:"middle-area relative flex-auto",children:[(0,o.jsx)($n,{}),N]}),C]})]})},Gd=(0,wr.P1)((e=>e.session.isStartup),(e=>e)),Jd=({onCloseModal:e})=>{const[t,r]=(0,s.useState)(!0),a=kr(Gd),i=yr(),{t:n}=(0,m.$G)(),l=(t=!1)=>{r(!1),i(U(!1)),t&&i(Ke(0)),e()};return a?(0,o.jsx)("div",{className:"absolute z-50 w-full h-full top-0 left-0",children:(0,o.jsx)("div",{id:"startupJoinModal",className:(t?"opacity-1 pointer-events-auto":"pointer-events-none opacity-0")+" join-the-audio-popup absolute transition ease-in top-0 left-0 w-full h-full z-[999] bg-white/80 dark:bg-darkPrimary/90 px-6 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"popup-inner bg-white dark:bg-darkPrimary/90 w-full max-w-md rounded-2xl shadow-header relative px-6 py-14",children:[(0,o.jsxs)("button",{className:"close-btn absolute top-8 right-6 w-[25px] h-[25px] outline-none",type:"button",onClick:()=>l(!0),children:[(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 rotate-45"}),(0,o.jsx)("span",{className:"inline-block h-[1px] w-[20px] bg-primaryColor dark:bg-darkText absolute top-0 left-0 -rotate-45"})]}),(0,o.jsx)("p",{className:"text-base md:text-lg primaryColor dark:text-darkText font-normal mb-5 text-center",children:n("app.how-to-join")}),(0,o.jsxs)("div",{className:"btn flex justify-center",children:[(0,o.jsxs)("button",{type:"button",className:"microphone bg-transparent mr-4 text-center",onClick:()=>(i(xe(!0)),void l()),children:[(0,o.jsx)("div",{className:"h-[40px] md:h-[60px] w-[40px] md:w-[60px] m-auto overflow-hidden rounded-full bg-[#F2F2F2] dark:bg-darkSecondary3 hover:bg-[#ECF4FF] hover:dark:bg-darkSecondary2 mb-1 flex items-center justify-center cursor-pointer",children:(0,o.jsx)("i",{className:"pnm-mic-unmute primaryColor dark:text-secondaryColor text-xl"})}),(0,o.jsx)("p",{className:"text-sm md:text-base primaryColor dark:text-darkText font-normal",children:n("app.microphone")})]}),(0,o.jsxs)("button",{type:"button",id:"listenOnlyJoin",className:"headphone bg-transparent ml-4 text-center",children:[(0,o.jsx)("div",{className:"camera h-[40px] md:h-[60px] w-[40px] md:w-[60px] m-auto overflow-hidden rounded-full bg-[#F2F2F2] dark:bg-darkSecondary3 hover:bg-[#ECF4FF] hover:dark:bg-darkSecondary2 mb-1 flex items-center justify-center cursor-pointer",onClick:()=>l(),children:(0,o.jsx)("i",{className:"pnm-listen-only primaryColor dark:text-secondaryColor text-xl"})}),(0,o.jsx)("p",{className:"text-sm md:text-base primaryColor dark:text-darkText font-normal",children:n("app.listen-only")})]})]})]})})}):null};var Vd=r(7187);class Hd{constructor(e){this.isRecorderJoin=!1,this.participantsCount=0,this.participantCounterInterval=0,this.participantConnected=e=>{this.addParticipant(e)},this.addParticipant=e=>{var t,r,a;let o=null;if(e.metadata)try{o=JSON.parse(e.metadata),o&&this.notificationForWaitingUser(o,e.name)}catch(d){}o||(o={is_admin:!1,is_presenter:!1,raised_hand:!1,wait_for_approval:!1,lock_settings:{lock_microphone:!0,lock_webcam:!0,lock_screen_sharing:!0,lock_chat:!0,lock_chat_send_message:!0,lock_chat_file_share:!0,lock_private_chat:!0,lock_whiteboard:!0,lock_shared_notepad:!0}});let s=0,i=0,n=0,l=!1;e.getTracks().forEach((e=>{e.source===Be.fQ.Source.Camera?s+=1:e.source===Be.fQ.Source.Microphone?(i+=1,l=e.isMuted):e.source!==Be.fQ.Source.ScreenShare&&e.source!==Be.fQ.Source.ScreenShareAudio||(n=1)})),br.dispatch(I({sid:e.sid,userId:e.identity,name:null!==(t=e.name)&&void 0!==t?t:"",metadata:o,audioTracks:i,videoTracks:s,screenShareTrack:n,isMuted:l,connectionQuality:e.connectionQuality,isLocal:!1,joinedAt:null!==(a=null===(r=e.joinedAt)||void 0===r?void 0:r.getTime())&&void 0!==a?a:Date.now(),visibility:"visible"})),this.isRecorderJoin&&this.participantsCount++},this.participantDisconnected=e=>{this.removeParticipant(e),this.isRecorderJoin&&this.participantsCount--},this.removeParticipant=e=>{const t=E.selectById(br.getState(),e.identity);(null===t||void 0===t?void 0:t.screenShareTrack)&&br.dispatch(J({isActive:!1,sharedBy:""})),br.dispatch(A(e.identity)),br.dispatch(S(e.identity)),this.that.updateVideoSubscribers(e,!1),this.that.updateAudioSubscribers(e,!1),this.that.updateScreenShareOnUserDisconnect(e)},this.connectionQualityChanged=(e,t)=>{br.dispatch(P({id:t.identity,changes:{connectionQuality:e}})),e===Be.ZV.Poor&&t.sid===this.that.room.localParticipant.sid&&"RECORDER_BOT"!==t.identity&&"RTMP_BOT"!==t.identity&&(0,l.Am)(f.t("notifications.your-connection-quality-not-good"),{toastId:"connection-status",type:"error"})},this.setParticipantMetadata=(e,t)=>{if(t.metadata){const e=JSON.parse(t.metadata);br.dispatch(P({id:t.identity,changes:{metadata:e}})),this.that.room.localParticipant.sid===t.sid&&(br.dispatch(H(e)),br.dispatch(ce(e.raised_hand)))}},this.that=e}recorderJoined(){this.isRecorderJoin=!0,this.startParticipantCounter(),br.dispatch(de(!1))}clearParticipantCounterInterval(){this.participantCounterInterval&&clearInterval(this.participantCounterInterval)}startParticipantCounter(){this.participantCounterInterval=setInterval((()=>{0===this.participantsCount&&(console.log("NO_USER_ONLINE"),this.that.room.disconnect())}),3e3)}notificationForWaitingUser(e,t){var r,a;const o=br.getState();e.wait_for_approval&&(null===(a=null===(r=o.session.currentUser)||void 0===r?void 0:r.metadata)||void 0===a?void 0:a.is_admin)&&(o.bottomIconsActivity.isActiveParticipantsPanel||br.dispatch(de(!0)),br.dispatch(qe(!0)),(0,l.Am)(f.t("waiting-room.user-waiting",{name:t}),{type:"info",toastId:"user-waiting"}))}}class qd{constructor(e){this.localTrackPublished=(e,t)=>{this.addSubscriber(e,t)},this.localTrackUnpublished=(e,t)=>{this.removeSubscriber(e,t)},this.trackSubscribed=(e,t,r)=>{this.addSubscriber(t,r)},this.trackUnsubscribed=(e,t)=>{this.removeSubscriber(e,t)},this.trackMuted=(e,t)=>{var r;br.dispatch(P({id:t.identity,changes:{isMuted:!0}})),t.identity===(null===(r=br.getState().session.currentUser)||void 0===r?void 0:r.userId)&&br.dispatch(ie(!0))},this.trackUnmuted=(e,t)=>{var r;br.dispatch(P({id:t.identity,changes:{isMuted:!1}})),t.identity===(null===(r=br.getState().session.currentUser)||void 0===r?void 0:r.userId)&&br.dispatch(ie(!1))},this.trackSubscriptionFailed=(e,t)=>{console.log("==== trackSubscriptionFailed ===="),console.log(t.name,e)},this.trackStreamStateChanged=(e,t,r)=>{console.log("==== trackStreamStateChanged ===="),console.log(r.name,t)},this.that=e}addSubscriber(e,t){var r,a,o,s,i,n,l;if(this.roomMetadata||(this.roomMetadata=br.getState().session.currentRoom.metadata),this.currentUser||(this.currentUser=br.getState().session.currentUser),t.identity!==(null===(r=this.currentUser)||void 0===r?void 0:r.userId)&&e.source===Be.fQ.Source.Camera&&((null===(a=this.roomMetadata.room_features)||void 0===a?void 0:a.admin_only_webcams)||!(null===(o=this.roomMetadata.room_features)||void 0===o?void 0:o.allow_view_other_webcams))&&!(null===(i=null===(s=this.currentUser)||void 0===s?void 0:s.metadata)||void 0===i?void 0:i.is_admin)&&t.metadata){if(!JSON.parse(t.metadata).is_admin)return}if(e.source===Be.fQ.Source.ScreenShare||e.source===Be.fQ.Source.ScreenShareAudio)br.dispatch(P({id:t.identity,changes:{screenShareTrack:1}})),br.dispatch(J({isActive:!0,sharedBy:t.identity})),this.that.setScreenShareTrack(e,t,!0);else if(e.source===Be.fQ.Source.Microphone){this.that.updateAudioSubscribers(t);const r=t.getTracks().filter((e=>e.source===Be.fQ.Source.Microphone)).length;br.dispatch(P({id:t.identity,changes:{audioTracks:0===r?1:r,isMuted:null!==(l=null===(n=e.audioTrack)||void 0===n?void 0:n.isMuted)&&void 0!==l&&l,audioVolume:br.getState().roomSettings.roomAudioVolume}}))}else if(e.source===Be.fQ.Source.Camera){this.that.updateVideoSubscribers(t);const e=t.getTracks().filter((e=>e.source===Be.fQ.Source.Camera)).length;br.dispatch(P({id:t.identity,changes:{videoTracks:0===e?1:e}}))}}removeSubscriber(e,t){var r,a,o,s;e.source===Be.fQ.Source.ScreenShare||e.source===Be.fQ.Source.ScreenShareAudio?(br.dispatch(P({id:t.identity,changes:{screenShareTrack:0}})),br.dispatch(J({isActive:!1,sharedBy:""})),this.that.setScreenShareTrack(e,t,!1)):e.source===Be.fQ.Source.Microphone?(this.that.updateAudioSubscribers(t,!1),br.dispatch(P({id:t.identity,changes:{audioTracks:null!==(r=t.getTracks().filter((e=>e.source===Be.fQ.Source.Microphone)).length)&&void 0!==r?r:0,isMuted:null!==(o=null===(a=e.audioTrack)||void 0===a?void 0:a.isMuted)&&void 0!==o&&o}}))):e.source===Be.fQ.Source.Camera&&(this.that.updateVideoSubscribers(t,!1),br.dispatch(P({id:t.identity,changes:{videoTracks:null!==(s=t.getTracks().filter((e=>e.source===Be.fQ.Source.Camera)).length)&&void 0!==s?s:0}})))}}class $d{constructor(e){this.dataReceived=(e,t,r)=>{var a;let o;this.requestedParticipant=t;try{o=Wa.fromBinary(new Uint8Array(e))}catch(s){return void console.error(s)}r===Be.WO.RELIABLE&&o.type===Ma.SYSTEM&&((null===(a=br.getState().session.currentUser)||void 0===a?void 0:a.isRecorder)||o.body&&this.handleSystemTypeData(o.body))},this.handleSystemTypeData=e=>{switch(e.type){case Oa.RAISE_HAND:case Oa.INFO:(0,l.Am)(f.t(e.msg),{type:"info"}),this.playNotification(e.type);break;case Oa.ALERT:(0,l.Am)(f.t(e.msg),{type:"error"}),this.playNotification(e.type)}},this.playNotification=e=>{e!==Oa.RAISE_HAND&&e!==Oa.ALERT||br.dispatch(qe(!0))},this.that=e}}class zd{constructor(){this.metadata=null,this.welcomeMessage=void 0,this.setRoomMetadata=e=>{if(!(0,ss.isEmpty)(e)){try{this.metadata=JSON.parse(e)}catch(t){return void console.error(t)}this.metadata&&(this.setWindowTitle(this.metadata.room_title),this.showRecordingNotification(),this.showRTMPNotification(),this.publishWelcomeMessage(),br.dispatch(q(this.metadata)))}},this.setWindowTitle=e=>{document.title=e},this.showRecordingNotification=()=>{var e,t,r;if(null===(e=br.getState().session.currentUser)||void 0===e?void 0:e.isRecorder)return;const a=br.getState().session.isActiveRecording;!a&&(null===(t=this.metadata)||void 0===t?void 0:t.is_recording)?(0,l.Am)(f.t("room-metadata.session-recording"),{type:"info"}):a&&!(null===(r=this.metadata)||void 0===r?void 0:r.is_recording)&&(0,l.Am)(f.t("room-metadata.session-not-recording"),{type:"info"})},this.showRTMPNotification=()=>{var e,t,r;if(null===(e=br.getState().session.currentUser)||void 0===e?void 0:e.isRecorder)return;const a=br.getState().session.isActiveRtmpBroadcasting;!a&&(null===(t=this.metadata)||void 0===t?void 0:t.is_active_rtmp)?(0,l.Am)(f.t("room-metadata.rtmp-started"),{type:"info"}):a&&!(null===(r=this.metadata)||void 0===r?void 0:r.is_active_rtmp)&&(0,l.Am)(f.t("room-metadata.rtmp-stopped"),{type:"info"})},this.publishWelcomeMessage=()=>{var e,t,r,a;if(void 0!==this.welcomeMessage)return;if(!(null===(e=this.metadata)||void 0===e?void 0:e.welcome_message))return void(this.welcomeMessage="");if((0,ss.isEmpty)(null===(t=this.metadata)||void 0===t?void 0:t.welcome_message))return void(this.welcomeMessage="");this.welcomeMessage=null===(r=this.metadata)||void 0===r?void 0:r.welcome_message;const o={type:"CHAT",message_id:"",time:"",isPrivate:!1,from:{userId:"system",name:"System",sid:"system"},msg:null!==(a=this.welcomeMessage)&&void 0!==a?a:""};br.dispatch(Ae(o))}}}class Qd{constructor(e){this.lastActiveWebcamChanged=Date.now(),this.activeSpeakers=[],this.activeSpeakersChanged=e=>{if(this.activeSpeakers=[],e.length){const t=br.getState().session.isWebcamPaginating,r=Date.now();e.forEach((e=>{var a,o,s;if(!t&&this.that.videoSubscribersMap.size>3){const t=this.lastActiveWebcamChanged+4e3;r>t&&this.that.videoSubscribersMap.has(e.identity)&&(this.that.updateVideoSubscribers(e),this.lastActiveWebcamChanged=r)}const i={sid:e.sid,userId:e.identity,metadata:e.metadata,name:null!==(a=null===e||void 0===e?void 0:e.name)&&void 0!==a?a:"",isSpeaking:e.isSpeaking,audioLevel:e.audioLevel,lastSpokeAt:null!==(s=null===(o=e.lastSpokeAt)||void 0===o?void 0:o.getTime())&&void 0!==s?s:Date.now()};br.dispatch(w(i)),this.activeSpeakers.push(i)}))}},this.runInterval=()=>{this.interval=setInterval((()=>{if(this.activeSpeakers.length)br.dispatch(_(this.activeSpeakers));else{y.selectAll(br.getState()).length&&br.dispatch(j())}}),1e3)},this.onLivekitDisconnect=()=>{clearInterval(this.interval)},this.that=e,this.runInterval()}}class Yd extends Vd.EventEmitter{constructor(e,t,r){super(),this._audioSubscribersMap=new Map,this._videoSubscribersMap=new Map,this._screenShareTracksMap=new Map,this.connect=async()=>{try{await this._room.connect(this.url,this.token),await this.initiateParticipants(),await this.updateSession(),Do(),this.roomConnectionStatusState("connected"),this.startTokenRenewInterval()}catch(e){console.error(e),this.roomConnectionStatusState("error"),this.errorState({title:"Error",text:String(e)})}},this.initiateParticipants=async()=>{var e;const t=null!==(e="RECORDER_BOT"===this._room.localParticipant.identity||"RTMP_BOT"===this._room.localParticipant.identity)&&void 0!==e&&e;br.dispatch(W({sid:this._room.localParticipant.sid,userId:this._room.localParticipant.identity,name:this._room.localParticipant.name,isRecorder:t})),this.handleParticipant.setParticipantMetadata("",this._room.localParticipant),t?this.handleParticipant.recorderJoined():this.handleParticipant.addParticipant(this._room.localParticipant),this._room.participants.forEach((e=>{this.handleParticipant.addParticipant(e),e.getTracks().forEach((t=>{t.isSubscribed&&(t.source===Be.fQ.Source.ScreenShare||t.source===Be.fQ.Source.ScreenShareAudio?(br.dispatch(P({id:e.identity,changes:{screenShareTrack:1}})),br.dispatch(J({isActive:!0,sharedBy:e.identity})),this.setScreenShareTrack(t,e)):this.updateVideoSubscribers(e))}))}))},this.updateSession=async()=>{br.dispatch(G({sid:this._room.sid,room_id:this._room.name})),this._room.metadata&&!(0,ss.isEmpty)(this._room.metadata)&&this.handleRoomMetadata.setRoomMetadata(this._room.metadata)},this.configureRoom=()=>{var e,t,r,a;let o=null!==(e=window.VIDEO_CODEC)&&void 0!==e?e:"vp8";("vp9"===o&&!(0,Be.y7)()||"av1"===o&&!(0,Be.Vn)())&&(o="vp8");const s=new Be.du({adaptiveStream:!0,dynacast:null!==(t=window.ENABLE_DYNACAST)&&void 0!==t&&t,stopLocalTrackOnUnpublish:!0,videoCaptureDefaults:{resolution:Be.OM.h720.resolution},publishDefaults:{simulcast:null!==(r=window.ENABLE_SIMULCAST)&&void 0!==r&&r,videoSimulcastLayers:[Be.OM.h90,Be.OM.h180,Be.OM.h360],stopMicTrackOnMute:null!==(a=window.STOP_MIC_TRACK_ON_MUTE)&&void 0!==a&&a,videoCodec:o}});return s.on(Be.TQ.Reconnecting,(()=>this.roomConnectionStatusState("re-connecting"))),s.on(Be.TQ.Reconnected,(()=>this.roomConnectionStatusState("connected"))),s.on(Be.TQ.Disconnected,this.onDisconnected),s.on(Be.TQ.RoomMetadataChanged,this.handleRoomMetadata.setRoomMetadata),s.on(Be.TQ.ActiveSpeakersChanged,this.handleActiveSpeakers.activeSpeakersChanged),s.on(Be.TQ.MediaDevicesError,this.mediaDevicesError),s.on(Be.TQ.DataReceived,this.handleDataMessages.dataReceived),s.on(Be.TQ.ParticipantConnected,this.handleParticipant.participantConnected),s.on(Be.TQ.ParticipantDisconnected,this.handleParticipant.participantDisconnected),s.on(Be.TQ.ParticipantMetadataChanged,this.handleParticipant.setParticipantMetadata),s.on(Be.TQ.ConnectionQualityChanged,this.handleParticipant.connectionQualityChanged),s.on(Be.TQ.LocalTrackPublished,this.handleMediaTracks.localTrackPublished),s.on(Be.TQ.LocalTrackUnpublished,this.handleMediaTracks.localTrackUnpublished),s.on(Be.TQ.TrackSubscribed,this.handleMediaTracks.trackSubscribed),s.on(Be.TQ.TrackUnpublished,this.handleMediaTracks.trackUnsubscribed),s.on(Be.TQ.TrackSubscriptionFailed,this.handleMediaTracks.trackSubscriptionFailed),s.on(Be.TQ.TrackMuted,this.handleMediaTracks.trackMuted),s.on(Be.TQ.TrackUnmuted,this.handleMediaTracks.trackUnmuted),s.on(Be.TQ.TrackStreamStateChanged,this.handleMediaTracks.trackStreamStateChanged),s},this.onDisconnected=e=>{var t;this.errorState({title:f.t("notifications.room-disconnected-title"),text:this.getDisconnectErrorReasonText(e)}),this.roomConnectionStatusState("disconnected"),Po&&(Fo=!0,null===Ao||void 0===Ao||Ao.close()),this.handleActiveSpeakers.onLivekitDisconnect(),clearInterval(this.tokenRenewInterval),this.handleParticipant.clearParticipantCounterInterval();const r=null===(t=br.getState().session.currentRoom.metadata)||void 0===t?void 0:t.logout_url;e===Be.W4.ROOM_DELETED&&r&&setTimeout((()=>{window.location.href=r}),5e3)},this.getDisconnectErrorReasonText=e=>{let t=f.t("notifications.room-disconnected-unknown",{code:"UNKNOWN_REASON"});switch(e){case Be.W4.CLIENT_INITIATED:t=f.t("notifications.room-disconnected-client-initiated",{code:"CLIENT_INITIATED"});break;case Be.W4.DUPLICATE_IDENTITY:t=f.t("notifications.room-disconnected-duplicate-entry",{code:"DUPLICATE_IDENTITY"});break;case Be.W4.SERVER_SHUTDOWN:t=f.t("notifications.room-disconnected-server-shutdown",{code:"SERVER_SHUTDOWN"});break;case Be.W4.PARTICIPANT_REMOVED:t=f.t("notifications.room-disconnected-participant-removed",{code:"PARTICIPANT_REMOVED"});break;case Be.W4.ROOM_DELETED:t=f.t("notifications.room-disconnected-room-ended",{code:"ROOM_ENDED"});break;case Be.W4.STATE_MISMATCH:t=f.t("notifications.room-disconnected-state-mismatch",{code:"STATE_MISMATCH"})}return t},this.mediaDevicesError=e=>{console.error(e)},this.startTokenRenewInterval=()=>{this.tokenRenewInterval=setInterval((()=>{const e=br.getState().session.token,t=new Wa({type:Ma.SYSTEM,roomSid:this._room.sid,roomId:this._room.name,body:{type:Oa.RENEW_TOKEN,from:{sid:this._room.localParticipant.sid,userId:this._room.localParticipant.identity},isPrivate:1,msg:e}});Wo(t.toBinary())}),18e4)},this.setScreenShareTrack=(e,t,r=!0)=>{r?this._screenShareTracksMap.set(t.identity,e):this._screenShareTracksMap.delete(t.identity),this._screenShareTracksMap.size?this.emit(Yn.ScreenShareStatus,!0):this.emit(Yn.ScreenShareStatus,!1);const a=new Map(this._screenShareTracksMap);this.emit(Yn.ScreenShareTracks,a)},this.updateScreenShareOnUserDisconnect=e=>{if(this._screenShareTracksMap.size&&this._screenShareTracksMap.has(e.identity)){this._screenShareTracksMap.delete(e.identity);const t=new Map(this._screenShareTracksMap);this.emit(Yn.ScreenShareTracks,t),this._screenShareTracksMap.size?this.emit(Yn.ScreenShareStatus,!0):(br.dispatch(J({isActive:!1,sharedBy:""})),this.emit(Yn.ScreenShareStatus,!1))}},this.updateAudioSubscribers=(e,t=!0)=>{if("undefined"===typeof e.identity)return;if(e.identity===this._room.localParticipant.identity)return;t?this._audioSubscribersMap.set(e.identity,e):this._audioSubscribersMap.has(e.identity)&&this._audioSubscribersMap.delete(e.identity);const r=new Map(this._audioSubscribersMap);this.emit(Yn.AudioSubscribers,r),br.dispatch(Q(r.size))},this.updateVideoSubscribers=(e,t=!0)=>{if("undefined"===typeof e.identity)return;if(t?this._videoSubscribersMap.set(e.identity,e):this._videoSubscribersMap.has(e.identity)&&this._videoSubscribersMap.delete(e.identity),br.dispatch(z(this._videoSubscribersMap.size)),this._videoSubscribersMap.size?this.emit(Yn.VideoStatus,!0):this.emit(Yn.VideoStatus,!1),this._videoSubscribersMap.size<=1){const e=new Map(this._videoSubscribersMap);return void this.emit(Yn.VideoSubscribers,e)}const r=Array.from(this._videoSubscribersMap);r.sort(((e,t)=>{var r,a,o,s,i,n,l,d;const c=e[1],u=t[1];if(c.isSpeaking&&u.isSpeaking)return u.audioLevel-c.audioLevel;if(c.isSpeaking!==u.isSpeaking)return c.isSpeaking?-1:1;if(c.lastSpokeAt!==u.lastSpokeAt){const e=null!==(a=null===(r=c.lastSpokeAt)||void 0===r?void 0:r.getTime())&&void 0!==a?a:0;return(null!==(s=null===(o=u.lastSpokeAt)||void 0===o?void 0:o.getTime())&&void 0!==s?s:0)-e}return(null!==(n=null===(i=c.joinedAt)||void 0===i?void 0:i.getTime())&&void 0!==n?n:0)-(null!==(d=null===(l=u.joinedAt)||void 0===l?void 0:l.getTime())&&void 0!==d?d:0)}));const a=new Map(r);this.emit(Yn.VideoSubscribers,a)},this.token=e.token,this.url=e.livekit_host,this.errorState=t,this.roomConnectionStatusState=r,this.handleParticipant=new Hd(this),this.handleMediaTracks=new qd(this),this.handleDataMessages=new $d(this),this.handleRoomMetadata=new zd,this.handleActiveSpeakers=new Qd(this),this.roomConnectionStatusState("connecting"),sessionStorage.clear(),this._room=this.configureRoom(),this.connect()}get videoSubscribersMap(){return this._videoSubscribersMap}get audioSubscribersMap(){return this._audioSubscribersMap}get screenShareTracksMap(){return this._screenShareTracksMap}get room(){return this._room}}const Xd=()=>{const[e,t]=(0,s.useState)(),[r,a]=(0,s.useState)("loading");return{error:e,setError:t,roomConnectionStatus:r,setRoomConnectionStatus:a,startLivekitConnection:e=>new Yd(e,t,a)}},Kd=(0,wr.P1)((e=>e.roomSettings.playAudioNotification),(e=>e)),Zd=(0,wr.P1)((e=>e.roomSettings.allowPlayAudioNotification),(e=>e)),ec=s.memo((()=>{var e;const t=yr(),r=(0,s.useRef)(null),a=kr(Kd),i=kr(Zd),[n,l]=(0,s.useState)(!1),d=null!==(e=window.STATIC_ASSETS_PATH)&&void 0!==e?e:"./assets";return(0,s.useEffect)((()=>{const e=r.current;a&&(!n&&i&&(null===e||void 0===e||e.play()),t(qe(!1)))}),[a,n,i,t]),(0,s.useEffect)((()=>{const e=r.current;return e&&(e.addEventListener("playing",(()=>l(!0))),e.addEventListener("ended",(()=>l(!1)))),()=>{e&&(e.pause(),e.removeEventListener("playing",(()=>l(!0))),e.removeEventListener("ended",(()=>l(!1))))}}),[]),(0,o.jsx)("div",{style:{display:"none"},children:(0,o.jsx)("audio",{ref:r,src:`${d}/audio/notification.mp3`})})}));var tc=r(6977);const rc=e=>{const t=yr(),{t:r}=(0,m.$G)();(0,tc.y1)("ctrl+alt+m",(()=>{e&&(e=>{e&&e.localParticipant.audioTracks.forEach((async e=>{e.track&&e.track.source===Be.fQ.Source.Microphone&&(e.isMuted?(await e.track.unmute(),t(ie(!1))):(await e.track.mute(),t(ie(!0))))}))})(e)}),[e]),(0,tc.y1)("ctrl+alt+a",(()=>{const e=br.getState().bottomIconsActivity;e.isActiveMicrophone||e.showMicrophoneModal||t(xe(!0))}));(0,tc.y1)("ctrl+alt+o",(()=>{e&&(e=>{e.localParticipant.audioTracks.forEach((async t=>{t.track&&t.kind===Be.fQ.Kind.Audio&&e.localParticipant.unpublishTrack(t.track,!0)})),t(se(!1)),t(ie(!1)),t(Ve(""))})(e)}),[e]),(0,tc.y1)("ctrl+alt+v",(()=>{const e=br.getState().bottomIconsActivity;e.isActiveWebcam||e.showVideoShareModal||t(fe(!0))}));(0,tc.y1)("ctrl+alt+x",(()=>{if(e){br.getState().bottomIconsActivity.isActiveWebcam&&(e=>{e.localParticipant.videoTracks.forEach((async t=>{t.track&&t.track.source===Be.fQ.Source.Camera&&e.localParticipant.unpublishTrack(t.track,!0)})),t(ne(!1)),t(He("")),t(Ne({type:"none"}))})(e)}}),[e]),(0,tc.y1)("ctrl+alt+u",(()=>{const e=br.getState().bottomIconsActivity.isActiveParticipantsPanel;t(de(!e))})),(0,tc.y1)("ctrl+alt+c",(()=>{const e=br.getState().bottomIconsActivity.isActiveChatPanel;t(le(!e))})),(0,tc.y1)("ctrl+alt+l",(()=>{var e,r;if(!(null===(r=null===(e=br.getState().session.currentUser)||void 0===e?void 0:e.metadata)||void 0===r?void 0:r.is_admin))return;const a=br.getState().bottomIconsActivity.showLockSettingsModal;t(ge(!a))})),(0,tc.y1)("ctrl+alt+s",(()=>{const e=br.getState().roomSettings.isShowRoomSettingsModal;t($e(!e))})),(0,tc.y1)("ctrl+alt+w",(()=>{const e=br.getState().bottomIconsActivity.isActiveWhiteboard;t(he(!e))}));(0,tc.y1)("ctrl+alt+r",(()=>{if(e){(async(e,a)=>{if(e){const e=new Qa({roomSid:a.sid,roomId:a.name,msgBodyType:Oa.LOWER_HAND,msg:uo.LOWER_HAND}),r=await co("dataMessage",e.toBinary(),!1,"application/protobuf","arraybuffer"),o=Va.fromBinary(new Uint8Array(r));o.status?t(ce(!1)):(0,l.Am)(o.msg,{type:"error"})}else{const e=new Qa({roomSid:a.sid,roomId:a.name,msgBodyType:Oa.RAISE_HAND,msg:r("footer.notice.has-raised-hand",{user:a.localParticipant.name}).toString()}),o=await co("dataMessage",e.toBinary(),!1,"application/protobuf","arraybuffer"),s=Va.fromBinary(new Uint8Array(o));s.status?(t(ce(!0)),(0,l.Am)(r("footer.notice.you-raised-hand"),{type:"info"})):(0,l.Am)(s.msg,{type:"error"})}})(br.getState().bottomIconsActivity.isActiveRaisehand,e)}}),[e])},ac=()=>{(0,s.useEffect)((()=>{const e=new URLSearchParams(window.location.search).get("custom_design");if(e&&""!==e&&"{}"!==e&&(window.DESIGN_CUSTOMIZATION=e),"undefined"===typeof window.DESIGN_CUSTOMIZATION)return;let t={};try{t=JSON.parse(window.DESIGN_CUSTOMIZATION)}catch(i){return void console.error("can't parse custom design params")}let r="";t.primary_color&&(r+=".primaryColor{ color: "+t.primary_color+"}",r+=".text-primaryColor { color: "+t.primary_color+"}",r+=".placeholder\\:text-primaryColor\\/70::placeholder { color: "+t.primary_color+"}",r+=".bg-primaryColor { background: "+t.primary_color+" !important;}",r+=".hover\\:bg-primaryColor:hover { background: "+t.primary_color+" !important;}",r+=".border-primaryColor { border-color: "+t.primary_color+" !important;}",r+=".excalidraw {\n    --color-primary: "+t.primary_color+";\n    --color-primary-darker: "+t.primary_color+";\n    --color-primary-darkest: "+t.primary_color+";\n}"),t.secondary_color&&(r+=".secondaryColor { color: "+t.secondary_color+" !important;}",r+=".text-secondaryColor { color: "+t.secondary_color+" !important;}",r+=".bg-secondaryColor { background: "+t.secondary_color+" !important;}",r+=".hover\\:text-secondaryColor:hover { color: "+t.secondary_color+" !important;}",r+=".group:hover .group-hover\\:text-secondaryColor { color: "+t.secondary_color+" !important;}",r+=".bg-secondaryColor, .hover:bg-secondaryColor:hover { background: "+t.secondary_color+" !important;}",r+=".hover:bg-secondaryColor:hover { background: "+t.secondary_color+" !important;}",r+=".border-secondaryColor { border-color: "+t.secondary_color+" !important;}",r+=".excalidraw {\n    --color-primary-light: "+t.secondary_color+";\n}"),t.background_image?(r+=`.main-app-bg { \n        background: url("${t.background_image}") !important;\n        background-position: center !important;\n        background-repeat: no-repeat !important;\n        background-size: cover !important;\n        }`,r+=`.error-app-bg { \n        background: url("${t.background_image}") !important;\n        background-position: center !important;\n        background-repeat: no-repeat !important;\n        background-size: cover !important;\n        }`,r+=`.waiting-room { \n        background: url("${t.background_image}") !important;\n        background-position: center !important;\n        background-repeat: no-repeat !important;\n        background-size: cover !important;\n        }`):t.background_color&&(r+=`.main-app-bg { \n        background: ${t.background_color} !important;\n        }`,r+=`.error-app-bg { \n        background: ${t.background_color} !important;\n        }`,r+=`.waiting-room { \n        background: ${t.background_color} !important;\n        }`),t.header_bg_color&&(r+="header#main-header { background: "+t.header_bg_color+"; }"),t.footer_bg_color&&(r+="footer#main-footer { background: "+t.footer_bg_color+"; }"),t.left_side_bg_color&&(r+=".participants-wrapper { background: "+t.left_side_bg_color+"; }",r+=".vertical-webcams { background: "+t.left_side_bg_color+" !important; }"),t.right_side_bg_color&&(r+=".messageModule-wrapper { background: "+t.right_side_bg_color+"; }"),!t.column_camera_width||t.column_camera_width!==De.SMALL_WIDTH&&t.column_camera_width!==De.MEDIUM_WIDTH&&t.column_camera_width!==De.FULL_WIDTH||nt(t.column_camera_width),!t.column_camera_position||t.column_camera_position!==Le.TOP&&t.column_camera_position!==Le.BOTTOM&&t.column_camera_position!==Le.LEFT||lt(t.column_camera_position),"undefined"===typeof window.CUSTOM_LOGO&&t.custom_logo&&(window.CUSTOM_LOGO=t.custom_logo);const a=document.head;let o,s;return t.custom_css_url&&(o=document.createElement("link"),o.type="text/css",o.rel="stylesheet",o.href=t.custom_css_url,a.appendChild(o)),""!==r&&(s=document.createElement("style"),s.id="plugNmeetCustomization",s.textContent=r,a.appendChild(s)),()=>{""!==r&&a.removeChild(s),t.custom_css_url&&a.removeChild(o)}}),[])};var oc=r(2437),sc=r.n(oc);const ic=e=>{const t=yr(),[r,a]=(0,s.useState)(""),[o,i]=(0,s.useState)("landscape-device"),[n,l]=(0,s.useState)(""),[d,c]=(0,s.useState)(0),u=ks(d),m=()=>{l(`${window.innerHeight}px`)};return(0,s.useEffect)((()=>{const e=setTimeout((()=>{m()}),500);return()=>{e&&clearTimeout(e)}}),[null===e||void 0===e?void 0:e.state]),(0,s.useEffect)((()=>{u&&u!==d&&(t(Te(window.innerWidth)),br.getState().bottomIconsActivity.isActiveWhiteboard&&t(wt()))}),[u,d]),(0,s.useEffect)((()=>{window.onresize=()=>{c(window.innerWidth),t(je(window.innerHeight)),m();const e=br.getState().bottomIconsActivity.isActiveChatPanel,r=br.getState().bottomIconsActivity.isActiveParticipantsPanel;window.innerWidth<1024&&e&&r&&t(de(!1))},c(window.innerWidth),t(Te(window.innerWidth)),t(je(window.innerHeight)),window.innerWidth<1024&&(t(de(!1)),t(le(!1)));let e="is-pc";const r=new(sc())(window.navigator.userAgent),o=/Macintosh/i.test(window.navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>1;o||r.tablet()?(e="is-tablet ",t(X(M.TABLET))):r.mobile()&&(e="is-mobile ",t(X(M.MOBILE)));const s=r.os();"AndroidOS"===s?e+="is-android":("iOS"===s||"iPadOS"===s||!s&&o)&&(e+="is-ios"),a(e);const n=window.matchMedia("(orientation: portrait)");n.matches?(i("portrait-device"),t(Se("portrait"))):(i("landscape-device"),t(Se("landscape"))),n.addEventListener("change",(e=>{e.matches?(i("portrait-device"),t(Se("portrait"))):(i("landscape-device"),t(Se("landscape")))}))}),[]),{deviceClass:r,orientationClass:o,screenHeight:n}},nc=()=>{const[e,t]=(0,s.useState)(!1);(0,s.useEffect)((()=>{const e=()=>{t(!0)},r=()=>{t(!1)};return window.addEventListener("blur",e,!1),window.addEventListener("focus",r,!1),()=>{window.removeEventListener("blur",e),window.removeEventListener("focus",r)}}),[]),(0,s.useEffect)((()=>{let e,r;"undefined"!==typeof document.hidden?(e="hidden",r="visibilitychange"):"undefined"!==typeof document.msHidden?(e="msHidden",r="msvisibilitychange"):"undefined"!==typeof document.webkitHidden&&(e="webkitHidden",r="webkitvisibilitychange");const a=()=>{document[e]?t(!0):t(!1)};return"undefined"===typeof document.addEventListener&&void 0===e||document.addEventListener(r,a,!1),()=>{"undefined"===typeof document.addEventListener&&void 0===e||document.removeEventListener(r,a)}}),[]),(0,s.useEffect)((()=>{var t,r,a,o;const s=br.getState().session,i=new Wa({type:Ma.SYSTEM,roomSid:s.currentRoom.sid,roomId:s.currentRoom.room_id,body:{type:Oa.USER_VISIBILITY_CHANGE,from:{sid:null!==(r=null===(t=s.currentUser)||void 0===t?void 0:t.sid)&&void 0!==r?r:"",userId:null!==(o=null===(a=s.currentUser)||void 0===a?void 0:a.userId)&&void 0!==o?o:""},msg:e?"hidden":"visible"}});Wo(i.toBinary())}),[e])},lc=(0,wr.P1)((e=>{var t;return null===(t=e.session.currentRoom.metadata)||void 0===t?void 0:t.room_features.waiting_room_features.waiting_room_msg}),(e=>e)),dc=()=>{var e,t;const r=null!==(e=window.STATIC_ASSETS_PATH)&&void 0!==e?e:"./assets",a=null!==(t=window.CUSTOM_LOGO)&&void 0!==t?t:`${r}/imgs/main-logo.png`,{t:s}=(0,m.$G)(),i=kr(lc);return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)("div",{className:"waiting-room relative flex items-center justify-center w-full h-screen",style:{backgroundImage:`url("${r}/imgs/app-banner.jpg")`},children:(0,o.jsxs)("div",{className:"waiting-room-inner relative z-10",children:[(0,o.jsx)("div",{className:"logo w-40 m-auto relative z-20",children:(0,o.jsx)("div",{className:(window.CUSTOM_LOGO,"h-[90px]")+" header-logo bg-contain bg-no-repeat bg-center",style:{backgroundImage:`url("${a}")`}})}),(0,o.jsx)("div",{className:"divider my-5 h-[2px] w-full max-w-[50px] bg-primaryColor dark:bg-darkText m-auto"}),(0,o.jsx)("div",{className:"loading-wrap relative h-24",children:(0,o.jsx)("div",{className:"loading absolute text-center top-3 z-[999] left-0 right-0 m-auto",children:(0,o.jsxs)("div",{className:"lds-ripple",children:[(0,o.jsx)("div",{className:"border-secondaryColor"}),(0,o.jsx)("div",{className:"border-secondaryColor"})]})})}),(0,o.jsx)("p",{className:"text-3xl dark:text-darkText w-full max-w-5xl m-auto text-center leading-normal",children:(0,ds.isEmpty)(i)?s("notifications.waiting-for-approval"):i})]})})})},cc=(0,wr.P1)((e=>e.roomSettings.theme),(e=>e)),uc=()=>{const e=kr(cc),t=yr();(0,s.useEffect)((()=>{const e=e=>{t(et(e.matches?"dark":"light"))};return window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&t(et("dark")),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e),()=>{window.matchMedia("(prefers-color-scheme: dark)").removeEventListener("change",e)}}),[t]),(0,s.useEffect)((()=>{var t,r;"dark"===e?null===(t=document.querySelector("body"))||void 0===t||t.classList.add("dark"):null===(r=document.querySelector("body"))||void 0===r||r.classList.remove("dark")}),[e])},mc=(0,wr.P1)((e=>{var t,r;return null===(r=null===(t=e.session.currentUser)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.wait_for_approval}),(e=>e)),pc=()=>{const e=yr(),{t}=(0,m.$G)(),[r,a]=(0,s.useState)(!0),[i,n]=(0,s.useState)(!1),[l,d]=(0,s.useState)("participant"),[c,u]=(0,s.useState)(),[p,h]=(0,s.useState)(),x=kr(mc);Yr();const{error:f,setError:g,roomConnectionStatus:v,setRoomConnectionStatus:b,startLivekitConnection:y}=Xd();rc(null===p||void 0===p?void 0:p.room),ac(),nc();const{deviceClass:k,orientationClass:w,screenHeight:T}=ic(null===p||void 0===p?void 0:p.room);uc(),(0,s.useEffect)((()=>{const r=new URLSearchParams(window.location.search).get("access_token");let o;if(r)if("http:"===window.location.protocol&&"localhost"!==window.location.hostname)a(!1),g({title:t("app.require-ssl-title"),text:t("app.require-ssl-des")});else{const s=async()=>{var o;let s;try{const e=await co("verifyToken",new Ha({isProduction:!0}).toBinary(),!1,"application/protobuf","arraybuffer");s=qa.fromBinary(new Uint8Array(e))}catch(f){return console.error(f),b("ready"),a(!1),void g({title:t("app.verification-failed-title"),text:t("app.token-not-valid")})}b("ready"),a(!1),s.status&&s.livekitHost&&s.token?(e(L(r)),e(B(null!==(o=s.serverVersion)&&void 0!==o?o:"")),u({livekit_host:s.livekitHost,token:s.token})):g({title:t("app.verification-failed-title"),text:t(s.msg)})};p||(b("checking"),o=setTimeout((()=>{s()}),300))}else a(!1),g({title:t("app.token-missing-title"),text:t("app.token-missing-des")});return()=>{o&&clearTimeout(o)}}),[t,e,p,g,b]),(0,s.useEffect)((()=>{a("connecting"===v||"re-connecting"===v||"checking"===v)}),[v]),(0,s.useEffect)((()=>{var t,r;"connected"===v&&("RECORDER_BOT"!==(null===p||void 0===p?void 0:p.room.localParticipant.identity)&&"RTMP_BOT"!==(null===p||void 0===p?void 0:p.room.localParticipant.identity)||(n(!0),e(le(!1))),(null===(r=null===(t=br.getState().session.currentUser)||void 0===t?void 0:t.metadata)||void 0===r?void 0:r.is_admin)&&d("admin"))}),[v]);const j=(0,s.useCallback)((()=>p?(0,o.jsxs)("div",{className:"plugNmeet-app overflow-hidden h-screen",children:[i?null:(0,o.jsx)(Li,{currentRoom:p.room}),(0,o.jsx)(Wd,{isRecorder:i,currentConnection:p}),(0,o.jsx)(di,{currentRoom:p.room,isRecorder:i}),(0,o.jsx)(ec,{})]}):null),[i,p]),S=()=>{if(c){const e=y(c);h(e)}},_=(0,s.useMemo)((()=>r?(0,o.jsx)(jr,{text:t("app."+v)}):f&&!r?(0,o.jsx)(Tr,{title:f.title,text:f.text}):"connected"===v?x?(0,o.jsx)(dc,{}):j():"ready"===v?(0,o.jsx)(Jd,{onCloseModal:S}):null),[r,f,v,x,j]);return(0,o.jsx)("div",{className:`${w} ${k} ${l} dark:bg-darkPrimary/70`,style:{height:T},children:_})},hc=document.getElementById("plugNmeet-app");(0,i.s)(hc).render((0,o.jsx)(s.StrictMode,{children:(0,o.jsx)(n.zt,{store:br,children:(0,o.jsxs)(c.W,{backend:d.PD,children:[(0,o.jsx)(s.Suspense,{fallback:(0,o.jsx)(jr,{text:""}),children:(0,o.jsx)(pc,{})}),(0,o.jsx)(l.Ix,{})]})})}))},5410:()=>{},8628:()=>{},7579:()=>{},2868:()=>{},4777:()=>{},9830:()=>{},209:()=>{},7414:()=>{},5042:()=>{}},e=>{e.O(0,[736],(()=>{return t=566,e(e.s=t);var t}));e.O()}]);